(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672136,e=>{"use strict";let t,r,n;var o=e.i(247167);let s=Object.create(null),i=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?s:globalThis),l=new Proxy(s,{get:(e,t)=>i()[t]??s[t],has:(e,t)=>t in i()||t in s,set:(e,t,r)=>(i(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=i(!0);return delete r[t],!0},ownKeys:()=>Object.keys(i(!0))});function a(e,t){return void 0!==o.default&&o.default.env?o.default.env[e]??t:"u">typeof Deno?Deno.env.get(e)??t:"u">typeof Bun?Bun.env[e]??t:t}void 0!==o.default&&o.default.env,Object.freeze({get BETTER_AUTH_SECRET(){return a("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return a("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return a("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return a("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return a("NODE_ENV","development")},get PACKAGE_VERSION(){return a("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return a("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}});let u={eterm:4,cons25:4,console:4,cygwin:4,dtterm:4,gnome:4,hurd:4,jfbterm:4,konsole:4,kterm:4,mlterm:4,mosh:24,putty:4,st:4,"rxvt-unicode-24bit":24,terminator:24,"xterm-kitty":24},c=new Map(Object.entries({APPVEYOR:8,BUILDKITE:8,CIRCLECI:24,DRONE:8,GITEA_ACTIONS:24,GITHUB_ACTIONS:24,GITLAB_CI:8,TRAVIS:8})),d=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/],f="\x1b[0m",p="\x1b[31m",h="\x1b[32m",v="\x1b[33m",y="\x1b[34m",m="\x1b[35m",b=["debug","info","success","warn","error"],g={info:y,success:h,warn:v,error:p,debug:m};t=(void 0)??"error",r=1!==function(){if(void 0!==a("FORCE_COLOR"))switch(a("FORCE_COLOR")){case"":case"1":case"true":return 4;case"2":return 8;case"3":return 24;default:return 1}if(void 0!==a("NODE_DISABLE_COLORS")&&""!==a("NODE_DISABLE_COLORS")||void 0!==a("NO_COLOR")&&""!==a("NO_COLOR")||"dumb"===a("TERM"))return 1;if(a("TMUX"))return 24;if("TF_BUILD"in l&&"AGENT_NAME"in l)return 4;if("CI"in l){for(let{0:e,1:t}of c)if(e in l)return t;return"codeship"===a("CI_NAME")?8:1}if("TEAMCITY_VERSION"in l)return null!==/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(a("TEAMCITY_VERSION"))?4:1;switch(a("TERM_PROGRAM")){case"iTerm.app":if(!a("TERM_PROGRAM_VERSION")||null!==/^[0-2]\./.exec(a("TERM_PROGRAM_VERSION")))return 8;return 24;case"HyperTerm":case"MacTerm":return 24;case"Apple_Terminal":return 8}if("truecolor"===a("COLORTERM")||"24bit"===a("COLORTERM"))return 24;if(a("TERM")){if(null!==/truecolor/.exec(a("TERM")))return 24;if(null!==/^xterm-256/.exec(a("TERM")))return 8;let e=a("TERM").toLowerCase();if(u[e])return u[e];if(d.some(t=>null!==t.exec(e)))return 4}return a("COLORTERM")?4:1}(),Object.fromEntries(b.map(e=>[e,(...[n,...o])=>((e,n,o=[])=>{let s;if(!(b.indexOf(e)>=b.indexOf(t)))return;let i=(s=new Date().toISOString(),r?`\x1b[2m${s}${f} ${g[e]}${e.toUpperCase()}${f} \x1b[1m[Better Auth]:${f} ${n}`:`${s} ${e.toUpperCase()} [Better Auth]: ${n}`);"error"===e?console.error(i,...o):"warn"===e?console.warn(i,...o):console.log(i,...o)})(e,n,o)]));var w=class extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}};function R(e,t="/api/auth"){try{let t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw new w(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){if(t instanceof w)throw t;throw new w(`Invalid base URL: ${e}. Please provide a valid base URL.`,String(t))}if(function(e){try{return"/"!==(new URL(e).pathname.replace(/\/+$/,"")||"/")}catch{throw new w(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let r=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`):r}let T={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"u">typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}},E={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},O=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,S={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},_=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,A=[],L=0,I=0,U=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=L+4;t<A.length;)A[t]===e?A.splice(t,4):t+=4;let n=t.indexOf(e);~n&&(t.splice(n,1),--r.lc||r.off())}),notify(e,n){I++;let o=!A.length;for(let o of t)A.push(o,r.value,e,n);if(o){for(L=0;L<A.length;L+=4)A[L](A[L+1],A[L+2],A[L+3]);A.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r},P=(e,t)=>{var r,n;return r=r=>{let n=t(r);n&&e.events[6].push(n)},n=t=>{let r=e.listen;e.listen=(...n)=>(e.lc||e.active||(e.active=!0,t()),r(...n));let n=e.off;return e.events[6]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=n}},e.events=e.events||{},e.events[15]||(e.events[15]=n(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],n=t.indexOf(r);t.splice(n,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}},x=()=>"u"<typeof window,C=Symbol.for("better-auth:broadcast-channel");var j=class{listeners=new Set;name;constructor(e="better-auth.message"){this.name=e}subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}post(e){if("u">typeof window)try{localStorage.setItem(this.name,JSON.stringify({...e,timestamp:Math.floor(Date.now()/1e3)}))}catch{}}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=e=>{if(e.key!==this.name)return;let t=JSON.parse(e.newValue??"{}");t?.event==="session"&&t?.data&&this.listeners.forEach(e=>e(t))};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}};function $(e="better-auth.message"){return globalThis[C]||(globalThis[C]=new j(e)),globalThis[C]}let N=Symbol.for("better-auth:focus-manager");var B=class{listeners=new Set;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setFocused(e){this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||"u"<typeof document||void 0===window.addEventListener)return()=>{};let e=()=>{"visible"===document.visibilityState&&this.setFocused(!0)};return document.addEventListener("visibilitychange",e,!1),()=>{document.removeEventListener("visibilitychange",e,!1)}}};function M(){return globalThis[N]||(globalThis[N]=new B),globalThis[N]}let D=Symbol.for("better-auth:online-manager");var k=class{listeners=new Set;isOnline="u"<typeof navigator||navigator.onLine;subscribe(e){return this.listeners.add(e),()=>{this.listeners.delete(e)}}setOnline(e){this.isOnline=e,this.listeners.forEach(t=>t(e))}setup(){if("u"<typeof window||void 0===window.addEventListener)return()=>{};let e=()=>this.setOnline(!0),t=()=>this.setOnline(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e,!1),window.removeEventListener("offline",t,!1)}}};function q(){return globalThis[D]||(globalThis[D]=new k),globalThis[D]}let F=()=>Math.floor(Date.now()/1e3);var H=Object.defineProperty,G=Object.defineProperties,W=Object.getOwnPropertyDescriptors,V=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,Y=(e,t,r)=>t in e?H(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,K=(e,t)=>{for(var r in t||(t={}))z.call(t,r)&&Y(e,r,t[r]);if(V)for(var r of V(t))J.call(t,r)&&Y(e,r,t[r]);return e},X=(e,t)=>G(e,W(t)),Z=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r,Error.captureStackTrace(this,this.constructor)}},Q=async(e,t)=>{var r,n,o,s,i,l;let a=t||{},u={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:a,hooks:u};for(let c of(null==t?void 0:t.plugins)||[]){if(c.init){let n=await (null==(r=c.init)?void 0:r.call(c,e.toString(),t));a=n.options||a,e=n.url}u.onRequest.push(null==(n=c.hooks)?void 0:n.onRequest),u.onResponse.push(null==(o=c.hooks)?void 0:o.onResponse),u.onSuccess.push(null==(s=c.hooks)?void 0:s.onSuccess),u.onError.push(null==(i=c.hooks)?void 0:i.onError),u.onRetry.push(null==(l=c.hooks)?void 0:l.onRetry)}return{url:e,options:a,hooks:u}},ee=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},et=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},er=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let[n,o]=await Promise.all([r(e.auth.username),r(e.auth.password)]);if(!n||!o)return t;t.authorization=`Basic ${btoa(`${n}:${o}`)}`}else if("Custom"===e.auth.type){let[n,o]=await Promise.all([r(e.auth.prefix),r(e.auth.value)]);if(!o)return t;t.authorization=`${null!=n?n:""} ${o}`}}return t},en=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function eo(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function es(e){try{return JSON.parse(e)}catch(t){return e}}function ei(e){return"function"==typeof e}async function el(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await er(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=eo(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var ea=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function eu(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new ea(r.issues);return r.value}var ec=["get","post","put","patch","delete"],ed=async(e,t)=>{var r,n,o,s,i,l,a,u;let c,{hooks:d,url:f,options:p}=await Q(e,t),h=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("u">typeof globalThis&&ei(globalThis.fetch))return globalThis.fetch;if("u">typeof window&&ei(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(p),v=new AbortController,y=null!=(r=p.signal)?r:v.signal,m=function(e,t){let{baseURL:r,params:n,query:o}=t||{query:{},params:{},baseURL:""},s=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];ec.includes(t)&&(e=e.replace(`@${t}/`,"/"))}s.endsWith("/")||(s+="/");let[i,l]=e.replace(s,"").split("?"),a=new URLSearchParams(l);for(let[e,t]of Object.entries(o||{})){let r;if(null!=t){if("string"==typeof t)r=t;else if(Array.isArray(t)){for(let r of t)a.append(e,r);continue}else r=JSON.stringify(t);a.set(e,r)}}if(n)if(Array.isArray(n))for(let[e,t]of i.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];i=i.replace(t,r)}else for(let[e,t]of Object.entries(n))i=i.replace(`:${e}`,String(t));(i=i.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(i=i.slice(1));let u=a.toString();return(u=u.length>0?`?${u}`.replace(/\+/g,"%20"):"",s.startsWith("http"))?new URL(`${i}${u}`,s):`${s}${i}${u}`}(f,p),b=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(eo(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&"application/x-www-form-urlencoded"===t.get("content-type")&&eo(e.body)?new URLSearchParams(e.body).toString():e.body}(p),g=await el(p),w=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return ec.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(f,p),R=X(K({},p),{url:m,headers:g,body:b,method:w,signal:y});for(let e of d.onRequest)if(e){let t=await e(R);"object"==typeof t&&null!==t&&(R=t)}("pipeTo"in R&&"function"==typeof R.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in R)&&(R.duplex="half");let{clearTimeout:T}=(!(null==p?void 0:p.signal)&&(null==p?void 0:p.timeout)&&(c=setTimeout(()=>null==v?void 0:v.abort(),null==p?void 0:p.timeout)),{abortTimeout:c,clearTimeout:()=>{c&&clearTimeout(c)}}),E=await h(R.url,R);T();let O={response:E,request:R};for(let e of d.onResponse)if(e){let r=await e(X(K({},O),{response:(null==(o=null==t?void 0:t.hookOptions)?void 0:o.cloneResponse)?E.clone():E}));r instanceof Response?E=r:"object"==typeof r&&null!==r&&(E=r.response)}if(E.ok){if("HEAD"===R.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return en.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}(E),r={data:null,response:E,request:R};if("json"===e||"text"===e){let e=await E.text(),t=null!=(s=R.jsonParser)?s:es;r.data=await t(e)}else r.data=await E[e]();for(let e of((null==R?void 0:R.output)&&R.output&&!R.disableValidation&&(r.data=await eu(R.output,r.data)),d.onSuccess))e&&await e(X(K({},r),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?E.clone():E}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let S=null!=(l=null==t?void 0:t.jsonParser)?l:es,_=await E.text(),A=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(_),L=A?await S(_):null,I={response:E,responseText:_,request:R,error:X(K({},L),{status:E.status,statusText:E.statusText})};for(let e of d.onError)e&&await e(X(K({},I),{response:(null==(a=null==t?void 0:t.hookOptions)?void 0:a.cloneResponse)?E.clone():E}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new ee({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new ee(e);case"exponential":return new et(e);default:throw Error("Invalid retry strategy")}}(t.retry),n=null!=(u=t.retryAttempt)?u:0;if(await r.shouldAttemptRetry(n,E)){for(let e of d.onRetry)e&&await e(O);let o=r.getDelay(n);return await new Promise(e=>setTimeout(e,o)),await ed(e,X(K({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new Z(E.status,E.statusText,A?L:_);return{data:null,error:X(K({},L),{status:E.status,statusText:E.statusText})}},ef=e.i(271645);function ep(e){return{newRole:e=>{var t;return{authorize(e,r="AND"){let n=!1;for(let[o,s]of Object.entries(e)){let e=t[o];if(!e)return{success:!1,error:`You are not allowed to access resource: ${o}`};if(Array.isArray(s))n=s.every(t=>e.includes(t));else if("object"==typeof s)n="OR"===s.connector?s.actions.some(t=>e.includes(t)):s.actions.every(t=>e.includes(t));else throw new w("Invalid access control request");if(n&&"OR"===r)return{success:n};if(!n&&"AND"===r)return{success:!1,error:`unauthorized to access resource "${o}"`}}return n?{success:n}:{success:!1,error:"Not authorized"}},statements:t=e}},statements:e}}let eh=ep({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),ev=eh.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),ey=eh.newRole({user:[],session:[]}),em={admin:ev,user:ey},eb=ep({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]});eb.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"],ac:["create","read","update","delete"]}),eb.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),eb.newRole({organization:[],member:[],invitation:[],team:[],ac:["read"]});let eg=function(e){var t;let{pluginPathMethods:r,pluginsActions:n,pluginsAtoms:o,$fetch:s,$store:i,atomListeners:a}=((e,t)=>{var r;let n,o,s="credentials"in Request.prototype,i=function(e,t,r,n,o){if(e)return R(e,t);if(!1!==n){let e=l.BETTER_AUTH_URL||l.NEXT_PUBLIC_BETTER_AUTH_URL||l.PUBLIC_BETTER_AUTH_URL||l.NUXT_PUBLIC_BETTER_AUTH_URL||l.NUXT_PUBLIC_AUTH_URL||("/"!==l.BASE_URL?l.BASE_URL:void 0);if(e)return R(e,t)}r?.headers.get("x-forwarded-host"),r?.headers.get("x-forwarded-proto");if(r){let e=function(e){try{let t=new URL(e);return"null"===t.origin?null:t.origin}catch{return null}}(r.url);if(!e)throw new w("Could not get origin from request. Please provide a valid base URL.");return R(e,t)}if("u">typeof window&&window.location)return R(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,void 0)??"/api/auth",a=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],u={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:c,onError:d,onRequest:f,onResponse:p,...h}=e?.fetchOptions||{},v=(r={baseURL:i,...s?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:o,parseDates:s=!0}=t;if("string"!=typeof e)return e;let i=e.trim();if(i.length>0&&'"'===i[0]&&i.endsWith('"')&&!i.slice(1,-1).includes('"'))return i.slice(1,-1);let l=i.toLowerCase();if(l.length<=9&&l in S)return S[l];if(!O.test(i)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(E).some(([e,t])=>{let r=t.test(i);return r&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(i,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){n&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(s&&"string"==typeof t){let e=function(e){let t=_.exec(e);if(!t)return null;let[,r,n,o,s,i,l,a,u,c,d]=t,f=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(o,10),parseInt(s,10),parseInt(i,10),parseInt(l,10),a?parseInt(a.padEnd(3,"0"),10):0));if(u){let e=(60*parseInt(c,10)+parseInt(d,10))*("+"===u?-1:1);f.setUTCMinutes(f.getUTCMinutes()+e)}return f instanceof Date&&!isNaN(f.getTime())?f:null}(t);if(e)return e}return o?o(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...h,plugins:[u,...h.plugins||[],...e?.disableDefaultFetchPlugins?[]:[T],...a]},async function(e,t){let n,o=X(K(K({},r),t),{plugins:[...(null==r?void 0:r.plugins)||[],(n=r||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,o,s,i;let l=(null==(o=null==(r=n.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:o.schema)||n.schema;if(l){let r=e;(null==(s=l.config)?void 0:s.prefix)&&r.startsWith(l.config.prefix)&&(r=r.replace(l.config.prefix,""),l.config.baseURL&&(e=e.replace(l.config.prefix,l.config.baseURL))),(null==(i=l.config)?void 0:i.baseURL)&&r.startsWith(l.config.baseURL)&&(r=r.replace(l.config.baseURL,""));let n=l.schema[r];if(n){let r=X(K({},t),{method:n.method,output:n.output});return(null==t?void 0:t.disableValidation)||(r=X(K({},r),{body:n.input?await eu(n.input,null==t?void 0:t.body):null==t?void 0:t.body,params:n.params?await eu(n.params,null==t?void 0:t.params):null==t?void 0:t.params,query:n.query?await eu(n.query,null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}}),...(null==t?void 0:t.plugins)||[]]});if(null==r?void 0:r.catchAllError)try{return await ed(e,o)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await ed(e,o)}),{$sessionSignal:y,session:m}=(o=((e,t,r,n)=>{let o=U({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>s(e)}),s=async e=>new Promise(s=>{let i="function"==typeof n?n({data:o.get().data,error:o.get().error,isPending:o.get().isPending}):n;r(t,{...i,query:{...i?.query,...e?.query},async onSuccess(e){o.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await i?.onSuccess?.(e)},async onError(e){let{request:t}=e,r="number"==typeof t.retry?t.retry:t.retry?.attempts,n=t.retryAttempt||0;r&&n<r||(o.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch}),await i?.onError?.(e))},async onRequest(e){let t=o.get();o.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:o.value.refetch}),await i?.onRequest?.(e)}}).catch(e=>{o.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:o.value.refetch})}).finally(()=>{s(void 0)})});e=Array.isArray(e)?e:[e];let i=!1;for(let t of e)t.subscribe(async()=>{x()||(i?await s():P(o,()=>{let e=setTimeout(async()=>{i||(await s(),i=!0)},0);return()=>{o.off(),t.off(),clearTimeout(e)}}))});return o})(n=U(!1),"/get-session",v,{method:"GET"}),P(o,()=>{let t=function(e){let{sessionAtom:t,sessionSignal:r,$fetch:n,options:o={}}=e,s=o.sessionOptions?.refetchInterval??0,i=o.sessionOptions?.refetchOnWindowFocus??!0,l=o.sessionOptions?.refetchWhenOffline??!1,a={lastSync:0,lastSessionRequest:0,cachedSession:void 0},u=e=>{if(!(l||q().isOnline))return;if(e?.event==="storage"){a.lastSync=F(),r.set(!r.get());return}let o=t.get();if(e?.event==="poll"){a.lastSessionRequest=F(),n("/get-session").then(e=>{e.error?t.set({...o,data:null,error:e.error}):t.set({...o,data:e.data,error:null}),a.lastSync=F(),r.set(!r.get())}).catch(()=>{});return}e?.event==="visibilitychange"&&F()-a.lastSessionRequest<5&&o?.data!==null&&o?.data!==void 0||(o?.data===null||o?.data===void 0||e?.event==="visibilitychange")&&(e?.event==="visibilitychange"&&(a.lastSessionRequest=F()),a.lastSync=F(),r.set(!r.get()))};return{init:()=>{s&&s>0&&(a.pollInterval=setInterval(()=>{t.get()?.data&&u({event:"poll"})},1e3*s)),a.unsubscribeBroadcast=$().subscribe(()=>{u({event:"storage"})}),i&&(a.unsubscribeFocus=M().subscribe(()=>{u({event:"visibilitychange"})})),a.unsubscribeOnline=q().subscribe(e=>{e&&u({event:"visibilitychange"})}),$().setup(),M().setup(),q().setup()},cleanup:()=>{a.pollInterval&&(clearInterval(a.pollInterval),a.pollInterval=void 0),a.unsubscribeBroadcast&&(a.unsubscribeBroadcast(),a.unsubscribeBroadcast=void 0),a.unsubscribeFocus&&(a.unsubscribeFocus(),a.unsubscribeFocus=void 0),a.unsubscribeOnline&&(a.unsubscribeOnline(),a.unsubscribeOnline=void 0),a.lastSync=0,a.lastSessionRequest=0,a.cachedSession=void 0},triggerRefetch:u,broadcastSessionUpdate:e=>{$().post({event:"session",data:{trigger:e},clientId:Math.random().toString(36).substring(7)})}}}({sessionAtom:o,sessionSignal:n,$fetch:v,options:e});return t.init(),()=>{t.cleanup()}}),{session:o,$sessionSignal:n}),b=e?.plugins||[],g={},A={$sessionSignal:y,session:m},L={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},I=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||"/sign-up/email"===e||"/sign-in/email"===e||"/delete-user"===e||"/verify-email"===e||"/revoke-sessions"===e||"/revoke-session"===e||"/change-email"===e}];for(let e of b)e.getAtoms&&Object.assign(A,e.getAtoms?.(v)),e.pathMethods&&Object.assign(L,e.pathMethods),e.atomListeners&&I.push(...e.atomListeners);let C={notify:e=>{A[e].set(!A[e].get())},listen:(e,t)=>{A[e].subscribe(t)},atoms:A};for(let t of b)t.getActions&&Object.assign(g,t.getActions?.(v,C,e));return{get baseURL(){return i},pluginsActions:g,pluginsAtoms:A,pluginPathMethods:L,atomListeners:I,$fetch:v,$store:C}})(e),u={};for(let[e,t]of Object.entries(o))u[function(e){return`use${e.charAt(0).toUpperCase()+e.slice(1)}`}(e)]=()=>(function(e,t={}){let r=(0,ef.useRef)(e.get()),{keys:n,deps:o=[e,n]}=t,s=(0,ef.useCallback)(t=>{let o=e=>{r.current!==e&&(r.current=e,t())};if(o(e.value),n?.length){let t;return t=new Set(n).add(void 0),e.listen((e,r,n)=>{t.has(n)&&o(e,r,n)})}return e.listen(o)},o),i=()=>r.current;return(0,ef.useSyncExternalStore)(s,i,i)})(t);return t={...n,...u,$fetch:s,$store:i},function e(n=[]){return new Proxy(function(){},{get(r,o){var s;if("string"!=typeof o||"then"===o||"catch"===o||"finally"===o)return;let i=[...n,o],l=t;for(let e of i)if(l&&"object"==typeof l&&e in l)l=l[e];else{l=void 0;break}return"function"==typeof l?l:"object"==typeof(s=l)&&null!==s&&"get"in s&&"function"==typeof s.get&&"lc"in s&&"number"==typeof s.lc?l:e(i)},apply:async(e,t,i)=>{let l="/"+n.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),u=i[0]||{},c=i[1]||{},{query:d,fetchOptions:f,...p}=u,h={...c,...f},v=function(e,t,r){let n=t[e],{fetchOptions:o,query:s,...i}=r||{};return n||(o?.method?o.method:i&&Object.keys(i).length>0?"POST":"GET")}(l,r,u);return await s(l,{...h,body:"GET"===v?void 0:{...p,...h?.body||{}},query:d||h?.query,method:v,async onSuccess(e){if(await h?.onSuccess?.(e),!a||h.disableSignal)return;let t=a.filter(e=>e.matcher(l));if(t.length)for(let e of t){let t=o[e.signal];if(!t)return;let r=t.get();setTimeout(()=>{t.set(!r)},10)}}})}})}()}({plugins:[(n={admin:ev,user:ey,...void 0},{id:"admin-client",$InferServerPlugin:{},getActions:()=>({admin:{checkRolePermission:e=>(e=>{if(e.userId&&e.options?.adminUserIds?.includes(e.userId))return!0;if(!e.permissions&&!e.permission)return!1;let t=(e.role||e.options?.defaultRole||"user").split(","),r=e.options?.roles||em;for(let n of t)if(r[n]?.authorize(e.permission??e.permissions)?.success)return!0;return!1})({role:e.role,options:{ac:void 0,roles:n},permissions:e.permissions??e.permission})}}),pathMethods:{"/admin/list-users":"GET","/admin/stop-impersonating":"POST"}})]});e.s(["authClient",0,eg],672136)}]);