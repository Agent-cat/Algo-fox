module.exports=[504318,a=>{"use strict";var b=a.i(137936),c=a.i(231191);async function d(a){try{let b=await c.prisma.tag.findMany({where:{name:{contains:a,mode:"insensitive"}},take:10,orderBy:{name:"asc"}});return{success:!0,tags:b}}catch(a){return console.error("Failed to search tags:",a),{success:!1,error:"Failed to search tags"}}}async function e(a){try{let b=a.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),d=await c.prisma.tag.upsert({where:{slug:b},update:{},create:{name:a,slug:b}});return{success:!0,tag:d}}catch(a){return console.error("Failed to create tag:",a),{success:!1,error:"Failed to create tag"}}}(0,a.i(713095).ensureServerEntryExports)([d,e]),(0,b.registerServerReference)(d,"4074b06ca84484bc055023b365e0b346c50832fedb",null),(0,b.registerServerReference)(e,"404f3242dee18020ac1f8e3044d26384a5f88f6c5c",null),a.s(["createTag",()=>e,"searchTags",()=>d])},338253,a=>{"use strict";var b=a.i(137936),c=a.i(402597),d=a.i(800717),e=a.i(409223),f=a.i(905246),g=a.i(231191),h=a.i(463021),i=a.i(118558),j=a.i(713095);let k=async function(){(0,i.cacheLife)({stale:900,revalidate:900}),(0,i.cacheTag)("course-allocations");try{let a=await g.prisma.courseAllocation.findMany({orderBy:[{year:"asc"},{domain:"asc"}]});return{success:!0,allocations:a}}catch(a){return console.error("Error fetching course allocations:",a),{success:!1,error:"Failed to fetch course allocations"}}};var l=(0,d.cache)(function(){return(0,c.cache)("default","80acd0e5cdc01b35c11a77653c46d7535a3eaba534",0,k,arguments)});(0,b.registerServerReference)(l,"80acd0e5cdc01b35c11a77653c46d7535a3eaba534",null),Object.defineProperty(l,"name",{value:"getCourseAllocations"});let m=async function(a){(0,i.cacheLife)({stale:900,revalidate:900}),(0,i.cacheTag)("course-allocations",`course-year-${a}`);try{let b=await g.prisma.courseAllocation.findMany({where:{year:a},select:{domain:!0}});return{success:!0,domains:b.map(a=>a.domain)}}catch(a){return console.error("Error fetching courses by year:",a),{success:!1,error:"Failed to fetch courses",domains:[]}}};var n=(0,d.cache)(function(){return(0,c.cache)("default","c0dd08b727db429b3d86d07cae53567fbf3e0e70e9",0,m,arguments)});(0,b.registerServerReference)(n,"c0dd08b727db429b3d86d07cae53567fbf3e0e70e9",null),Object.defineProperty(n,"name",{value:"getCoursesByYear"});let o=async function(){(0,i.cacheLife)({stale:900,revalidate:900});let a=await e.auth.api.getSession({headers:await (0,f.headers)()});if(!a?.user)return{success:!1,error:"Unauthorized",domains:[]};let b=a.user.id;(0,i.cacheTag)(`user-courses-${b}`);try{let a=await g.prisma.user.findUnique({where:{id:b},select:{year:!0,role:!0}});if(!a)return{success:!1,error:"User not found",domains:[]};if(["ADMIN","TEACHER","INSTITUTION_MANAGER","CONTEST_MANAGER"].includes(a.role))return{success:!0,domains:Object.values(h.ProblemDomain),isPrivileged:!0};if(!a.year)return{success:!0,domains:[],isPrivileged:!1};let c=await g.prisma.courseAllocation.findMany({where:{year:a.year},select:{domain:!0}});return{success:!0,domains:c.map(a=>a.domain),isPrivileged:!1}}catch(a){return console.error("Error fetching user allocated courses:",a),{success:!1,error:"Failed to fetch courses",domains:[]}}};var p=(0,d.cache)(function(){return(0,c.cache)("private","8086c1a77f679988322147222ee681d1ea6c8bf63b",0,o,arguments)});async function q(a,b){let c=await e.auth.api.getSession({headers:await (0,f.headers)()});if(!c?.user)return{success:!1,error:"Unauthorized"};if(!["ADMIN","INSTITUTION_MANAGER"].includes(c.user.role))return{success:!1,error:"Insufficient permissions"};try{return await g.prisma.courseAllocation.create({data:{year:a,domain:b}}),(0,i.revalidatePath)("/admin/course-allocation"),(0,i.revalidatePath)("/dashboard/institution/course-allocation"),(0,i.revalidatePath)("/problems"),{success:!0}}catch(a){if(console.error("Error allocating course:",a),"P2002"===a.code)return{success:!1,error:"Course already allocated to this year"};return{success:!1,error:"Failed to allocate course"}}}async function r(a,b){let c=await e.auth.api.getSession({headers:await (0,f.headers)()});if(!c?.user)return{success:!1,error:"Unauthorized"};if(!["ADMIN","INSTITUTION_MANAGER"].includes(c.user.role))return{success:!1,error:"Insufficient permissions"};try{return await g.prisma.courseAllocation.delete({where:{year_domain:{year:a,domain:b}}}),(0,i.revalidatePath)("/admin/course-allocation"),(0,i.revalidatePath)("/dashboard/institution/course-allocation"),(0,i.revalidatePath)("/problems"),{success:!0}}catch(a){return console.error("Error removing course allocation:",a),{success:!1,error:"Failed to remove allocation"}}}async function s(a,b){let c=await e.auth.api.getSession({headers:await (0,f.headers)()});if(!c?.user)return{success:!1,error:"Unauthorized"};if(!["ADMIN","INSTITUTION_MANAGER"].includes(c.user.role))return{success:!1,error:"Insufficient permissions"};try{return await g.prisma.courseAllocation.deleteMany({where:{year:a}}),b.length>0&&await g.prisma.courseAllocation.createMany({data:b.map(b=>({year:a,domain:b}))}),(0,i.revalidatePath)("/admin/course-allocation"),(0,i.revalidatePath)("/dashboard/institution/course-allocation"),(0,i.revalidatePath)("/problems"),{success:!0}}catch(a){return console.error("Error updating year allocations:",a),{success:!1,error:"Failed to update allocations"}}}(0,b.registerServerReference)(p,"8086c1a77f679988322147222ee681d1ea6c8bf63b",null),Object.defineProperty(p,"name",{value:"getUserAllocatedCourses"}),(0,j.ensureServerEntryExports)([q,r,s]),(0,b.registerServerReference)(q,"6053406d501a7d100a71d59fc57a4cf00b4de33871",null),(0,b.registerServerReference)(r,"60d31e458fff4a256f0b5e0352ddb7776d5ecf338d",null),(0,b.registerServerReference)(s,"60c2e1a72d096d3c7e7e0c1e61858d61d675213bad",null),a.s(["$$RSC_SERVER_CACHE_0",()=>l,"$$RSC_SERVER_CACHE_1",()=>n,"$$RSC_SERVER_CACHE_2",()=>p,"allocateCourse",()=>q,"getCourseAllocations",()=>l,"getUserAllocatedCourses",()=>p,"removeCourseAllocation",()=>r,"updateYearAllocations",()=>s])},817330,a=>{"use strict";var b=a.i(191679),c=a.i(154470),d=a.i(165099),e=a.i(394627),f=a.i(504318),g=a.i(338253);a.s([],254461),a.i(254461),a.s(["00f4c838ce10f91796a39f1558a3b75432fa49882a",()=>b.checkSessionConflict,"4002126267c5e0c1a5eb6b4769d671952c3eb4b33f",()=>e.deleteCategory,"4014304237a5ed6061fce76d4dc3305ebfb0fd8a23",()=>d.deleteProblem,"4053663bceb8a80c0085656d61a1b89bee3cb8d166",()=>e.getCategoryById,"4074b06ca84484bc055023b365e0b346c50832fedb",()=>f.searchTags,"409bc5870257fe05de038549e85b0722c4e09c83d4",()=>b.resolveSessionConflict,"40df636e269e6ad8e68e86a17b941428478fb1279a",()=>e.createCategory,"40e1211e72f1dc7920c0a8ee0b74370faaecda9170",()=>d.createProblem,"600fce90ff1d93c6a9f08094f28d2d9fce60ec2e62",()=>e.createProblemAndAddToCategory,"6018cfd1a9446b467132bb3005cd5fbc9c7dc25352",()=>d.updateProblem,"6053406d501a7d100a71d59fc57a4cf00b4de33871",()=>g.allocateCourse,"6079c58c3044096e2e3c0e124762f766628d945274",()=>e.updateCategory,"60b46bf5e1d43c63d9c7c46a5bfd4c643bdc8d6822",()=>d.getRandomProblem,"60c2e1a72d096d3c7e7e0c1e61858d61d675213bad",()=>g.updateYearAllocations,"60d2264b1f398652eb46eab2bb3759572857722502",()=>e.removeProblemFromCategory,"60d31e458fff4a256f0b5e0352ddb7776d5ecf338d",()=>g.removeCourseAllocation,"706fc56ae5305db762dbcd7da21f654785f49478af",()=>e.addProblemToCategory,"8086c1a77f679988322147222ee681d1ea6c8bf63b",()=>g.$$RSC_SERVER_CACHE_2,"80acd0e5cdc01b35c11a77653c46d7535a3eaba534",()=>g.$$RSC_SERVER_CACHE_0,"80ee7282f708e60661ecc42477a6d2afba42f1d5ed",()=>c.getUserScore,"c00481d7c636b3c34d88ef3edfb836b3f52d585ca2",()=>e.$$RSC_SERVER_CACHE_1,"c01ca31fce0d3f3a9d5c4fe8e7dcb9a400d16af8c9",()=>e.getCategories,"c03ca813178452bbbae3c2f73e142d974ebca1bd3c",()=>d.$$RSC_SERVER_CACHE_4,"c09ae840f666ff7cf1044b8dacf9ba74f35becae73",()=>d.$$RSC_SERVER_CACHE_3,"c0c536a067826bdbc6a9d96fcd0283fe6b4b7d5371",()=>e.$$RSC_SERVER_CACHE_0,"c0dd08b727db429b3d86d07cae53567fbf3e0e70e9",()=>g.$$RSC_SERVER_CACHE_1,"f06ec890302fb7a19ff15ecfb41c0c32b185c64131",()=>d.$$RSC_SERVER_CACHE_6,"f07500676e7437c89c7059a3d08b36e62d85af89e8",()=>d.searchProblems,"f0a770803c047b595b099d239cdb62f4718b946f12",()=>d.$$RSC_SERVER_CACHE_5,"f0b018e5f5a26d01121898a6e259aaccaf8f15cdc7",()=>d.$$RSC_SERVER_CACHE_2,"f88ea1c2067191c078fad313714852f8fe7db11df1",()=>e.getCategoryProblems,"f8fbb220165bf0d072e938406b4eb817d99729a202",()=>e.$$RSC_SERVER_CACHE_2,"fcc5948267071860c259505ca828ac15ed8fea1df3",()=>d.$$RSC_SERVER_CACHE_1,"ff161ca534fa0477106bff83d2b07e07a7d461630c",()=>d.getProblems,"fff597832a5488ff4847c1f911f0e8872dd30ad1e7",()=>d.$$RSC_SERVER_CACHE_0],817330)},588010,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_adapters_memory-adapter_index_mjs_35d2dbfd._.js"].map(b=>a.l(b))).then(()=>b(700031)))},860484,a=>{a.v(b=>Promise.all(["server/chunks/ssr/node_modules_better-auth_dist_adapters_kysely-adapter_index_mjs_0abbd964._.js"].map(b=>a.l(b))).then(()=>b(536063)))},946014,a=>{a.v(b=>Promise.all(["server/chunks/ssr/a9bf9_better-auth_dist_adapters_kysely-adapter_bun-sqlite-dialect_mjs_23698f07._.js"].map(b=>a.l(b))).then(()=>b(496824)))},945599,a=>{a.v(b=>Promise.all(["server/chunks/ssr/a9bf9_better-auth_dist_adapters_kysely-adapter_node-sqlite-dialect_mjs_9102e2ec._.js"].map(b=>a.l(b))).then(()=>b(68928)))},1067,a=>{a.v(a=>Promise.resolve().then(()=>a(167784)))}];

//# sourceMappingURL=_3760bd3c._.js.map