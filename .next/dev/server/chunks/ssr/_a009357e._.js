module.exports = [
"[project]/actions/data:5704e2 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

/* __next_internal_action_entry_do_not_use__ [{"40fcf50c7b1ee991289ef809f621af905c86ec6963":"getContestParticipants"},"actions/contest.ts",""] */ __turbopack_context__.s([
    "getContestParticipants",
    ()=>getContestParticipants
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
"use turbopack no side effects";
;
var getContestParticipants = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("40fcf50c7b1ee991289ef809f621af905c86ec6963", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "getContestParticipants"); //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vY29udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzZXJ2ZXJcIjtcblxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuaW1wb3J0IHsgYXV0aCB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XG5pbXBvcnQgeyBoZWFkZXJzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoLCByZXZhbGlkYXRlVGFnIH0gZnJvbSBcIm5leHQvY2FjaGVcIjtcbmltcG9ydCB7IHVuc3RhYmxlX2NhY2hlIGFzIGNhY2hlLCB1bnN0YWJsZV9ub1N0b3JlIGFzIG5vU3RvcmUgfSBmcm9tIFwibmV4dC9jYWNoZVwiO1xuaW1wb3J0IHsgY2FjaGVUYWcsIGNhY2hlTGlmZSB9IGZyb20gXCJuZXh0L2NhY2hlXCI7XG5pbXBvcnQgeyBhZnRlciB9IGZyb20gXCJuZXh0L3NlcnZlclwiOyAvLyBGb3IgYmFja2dyb3VuZCB0YXNrc1xuXG5jb25zdCBjb250ZXN0U2NoZW1hID0gei5vYmplY3Qoe1xuICAgIHRpdGxlOiB6LnN0cmluZygpLm1pbigzLCBcIlRpdGxlIG11c3QgYmUgYXQgbGVhc3QgMyBjaGFyYWN0ZXJzXCIpLFxuICAgIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgc3RhcnRUaW1lOiB6LmNvZXJjZS5kYXRlKCksXG4gICAgZW5kVGltZTogei5jb2VyY2UuZGF0ZSgpLFxuICAgIHZpc2liaWxpdHk6IHouZW51bShbXCJQVUJMSUNcIiwgXCJJTlNUSVRVVElPTlwiLCBcIkNMQVNTUk9PTVwiXSksXG4gICAgY2xhc3Nyb29tSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBpbnN0aXR1dGlvbklkOiB6LnN0cmluZygpLm9wdGlvbmFsKCkubnVsbGFibGUoKSxcbiAgICBwcm9ibGVtczogei5hcnJheSh6LnN0cmluZygpKS5taW4oMSwgXCJTZWxlY3QgYXQgbGVhc3Qgb25lIHByb2JsZW1cIiksXG4gICAgY29udGVzdFBhc3N3b3JkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcmFuZG9taXplUXVlc3Rpb25zOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbn0pO1xuXG5jb25zdCBjb250ZXN0V2l0aFByb2JsZW1zU2NoZW1hID0gei5vYmplY3Qoe1xuICAgIHRpdGxlOiB6LnN0cmluZygpLm1pbigzLCBcIlRpdGxlIG11c3QgYmUgYXQgbGVhc3QgMyBjaGFyYWN0ZXJzXCIpLFxuICAgIHNsdWc6IHouc3RyaW5nKCkubWluKDMsIFwiU2x1ZyBtdXN0IGJlIGF0IGxlYXN0IDMgY2hhcmFjdGVyc1wiKSxcbiAgICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIHN0YXJ0VGltZTogei5kYXRlKCksXG4gICAgZW5kVGltZTogei5kYXRlKCksXG4gICAgdmlzaWJpbGl0eTogei5lbnVtKFtcIlBVQkxJQ1wiLCBcIklOU1RJVFVUSU9OXCIsIFwiQ0xBU1NST09NXCJdKSxcbiAgICBoaWRkZW46IHouYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpLFxuICAgIGNsYXNzcm9vbUlkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgaW5zdGl0dXRpb25JZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLm51bGxhYmxlKCksXG4gICAgYmFja2dyb3VuZEltYWdlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcHJpemVzOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcnVsZXM6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBwcm9ibGVtczogei5hcnJheSh6LmFueSgpKSwgLy8gRnVsbCBwcm9ibGVtIGRhdGEgb2JqZWN0c1xuICAgIGNvbnRlc3RQYXNzd29yZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIHJhbmRvbWl6ZVF1ZXN0aW9uczogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSksXG59KTtcblxuLyoqXG4gKiBGZXRjaGVzIGNvbnRlc3RzIHZpc2libGUgdG8gdGhlIGN1cnJlbnQgdXNlci5cbiAqL1xuLyoqXG4gKiBDYWNoZWQgZmV0Y2ggZm9yIHB1YmxpYyBjb250ZXN0c1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXRQdWJsaWNDb250ZXN0cygpIHtcbiAgICBcInVzZSBjYWNoZVwiXG4gICAgY2FjaGVUYWcoXCJjb250ZXN0cy1wdWJsaWNcIik7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNhY2hlTGlmZShcImNvbnRlc3RzXCIpO1xuXG4gICAgcmV0dXJuIHByaXNtYS5jb250ZXN0LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIHZpc2liaWxpdHk6IFwiUFVCTElDXCIsXG4gICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBfY291bnQ6IHsgc2VsZWN0OiB7IHByb2JsZW1zOiB0cnVlIH0gfVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IHN0YXJ0VGltZTogXCJkZXNjXCIgfSxcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBGZXRjaGVzIGNvbnRlc3RzIHZpc2libGUgdG8gdGhlIGN1cnJlbnQgdXNlci5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFZpc2libGVDb250ZXN0cygpIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIHRyeSB7XG4gICAgICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xuICAgICAgICAgICAgY29uc3QgY29udGVzdHMgPSBhd2FpdCBnZXRQdWJsaWNDb250ZXN0cygpO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdHMgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gc2Vzc2lvbi51c2VyIGFzIGFueTtcblxuICAgICAgICBpZiAoY3VycmVudFVzZXIucm9sZSA9PT0gXCJBRE1JTlwiKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXN0cyA9IGF3YWl0IHByaXNtYS5jb250ZXN0LmZpbmRNYW55KHtcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgICAgIF9jb3VudDogeyBzZWxlY3Q6IHsgcHJvYmxlbXM6IHRydWUgfSB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvcmRlckJ5OiB7IHN0YXJ0VGltZTogXCJkZXNjXCIgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdHMgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRlc3RzID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZE1hbnkoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgICAgICAgICB7IHZpc2liaWxpdHk6IFwiUFVCTElDXCIgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgQU5EOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB2aXNpYmlsaXR5OiBcIklOU1RJVFVUSU9OXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGluc3RpdHV0aW9uSWQ6IGN1cnJlbnRVc2VyLmluc3RpdHV0aW9uSWQgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEFORDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdmlzaWJpbGl0eTogXCJDTEFTU1JPT01cIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3Nyb29tOiB7IHN0dWRlbnRzOiB7IHNvbWU6IHsgaWQ6IGN1cnJlbnRVc2VyLmlkIH0gfSB9IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNyZWF0b3JJZDogY3VycmVudFVzZXIuaWQgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjcmVhdG9ySWQ6IGN1cnJlbnRVc2VyLmlkIH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgX2NvdW50OiB7IHNlbGVjdDogeyBwcm9ibGVtczogdHJ1ZSB9IH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHN0YXJ0VGltZTogXCJkZXNjXCIgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdHMgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIGNvbnRlc3RzOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggY29udGVzdHNcIiB9O1xuICAgIH1cbn1cblxuXG4vKipcbiAqIEZldGNoZXMgYSBzaW5nbGUgY29udGVzdCdzIGRldGFpbHMgd2l0aCBhdXRob3JpemF0aW9uLlxuICovXG4vKipcbiAqIEZldGNoZXMgYSBzaW5nbGUgY29udGVzdCdzIGRldGFpbHMgd2l0aCBhdXRob3JpemF0aW9uLlxuICovXG4vKipcbiAqIENhY2hlZCBjb250ZXN0IGRldGFpbCBmZXRjaGVyXG4gKiBSZXR1cm5zIGNvbnRlc3QgZGF0YSB3aXRob3V0IHVzZXItc3BlY2lmaWMgY29udGV4dFxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRDYWNoZWRDb250ZXN0KGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgXCJ1c2UgY2FjaGVcIlxuICAgIGNhY2hlVGFnKGBjb250ZXN0LSR7Y29udGVzdElkfWApO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjYWNoZUxpZmUoXCJjb250ZXN0LWRldGFpbFwiKTtcblxuICAgIHJldHVybiBwcmlzbWEuY29udGVzdC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgcHJvYmxlbXM6IHRydWUgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm9ibGVtczoge1xuICAgICAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgcHJvYmxlbToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbHVnOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgb3JkZXI6IFwiYXNjXCIgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5cbi8qKlxuICogRmV0Y2hlcyBhIHNpbmdsZSBjb250ZXN0J3MgZGV0YWlscyB3aXRoIGF1dGhvcml6YXRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb250ZXN0RGV0YWlsKGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgZ2V0Q2FjaGVkQ29udGVzdChjb250ZXN0SWQpO1xuXG4gICAgICAgIGlmICghY29udGVzdCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gc2Vzc2lvbj8udXNlciBhcyBhbnk7XG4gICAgICAgIGNvbnN0IHBhcnRpY2lwYXRpb24gPSBjdXJyZW50VXNlciA/IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGN1cnJlbnRVc2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkgOiBudWxsO1xuXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IGhhc1N0YXJ0ZWQgPSBub3cgPj0gY29udGVzdC5zdGFydFRpbWU7XG4gICAgICAgIGNvbnN0IGlzQ3JlYXRvciA9IGN1cnJlbnRVc2VyPy5pZCA9PT0gY29udGVzdC5jcmVhdG9ySWQ7XG4gICAgICAgIGNvbnN0IGlzQWRtaW4gPSBjdXJyZW50VXNlcj8ucm9sZSA9PT0gXCJBRE1JTlwiO1xuXG4gICAgICAgIC8vIFZpc2liaWxpdHkgQ2hlY2tcbiAgICAgICAgbGV0IGlzQXV0aG9yaXplZCA9IGZhbHNlO1xuICAgICAgICBpZiAoY29udGVzdC52aXNpYmlsaXR5ID09PSBcIlBVQkxJQ1wiKSB7XG4gICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKGlzQWRtaW4pIHtcbiAgICAgICAgICAgIGlzQXV0aG9yaXplZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIGlmIChpc0NyZWF0b3IpIHtcbiAgICAgICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZXN0LnZpc2liaWxpdHkgPT09IFwiSU5TVElUVVRJT05cIikge1xuICAgICAgICAgICAgICAgIC8vIFVzZSA9PSBmb3IgbnVsbC91bmRlZmluZWQgbG9vc2UgZXF1YWxpdHkgY2hlY2tcbiAgICAgICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSBjdXJyZW50VXNlci5pbnN0aXR1dGlvbklkID09IGNvbnRlc3QuaW5zdGl0dXRpb25JZDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVzdC52aXNpYmlsaXR5ID09PSBcIkNMQVNTUk9PTVwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5yb2xsbWVudCA9IGF3YWl0IHByaXNtYS5jbGFzc3Jvb20uZmluZEZpcnN0KHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZXN0LmNsYXNzcm9vbUlkIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0dWRlbnRzOiB7IHNvbWU6IHsgaWQ6IGN1cnJlbnRVc2VyLmlkIH0gfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSAhIWVucm9sbG1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzQXV0aG9yaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZCBhY2Nlc3MgdG8gdGhpcyBjb250ZXN0LlwiIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYW5TZWVQcm9ibGVtcyA9IChoYXNTdGFydGVkIHx8IGlzQWRtaW4gfHwgaXNDcmVhdG9yKSAmJiAocGFydGljaXBhdGlvbj8uYWNjZXB0ZWRSdWxlcyB8fCBpc0NyZWF0b3IgfHwgaXNBZG1pbik7XG5cbiAgICAgICAgLy8gRml4OiBJZiB0aGUgY29udGVzdCBpcyBvdmVyLCBhbGxvd2VkIHJvbGVzIHNob3VsZCBjaGVjayBwYXJ0aWNpcGF0aW9uIHByb3Blcmx5LFxuICAgICAgICAvLyBidXQgdHlwaWNhbGx5IGFsbG93cyB2aWV3aW5nIGlmIHB1YmxpYy9hdXRob3JpemVkLlxuICAgICAgICAvLyBCdXQgZm9yIFwiTGl2ZVwiIGNvbnRlc3RzLCB0aGUgY3VycmVudCBsb2dpYyBpcyBjb3JyZWN0LlxuXG4gICAgICAgIGNvbnN0IHJlcXVpcmVzUGFzc3dvcmQgPSAhIWNvbnRlc3QuY29udGVzdFBhc3N3b3JkO1xuXG4gICAgICAgIC8vIFNodWZmbGUgcHJvYmxlbXMgaWYgcmFuZG9taXplUXVlc3Rpb25zIGlzIGVuYWJsZWRcbiAgICAgICAgLy8gVXNlIGEgc2ltcGxlIHNlZWRlZCBzaHVmZmxlIGJhc2VkIG9uIHVzZXJJZCArIGNvbnRlc3RJZCBmb3IgY29uc2lzdGVuY3lcbiAgICAgICAgbGV0IHZpc2libGVQcm9ibGVtcyA9IGNhblNlZVByb2JsZW1zID8gY29udGVzdC5wcm9ibGVtcyA6IFtdO1xuXG4gICAgICAgIGlmIChjb250ZXN0LnJhbmRvbWl6ZVF1ZXN0aW9ucyAmJiBjdXJyZW50VXNlciAmJiB2aXNpYmxlUHJvYmxlbXMubGVuZ3RoID4gMCAmJiAhaXNBZG1pbiAmJiAhaXNDcmVhdG9yKSB7XG4gICAgICAgICAgICAvLyBTaW1wbGUgc3RyaW5nIGhhc2ggZnVuY3Rpb24gZm9yIHNlZWRpbmdcbiAgICAgICAgICAgIGNvbnN0IHNlZWRTdHIgPSBgJHtjdXJyZW50VXNlci5pZH0tJHtjb250ZXN0SWR9YDtcbiAgICAgICAgICAgIGxldCBzZWVkID0gMDtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VlZFN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlZWQgPSAoKHNlZWQgPDwgNSkgLSBzZWVkKSArIHNlZWRTdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgICAgICBzZWVkIHw9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERldGVybWluaXN0aWMgc2h1ZmZsZVxuICAgICAgICAgICAgdmlzaWJsZVByb2JsZW1zID0gWy4uLnZpc2libGVQcm9ibGVtc10uc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLnNpbihzZWVkKyspICogMTAwMDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh4IC0gTWF0aC5mbG9vcih4KSkgLSAwLjU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZldGNoIHVzZXIncyBzb2x2ZWQgcHJvYmxlbXMgZm9yIHRoaXMgY29udGVzdFxuICAgICAgICBjb25zdCBzb2x2ZWRQcm9ibGVtSWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICAgIGlmIChjdXJyZW50VXNlcikge1xuICAgICAgICAgICAgY29uc3Qgc29sdmVkU3VibWlzc2lvbnMgPSBhd2FpdCBwcmlzbWEuc3VibWlzc2lvbi5maW5kTWFueSh7XG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50VXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJBQ0NFUFRFRFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9ibGVtSWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluOiB2aXNpYmxlUHJvYmxlbXMubWFwKHAgPT4gcC5wcm9ibGVtLmlkKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgcHJvYmxlbUlkOiB0cnVlIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc29sdmVkU3VibWlzc2lvbnMuZm9yRWFjaChzID0+IHNvbHZlZFByb2JsZW1JZHMuYWRkKHMucHJvYmxlbUlkKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRlc3Q6IHtcbiAgICAgICAgICAgICAgICAuLi5jb250ZXN0LFxuICAgICAgICAgICAgICAgIHByb2JsZW1zOiB2aXNpYmxlUHJvYmxlbXMubWFwKHZwID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZwLFxuICAgICAgICAgICAgICAgICAgICBpc1NvbHZlZDogc29sdmVkUHJvYmxlbUlkcy5oYXModnAucHJvYmxlbS5pZClcbiAgICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICAgICAgaGFzU3RhcnRlZCxcbiAgICAgICAgICAgICAgICBoYXNFbmRlZDogbm93ID4gY29udGVzdC5lbmRUaW1lLFxuICAgICAgICAgICAgICAgIGNhbk1hbmFnZTogaXNBZG1pbiB8fCBpc0NyZWF0b3IsXG4gICAgICAgICAgICAgICAgaGFzQWNjZXB0ZWRSdWxlczogcGFydGljaXBhdGlvbj8uYWNjZXB0ZWRSdWxlcyB8fCBmYWxzZSxcbiAgICAgICAgICAgICAgICBpc0ZpbmlzaGVkOiBwYXJ0aWNpcGF0aW9uPy5pc0ZpbmlzaGVkIHx8IGZhbHNlLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVzUGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgY29udGVzdFBhc3N3b3JkOiBudWxsLCAvLyBOZXZlciByZXR1cm4gcGxhaW4gcGFzc3dvcmRcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQ6IHBhcnRpY2lwYXRpb24/LnNlc3Npb25JZCAvLyBSZXR1cm4gc2Vzc2lvbklkIGZvciBwcm90ZWN0aW9uXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBjb250ZXN0IGRldGFpbDpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGZldGNoIGNvbnRlc3RcIiB9O1xuICAgIH1cbn1cblxuLy8gLi4uIGV4aXN0aW5nIGNvZGUgLi4uXG5cbi8vIC4uLiBleGlzdGluZyBjb2RlIC4uLlxuXG4vLyAuLi4gZXhpc3RpbmcgY29kZSAuLi5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvbnRlc3QoZGF0YTogei5pbmZlcjx0eXBlb2YgY29udGVzdFNjaGVtYT4pIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHNlc3Npb24udXNlciBhcyBhbnk7XG5cbiAgICBpZiAoIVtcIkFETUlOXCIsIFwiSU5TVElUVVRJT05fTUFOQUdFUlwiLCBcIkNPTlRFU1RfTUFOQUdFUlwiLCBcIlRFQUNIRVJcIl0uaW5jbHVkZXMoY3VycmVudFVzZXIucm9sZSkpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGVkRGF0YSA9IGNvbnRlc3RTY2hlbWEucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgYSBtb3JlIHJvYnVzdCB1bmlxdWUgc2x1Z1xuICAgICAgICBjb25zdCBiYXNlU2x1ZyA9IHZhbGlkYXRlZERhdGEudGl0bGUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0rL2csIFwiLVwiKS5yZXBsYWNlKC8oXi18LSQpL2csIFwiXCIpO1xuICAgICAgICBjb25zdCB1bmlxdWVTbHVnID0gYCR7YmFzZVNsdWd9LSR7RGF0ZS5ub3coKX1gO1xuXG4gICAgICAgIGNvbnN0IGNvbnRlc3QgPSBhd2FpdCBwcmlzbWEuY29udGVzdC5jcmVhdGUoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHRpdGxlOiB2YWxpZGF0ZWREYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgIHNsdWc6IHVuaXF1ZVNsdWcsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHZhbGlkYXRlZERhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lOiB2YWxpZGF0ZWREYXRhLnN0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICBlbmRUaW1lOiB2YWxpZGF0ZWREYXRhLmVuZFRpbWUsXG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5IGFzIGFueSxcbiAgICAgICAgICAgICAgICBpbnN0aXR1dGlvbklkOiB2YWxpZGF0ZWREYXRhLnZpc2liaWxpdHkgIT09IFwiUFVCTElDXCIgPyAodmFsaWRhdGVkRGF0YS5pbnN0aXR1dGlvbklkIHx8IG51bGwpIDogbnVsbCxcbiAgICAgICAgICAgICAgICBjbGFzc3Jvb21JZDogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5ID09PSBcIkNMQVNTUk9PTVwiID8gKHZhbGlkYXRlZERhdGEuY2xhc3Nyb29tSWQgfHwgbnVsbCkgOiBudWxsLFxuICAgICAgICAgICAgICAgIGNyZWF0b3JJZDogY3VycmVudFVzZXIuaWQsXG4gICAgICAgICAgICAgICAgY29udGVzdFBhc3N3b3JkOiB2YWxpZGF0ZWREYXRhLmNvbnRlc3RQYXNzd29yZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIHJhbmRvbWl6ZVF1ZXN0aW9uczogdmFsaWRhdGVkRGF0YS5yYW5kb21pemVRdWVzdGlvbnMgfHwgZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJvYmxlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlOiB2YWxpZGF0ZWREYXRhLnByb2JsZW1zLm1hcCgocHJvYmxlbUlkLCBpbmRleCkgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2JsZW1JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiBpbmRleCxcbiAgICAgICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICByZXZhbGlkYXRlUGF0aChcIi9kYXNoYm9hcmQvY29udGVzdHNcIik7XG4gICAgICAgIHJldmFsaWRhdGVQYXRoKFwiL2NvbnRlc3RcIik7XG4gICAgICAgIHJldmFsaWRhdGVUYWcoXCJjb250ZXN0c1wiLCBcIm1heFwiKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdElkOiBjb250ZXN0LmlkIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBjb250ZXN0OlwiLCBlcnJvcik7XG4gICAgICAgIC8vIFJldHVybiBjbGVhcmVyIGVycm9yIG1lc3NhZ2VzXG4gICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBcIkZhaWxlZCB0byBjcmVhdGUgY29udGVzdFwiO1xuICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiB6LlpvZEVycm9yKSB7XG4gICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gKGVycm9yIGFzIGFueSkuZXJyb3JzLm1hcCgoZTogYW55KSA9PiBlLm1lc3NhZ2UpLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yTWVzc2FnZSB9O1xuICAgIH1cbiAgICB9XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvbnRlc3RXaXRoUHJvYmxlbXMoZGF0YTogei5pbmZlcjx0eXBlb2YgY29udGVzdFdpdGhQcm9ibGVtc1NjaGVtYT4pIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHNlc3Npb24udXNlciBhcyBhbnk7XG5cbiAgICBpZiAoIVtcIkFETUlOXCIsIFwiSU5TVElUVVRJT05fTUFOQUdFUlwiLCBcIkNPTlRFU1RfTUFOQUdFUlwiLCBcIlRFQUNIRVJcIl0uaW5jbHVkZXMoY3VycmVudFVzZXIucm9sZSkpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGVkRGF0YSA9IGNvbnRlc3RXaXRoUHJvYmxlbXNTY2hlbWEucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgY29uc3QgY29udGVzdCA9IGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgdHguY29udGVzdC5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHZhbGlkYXRlZERhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHNsdWc6IHZhbGlkYXRlZERhdGEuc2x1ZyxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHZhbGlkYXRlZERhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogdmFsaWRhdGVkRGF0YS5zdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIGVuZFRpbWU6IHZhbGlkYXRlZERhdGEuZW5kVGltZSxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5IGFzIGFueSxcbiAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiB2YWxpZGF0ZWREYXRhLmhpZGRlbixcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlOiB2YWxpZGF0ZWREYXRhLmJhY2tncm91bmRJbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgcHJpemVzOiB2YWxpZGF0ZWREYXRhLnByaXplcyxcbiAgICAgICAgICAgICAgICAgICAgcnVsZXM6IHZhbGlkYXRlZERhdGEucnVsZXMsXG4gICAgICAgICAgICAgICAgICAgIGluc3RpdHV0aW9uSWQ6IHZhbGlkYXRlZERhdGEudmlzaWJpbGl0eSAhPT0gXCJQVUJMSUNcIiA/ICh2YWxpZGF0ZWREYXRhLmluc3RpdHV0aW9uSWQgfHwgbnVsbCkgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBjbGFzc3Jvb21JZDogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5ID09PSBcIkNMQVNTUk9PTVwiID8gKHZhbGlkYXRlZERhdGEuY2xhc3Nyb29tSWQgfHwgbnVsbCkgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdG9ySWQ6IGN1cnJlbnRVc2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0UGFzc3dvcmQ6IHZhbGlkYXRlZERhdGEuY29udGVzdFBhc3N3b3JkIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHJhbmRvbWl6ZVF1ZXN0aW9uczogdmFsaWRhdGVkRGF0YS5yYW5kb21pemVRdWVzdGlvbnMgfHwgZmFsc2UsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsaWRhdGVkRGF0YS5wcm9ibGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHAgPSB2YWxpZGF0ZWREYXRhLnByb2JsZW1zW2ldO1xuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBzbHVnIGJ5IGFwcGVuZGluZyBjb250ZXN0IHNsdWcgYW5kIGluZGV4XG4gICAgICAgICAgICAgICAgY29uc3QgdW5pcXVlU2x1ZyA9IGAke3ZhbGlkYXRlZERhdGEuc2x1Z30tJHtwLnNsdWcgfHwgcC50aXRsZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJy0nKX0tJHtEYXRlLm5vdygpfS0ke2l9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9ibGVtID0gYXdhaXQgdHgucHJvYmxlbS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogcC50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBwLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogcC5kaWZmaWN1bHR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2x1ZzogdW5pcXVlU2x1ZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlOiBwLnNjb3JlIHx8IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBwLmRvbWFpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiQ09OVEVTVFwiLCAvLyBDb250ZXN0IHByb2JsZW1zIGFyZSBtYXJrZWQgc2VwYXJhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiB0cnVlLCAvLyBDb250ZXN0IHByb2JsZW1zIGFyZSBoaWRkZW4gZnJvbSBtYWluIGJhbmtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RDYXNlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZTogcC50ZXN0Q2FzZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Q6IHAudGFncz8ubWFwKCh0OiBzdHJpbmcpID0+ICh7IG5hbWU6IHQgfSkpIHx8IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jb250ZXN0UHJvYmxlbS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3QuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ibGVtSWQ6IHByb2JsZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlcjogaSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gY29udGVzdDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoXCIvZGFzaGJvYXJkL2NvbnRlc3RzXCIpO1xuICAgICAgICByZXZhbGlkYXRlUGF0aChcIi9jb250ZXN0c1wiKTtcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoXCIvY29udGVzdFwiKTtcbiAgICAgICAgcmV2YWxpZGF0ZVRhZyhcImNvbnRlc3RzXCIsIFwibWF4XCIpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjb250ZXN0SWQ6IGNvbnRlc3QuaWQgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBjb250ZXN0IHdpdGggcHJvYmxlbXM6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBjcmVhdGUgY29udGVzdFwiIH07XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGl0dXRpb25hbENsYXNzcm9vbXMoaW5zdGl0dXRpb25JZDogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY2xhc3Nyb29tcyA9IGF3YWl0IHByaXNtYS5jbGFzc3Jvb20uZmluZE1hbnkoe1xuICAgICAgICAgICAgd2hlcmU6IHsgaW5zdGl0dXRpb25JZCB9LFxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBzZWN0aW9uOiB0cnVlIH0sXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGFzc3Jvb21zIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBjbGFzc3Jvb21zOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggY2xhc3Nyb29tc1wiIH07XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2VsZWN0YWJsZVByb2JsZW1zKHNlYXJjaDogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvYmxlbXMgPSBhd2FpdCBwcmlzbWEucHJvYmxlbS5maW5kTWFueSh7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgdGl0bGU6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogXCJpbnNlbnNpdGl2ZVwiIH0gfSxcbiAgICAgICAgICAgICAgICAgICAgeyBzbHVnOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6IFwiaW5zZW5zaXRpdmVcIiB9IH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgdGl0bGU6IHRydWUsIGRpZmZpY3VsdHk6IHRydWUsIHNsdWc6IHRydWUgfSxcbiAgICAgICAgICAgIHRha2U6IDEwLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcHJvYmxlbXMgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHByb2JsZW1zOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggcHJvYmxlbXNcIiB9O1xuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFjY2VwdENvbnRlc3RSdWxlcyhjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cHNlcnQoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1cGRhdGU6IHsgYWNjZXB0ZWRSdWxlczogdHJ1ZSB9LFxuICAgICAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgYWNjZXB0ZWRSdWxlczogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoYC9jb250ZXN0LyR7Y29udGVzdElkfWApO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBhY2NlcHQgcnVsZXNcIiB9O1xuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmlzaENvbnRlc3RBY3Rpb24oY29udGVzdElkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICB0cnkge1xuICAgICAgICBhd2FpdCBwcmlzbWEuY29udGVzdFBhcnRpY2lwYXRpb24udXBzZXJ0KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgICAgICAgaXNGaW5pc2hlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBmaW5pc2hlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgYWNjZXB0ZWRSdWxlczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpc0ZpbmlzaGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGZpbmlzaGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldmFsaWRhdGVQYXRoKGAvY29udGVzdC8ke2NvbnRlc3RJZH1gKTtcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoYC9wcm9ibGVtc2ApO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBmaW5pc2ggY29udGVzdFwiIH07XG4gICAgfVxufVxuXG4vKipcbiAqIEZpbmFsaXplIENvbnRlc3QgJiBBd2FyZCBCYWRnZXNcbiAqIC0gQ2FsY3VsYXRlcyBsZWFkZXJib2FyZFxuICogLSBBd2FyZHMgR29sZCwgU2lsdmVyLCBCcm9uemUgdG8gVG9wIDNcbiAqIC0gTWFya3MgY29udGVzdCBhcyBmaW5hbGl6ZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmFsaXplQ29udGVzdChjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIC8vIE9ubHkgYWRtaW5zIG9yIGNvbnRlc3QgbWFuYWdlcnMgY2FuIGZpbmFsaXplXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBzZXNzaW9uLnVzZXIgYXMgYW55O1xuICAgIGlmICghW1wiQURNSU5cIiwgXCJDT05URVNUX01BTkFHRVJcIiwgXCJJTlNUSVRVVElPTl9NQU5BR0VSXCIsIFwiVEVBQ0hFUlwiXS5pbmNsdWRlcyhjdXJyZW50VXNlci5yb2xlKSkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICAgICAgIHNlbGVjdDogeyBpc0ZpbmFsaXplZDogdHJ1ZSwgdGl0bGU6IHRydWUgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWNvbnRlc3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJDb250ZXN0IG5vdCBmb3VuZFwiIH07XG4gICAgICAgIGlmIChjb250ZXN0LmlzRmluYWxpemVkKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBpcyBhbHJlYWR5IGZpbmFsaXplZFwiIH07XG5cbiAgICAgICAgLy8gUmV1c2UgbGVhZGVyYm9hcmQgbG9naWMgdG8gZ2V0IHJhbmtpbmdzXG4gICAgICAgIGNvbnN0IGxlYWRlcmJvYXJkID0gYXdhaXQgZ2V0Q29udGVzdExlYWRlcmJvYXJkKGNvbnRlc3RJZCk7XG4gICAgICAgIGlmICghbGVhZGVyYm9hcmQuc3VjY2VzcyB8fCAhbGVhZGVyYm9hcmQuc3R1ZGVudHMpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggbGVhZGVyYm9hcmRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3R1ZGVudHMgPSBsZWFkZXJib2FyZC5zdHVkZW50cyBhcyBhbnlbXTtcblxuICAgICAgICAvLyBBdCBsZWFzdCAxIHN0dWRlbnQgbmVlZGVkXG4gICAgICAgIGlmIChzdHVkZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICBhd2FpdCBwcmlzbWEuY29udGVzdC51cGRhdGUoe1xuICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY29udGVzdElkIH0sXG4gICAgICAgICAgICAgICAgIGRhdGE6IHsgaXNGaW5hbGl6ZWQ6IHRydWUgfVxuICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6IFwiQ29udGVzdCBmaW5hbGl6ZWQgKG5vIHBhcnRpY2lwYW50cylcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVG9wIDMgSURzXG4gICAgICAgIGNvbnN0IGdvbGRVc2VySWQgPSBzdHVkZW50c1swXT8uaWQ7XG4gICAgICAgIGNvbnN0IHNpbHZlclVzZXJJZCA9IHN0dWRlbnRzWzFdPy5pZDtcbiAgICAgICAgY29uc3QgYnJvbnplVXNlcklkID0gc3R1ZGVudHNbMl0/LmlkO1xuXG4gICAgICAgIGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XG4gICAgICAgICAgICAvLyBBd2FyZCBHb2xkXG4gICAgICAgICAgICBpZiAoZ29sZFVzZXJJZCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHR4LnVzZXIudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGdvbGRVc2VySWQgfSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBnb2xkQmFkZ2VzOiB7IGluY3JlbWVudDogMSB9IH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEF3YXJkIFNpbHZlclxuICAgICAgICAgICAgaWYgKHNpbHZlclVzZXJJZCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHR4LnVzZXIudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHNpbHZlclVzZXJJZCB9LFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHNpbHZlckJhZGdlczogeyBpbmNyZW1lbnQ6IDEgfSB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBd2FyZCBCcm9uemVcbiAgICAgICAgICAgIGlmIChicm9uemVVc2VySWQpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC51c2VyLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBicm9uemVVc2VySWQgfSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBicm9uemVCYWRnZXM6IHsgaW5jcmVtZW50OiAxIH0gfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBNYXJrIEZpbmFsaXplZFxuICAgICAgICAgICAgYXdhaXQgdHguY29udGVzdC51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjb250ZXN0SWQgfSxcbiAgICAgICAgICAgICAgICBkYXRhOiB7IGlzRmluYWxpemVkOiB0cnVlIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXZhbGlkYXRlUGF0aChgL2Rhc2hib2FyZGApO1xuICAgICAgICByZXZhbGlkYXRlUGF0aChgL3Byb2ZpbGUvJHtnb2xkVXNlcklkfWApO1xuICAgICAgICBpZihzaWx2ZXJVc2VySWQpIHJldmFsaWRhdGVQYXRoKGAvcHJvZmlsZS8ke3NpbHZlclVzZXJJZH1gKTtcbiAgICAgICAgaWYoYnJvbnplVXNlcklkKSByZXZhbGlkYXRlUGF0aChgL3Byb2ZpbGUvJHticm9uemVVc2VySWR9YCk7XG4gICAgICAgIHJldmFsaWRhdGVQYXRoKGAvY29udGVzdC8ke2NvbnRlc3RJZH1gKTtcbiAgICAgICAgcmV2YWxpZGF0ZVRhZyhgY29udGVzdC0ke2NvbnRlc3RJZH1gLCBcIm1heFwiKTtcbiAgICAgICAgcmV2YWxpZGF0ZVRhZyhgbGVhZGVyYm9hcmQtJHtjb250ZXN0SWR9YCwgXCJtYXhcIik7XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZmluYWxpemUgY29udGVzdDpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGZpbmFsaXplIGNvbnRlc3RcIiB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgY29udGVzdCBwYXNzd29yZCB3aXRob3V0IHN0YXJ0aW5nIHNlc3Npb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlDb250ZXN0UGFzc3dvcmQoY29udGVzdElkOiBzdHJpbmcsIHBhc3N3b3JkPzogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29udGVzdCA9IGF3YWl0IHByaXNtYS5jb250ZXN0LmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICAgICAgc2VsZWN0OiB7IGNvbnRlc3RQYXNzd29yZDogdHJ1ZSB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgICAgICBpZiAoY29udGVzdC5jb250ZXN0UGFzc3dvcmQgJiYgY29udGVzdC5jb250ZXN0UGFzc3dvcmQgIT09IHBhc3N3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSW52YWxpZCBjb250ZXN0IHBhc3N3b3JkXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHZlcmlmeSBjb250ZXN0IHBhc3N3b3JkOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gdmVyaWZ5IHBhc3N3b3JkXCIgfTtcbiAgICB9XG59XG5cblxuLyoqXG4gKiBTdGFydCBhIGNvbnRlc3Qgc2Vzc2lvbiAtIHZhbGlkYXRlcyB0aW1lIGJvdW5kcyBhbmQgY3JlYXRlcyBzZXNzaW9uIElEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFydENvbnRlc3RTZXNzaW9uKGNvbnRlc3RJZDogc3RyaW5nLCBwYXNzd29yZD86IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvbnRlc3QgPSBhd2FpdCBwcmlzbWEuY29udGVzdC5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjb250ZXN0SWQgfSxcbiAgICAgICAgICAgIHNlbGVjdDogeyBzdGFydFRpbWU6IHRydWUsIGVuZFRpbWU6IHRydWUsIGNvbnRlc3RQYXNzd29yZDogdHJ1ZSB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgICAgICBpZiAoY29udGVzdC5jb250ZXN0UGFzc3dvcmQgJiYgY29udGVzdC5jb250ZXN0UGFzc3dvcmQgIT09IHBhc3N3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSW52YWxpZCBjb250ZXN0IHBhc3N3b3JkXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgLy8gVGltZSBib3VuZHMgY2hlY2tcbiAgICAgICAgaWYgKG5vdyA8IGNvbnRlc3Quc3RhcnRUaW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBoYXMgbm90IHN0YXJ0ZWQgeWV0XCIgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm93ID4gY29udGVzdC5lbmRUaW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBoYXMgYWxyZWFkeSBlbmRlZFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZW5lcmF0ZSB1bmlxdWUgc2Vzc2lvbiBJRFxuICAgICAgICBjb25zdCBzZXNzaW9uSWQgPSBgJHtzZXNzaW9uLnVzZXIuaWR9LSR7Y29udGVzdElkfS0ke0RhdGUubm93KCl9YDtcblxuICAgICAgICAvLyBDaGVjayBmb3IgZXhpc3RpbmcgYWN0aXZlIHNlc3Npb24gKG11bHRpLXRhYiBkZXRlY3Rpb24pXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nUGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChleGlzdGluZ1BhcnRpY2lwYXRpb24/LmlzQmxvY2tlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIllvdSBoYXZlIGJlZW4gYmxvY2tlZCBmcm9tIHRoaXMgY29udGVzdCBkdWUgdG8gdmlvbGF0aW9uc1wiIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXhpc3RpbmdQYXJ0aWNpcGF0aW9uPy5pc0ZpbmlzaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiWW91IGhhdmUgYWxyZWFkeSBmaW5pc2hlZCB0aGlzIGNvbnRlc3RcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlIG9yIGNyZWF0ZSBwYXJ0aWNpcGF0aW9uIHdpdGggbmV3IHNlc3Npb25cbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cHNlcnQoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQsXG4gICAgICAgICAgICAgICAgc2Vzc2lvblN0YXJ0ZWRBdDogbm93LFxuICAgICAgICAgICAgICAgIGFjY2VwdGVkUnVsZXM6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZCxcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQsXG4gICAgICAgICAgICAgICAgc2Vzc2lvblN0YXJ0ZWRBdDogbm93LFxuICAgICAgICAgICAgICAgIGFjY2VwdGVkUnVsZXM6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBzZXNzaW9uSWQsXG4gICAgICAgICAgICBwYXJ0aWNpcGF0aW9uSWQ6IHBhcnRpY2lwYXRpb24uaWQsXG4gICAgICAgICAgICB0b3RhbFZpb2xhdGlvbnM6IHBhcnRpY2lwYXRpb24udG90YWxWaW9sYXRpb25zLFxuICAgICAgICAgICAgaXNGbGFnZ2VkOiBwYXJ0aWNpcGF0aW9uLmlzRmxhZ2dlZFxuICAgICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc3RhcnQgY29udGVzdCBzZXNzaW9uOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gc3RhcnQgY29udGVzdCBzZXNzaW9uXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogTG9nIGEgY29udGVzdCB2aW9sYXRpb24gLSByZWNvcmRzIHRvIGRhdGFiYXNlIGFuZCB1cGRhdGVzIGNvdW50ZXJzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dDb250ZXN0VmlvbGF0aW9uKFxuICAgIGNvbnRlc3RJZDogc3RyaW5nLFxuICAgIHR5cGU6IFwiVEFCX1NXSVRDSFwiIHwgXCJGVUxMU0NSRUVOX0VYSVRcIiB8IFwiQ09QWV9QQVNURVwiIHwgXCJERVZUT09MU19PUEVOXCIgfCBcIktFWUJPQVJEX1NIT1JUQ1VUXCIgfCBcIk5BVklHQVRJT05fQVRURU1QVFwiIHwgXCJNVUxUSV9UQUJcIiB8IFwiU1VTUElDSU9VU19JTlBVVFwiLFxuICAgIG1lc3NhZ2U/OiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJ0aWNpcGF0aW9uID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFwYXJ0aWNpcGF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gYWN0aXZlIHBhcnRpY2lwYXRpb24gZm91bmRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHdoaWNoIGNvdW50ZXIgdG8gaW5jcmVtZW50XG4gICAgICAgIGNvbnN0IGNvdW50ZXJGaWVsZCA9IHtcbiAgICAgICAgICAgIFRBQl9TV0lUQ0g6IFwidGFiU3dpdGNoQ291bnRcIixcbiAgICAgICAgICAgIEZVTExTQ1JFRU5fRVhJVDogXCJmdWxsc2NyZWVuRXhpdENvdW50XCIsXG4gICAgICAgICAgICBDT1BZX1BBU1RFOiBcImNvcHlQYXN0ZUNvdW50XCIsXG4gICAgICAgICAgICBERVZUT09MU19PUEVOOiBcImRldlRvb2xzQ291bnRcIixcbiAgICAgICAgICAgIEtFWUJPQVJEX1NIT1JUQ1VUOiBcImtleWJvYXJkQ291bnRcIixcbiAgICAgICAgICAgIE5BVklHQVRJT05fQVRURU1QVDogXCJuYXZpZ2F0aW9uQ291bnRcIixcbiAgICAgICAgICAgIE1VTFRJX1RBQjogXCJ0YWJTd2l0Y2hDb3VudFwiLFxuICAgICAgICAgICAgU1VTUElDSU9VU19JTlBVVDogXCJjb3B5UGFzdGVDb3VudFwiXG4gICAgICAgIH1bdHlwZV0gYXMgc3RyaW5nO1xuXG4gICAgICAgIC8vIFVzZSB0cmFuc2FjdGlvbiB0byBlbnN1cmUgYXRvbWljIHVwZGF0ZVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xuICAgICAgICAgICAgLy8gQ2hlY2sgbGFzdCB2aW9sYXRpb24gdGltZSB0byBwcmV2ZW50IHJhcGlkLWZpcmUgZHVwbGljYXRlcyAoU2VydmVyLXNpZGUgZGVib3VuY2UpXG4gICAgICAgICAgICBjb25zdCBsYXN0VmlvbGF0aW9uID0gYXdhaXQgdHguY29udGVzdFZpb2xhdGlvbi5maW5kRmlyc3Qoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHBhcnRpY2lwYXRpb25JZDogcGFydGljaXBhdGlvbi5pZCB9LFxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChsYXN0VmlvbGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGltZURpZmYgPSBEYXRlLm5vdygpIC0gbGFzdFZpb2xhdGlvbi5jcmVhdGVkQXQuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgIC8vIElmIGxlc3MgdGhhbiAyIHNlY29uZHMgc2luY2UgbGFzdCB2aW9sYXRpb24sIGlnbm9yZSB0aGlzIG9uZVxuICAgICAgICAgICAgICAgIGlmICh0aW1lRGlmZiA8IDIwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLnBhcnRpY2lwYXRpb24sIC8vIFJldHVybiBleGlzdGluZyBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgaXNGbGFnZ2VkOiBwYXJ0aWNpcGF0aW9uLmlzRmxhZ2dlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQmxvY2tlZDogcGFydGljaXBhdGlvbi5pc0Jsb2NrZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFZpb2xhdGlvbnM6IHBhcnRpY2lwYXRpb24udG90YWxWaW9sYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkOiBwYXJ0aWNpcGF0aW9uLnBlcm1hbmVudGx5QmxvY2tlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IHBhcnRpY2lwYXRpb24udGVtcEJsb2NrZWRVbnRpbFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHZpb2xhdGlvbiByZWNvcmRcbiAgICAgICAgICAgIGF3YWl0IHR4LmNvbnRlc3RWaW9sYXRpb24uY3JlYXRlKHtcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYXRpb25JZDogcGFydGljaXBhdGlvbi5pZCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSBhcyBhbnksXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBtZXRhZGF0YSA/PyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyB0b3RhbCBhbmQgZGV0ZXJtaW5lIGJsb2NraW5nIHRpZXJcbiAgICAgICAgICAgIGNvbnN0IG5ld1RvdGFsVmlvbGF0aW9ucyA9IHBhcnRpY2lwYXRpb24udG90YWxWaW9sYXRpb25zICsgMTtcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZEZsYWcgPSBuZXdUb3RhbFZpb2xhdGlvbnMgPj0gMztcblxuICAgICAgICAgICAgLy8gVGllcmVkIGJsb2NraW5nIGxvZ2ljXG4gICAgICAgICAgICBsZXQgdGVtcEJsb2NrZWRVbnRpbDogRGF0ZSB8IG51bGwgPSBudWxsO1xuICAgICAgICAgICAgbGV0IHBlcm1hbmVudGx5QmxvY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IGlzQmxvY2tlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAobmV3VG90YWxWaW9sYXRpb25zID49IDYpIHtcbiAgICAgICAgICAgICAgICAvLyA2KyB2aW9sYXRpb25zID0gcGVybWFuZW50IGJsb2NrXG4gICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpc0Jsb2NrZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdUb3RhbFZpb2xhdGlvbnMgPj0gNCkge1xuICAgICAgICAgICAgICAgIC8vIDQtNSB2aW9sYXRpb25zID0gNSBtaW51dGUgdGVtcCBibG9ja1xuICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWwgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgNSAqIDYwICogMTAwMCk7IC8vIDUgbWludXRlc1xuICAgICAgICAgICAgICAgIGlzQmxvY2tlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5jb250ZXN0UGFydGljaXBhdGlvbi51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXJ0aWNpcGF0aW9uLmlkIH0sXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBbY291bnRlckZpZWxkXTogeyBpbmNyZW1lbnQ6IDEgfSxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxWaW9sYXRpb25zOiB7IGluY3JlbWVudDogMSB9LFxuICAgICAgICAgICAgICAgICAgICBpc0ZsYWdnZWQ6IHNob3VsZEZsYWcgfHwgcGFydGljaXBhdGlvbi5pc0ZsYWdnZWQsXG4gICAgICAgICAgICAgICAgICAgIGlzQmxvY2tlZCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcEJsb2NrZWRVbnRpbCxcbiAgICAgICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIHRvdGFsVmlvbGF0aW9uczogcmVzdWx0LnRvdGFsVmlvbGF0aW9ucyxcbiAgICAgICAgICAgIGlzRmxhZ2dlZDogcmVzdWx0LmlzRmxhZ2dlZCxcbiAgICAgICAgICAgIGlzQmxvY2tlZDogcmVzdWx0LmlzQmxvY2tlZCxcbiAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IHJlc3VsdC50ZW1wQmxvY2tlZFVudGlsPy50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgICAgICBwZXJtYW5lbnRseUJsb2NrZWQ6IHJlc3VsdC5wZXJtYW5lbnRseUJsb2NrZWRcbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvZyB2aW9sYXRpb246XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBsb2cgdmlvbGF0aW9uXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogVmFsaWRhdGUgY29udGVzdCBzZXNzaW9uIC0gY2hlY2tzIGlmIHNlc3Npb24gaXMgdmFsaWQgZm9yIHN1Ym1pc3Npb25zXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUNvbnRlc3RTZXNzaW9uKGNvbnRlc3RJZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgdmFsaWQ6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIGNvbnRlc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IHN0YXJ0VGltZTogdHJ1ZSwgZW5kVGltZTogdHJ1ZSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIXBhcnRpY2lwYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbGlkOiBmYWxzZSwgcmVhc29uOiBcIk5vIHBhcnRpY2lwYXRpb24gZm91bmRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgYmxvY2tlZFxuICAgICAgICBpZiAocGFydGljaXBhdGlvbi5pc0Jsb2NrZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbGlkOiBmYWxzZSwgcmVhc29uOiBcIkJsb2NrZWQgZHVlIHRvIHZpb2xhdGlvbnNcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgZmluaXNoZWRcbiAgICAgICAgaWYgKHBhcnRpY2lwYXRpb24uaXNGaW5pc2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdmFsaWQ6IGZhbHNlLCByZWFzb246IFwiQ29udGVzdCBhbHJlYWR5IGZpbmlzaGVkXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIHNlc3Npb24gSUQgKG11bHRpLXRhYiBkZXRlY3Rpb24pXG4gICAgICAgIGlmIChwYXJ0aWNpcGF0aW9uLnNlc3Npb25JZCAhPT0gc2Vzc2lvbklkKSB7XG4gICAgICAgICAgICAvLyBMb2cgbXVsdGktdGFiIHZpb2xhdGlvblxuICAgICAgICAgICAgYXdhaXQgbG9nQ29udGVzdFZpb2xhdGlvbihjb250ZXN0SWQsIFwiTVVMVElfVEFCXCIsIFwiTXVsdGlwbGUgdGFicyBkZXRlY3RlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbGlkOiBmYWxzZSwgcmVhc29uOiBcIlNlc3Npb24gbWlzbWF0Y2ggLSBwb3NzaWJsZSBtdWx0aXBsZSB0YWJzXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIHRpbWUgYm91bmRzXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGlmIChub3cgPiBwYXJ0aWNpcGF0aW9uLmNvbnRlc3QuZW5kVGltZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdmFsaWQ6IGZhbHNlLCByZWFzb246IFwiQ29udGVzdCBoYXMgZW5kZWRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIHRvdGFsVmlvbGF0aW9uczogcGFydGljaXBhdGlvbi50b3RhbFZpb2xhdGlvbnMsXG4gICAgICAgICAgICBpc0ZsYWdnZWQ6IHBhcnRpY2lwYXRpb24uaXNGbGFnZ2VkXG4gICAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB2YWxpZGF0ZSBzZXNzaW9uOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCB2YWxpZDogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byB2YWxpZGF0ZSBzZXNzaW9uXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdXNlciBpcyBlbGlnaWJsZSB0byBzdWJtaXQgLSBwcmUtc3VibWlzc2lvbiB2YWxpZGF0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1N1Ym1pc3Npb25FbGlnaWJpbGl0eShjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJ0aWNpcGF0aW9uID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgY29udGVzdDoge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgc3RhcnRUaW1lOiB0cnVlLCBlbmRUaW1lOiB0cnVlIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghcGFydGljaXBhdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHsgZWxpZ2libGU6IGZhbHNlLCByZWFzb246IFwiTm8gcGFydGljaXBhdGlvbiBmb3VuZFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayB2YXJpb3VzIGNvbmRpdGlvbnNcbiAgICAgICAgaWYgKHBhcnRpY2lwYXRpb24uaXNCbG9ja2VkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIHJlYXNvbjogXCJCbG9ja2VkIGR1ZSB0byBleGNlc3NpdmUgdmlvbGF0aW9uc1wiIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFydGljaXBhdGlvbi5pc0ZpbmlzaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIHJlYXNvbjogXCJZb3UgaGF2ZSBhbHJlYWR5IGZpbmlzaGVkIHRoaXMgY29udGVzdFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBpZiAobm93IDwgcGFydGljaXBhdGlvbi5jb250ZXN0LnN0YXJ0VGltZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgZWxpZ2libGU6IGZhbHNlLCByZWFzb246IFwiQ29udGVzdCBoYXMgbm90IHN0YXJ0ZWRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5vdyA+IHBhcnRpY2lwYXRpb24uY29udGVzdC5lbmRUaW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIHJlYXNvbjogXCJDb250ZXN0IGhhcyBlbmRlZFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZWxpZ2libGU6IHRydWUsXG4gICAgICAgICAgICB3YXJuaW5nczogcGFydGljaXBhdGlvbi5pc0ZsYWdnZWQgPyBbXCJZb3VyIHNlc3Npb24gaGFzIGJlZW4gZmxhZ2dlZCBmb3IgcmV2aWV3XCJdIDogW11cbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNoZWNrIGVsaWdpYmlsaXR5OlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IGVsaWdpYmxlOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGNoZWNrIGVsaWdpYmlsaXR5XCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogR2V0IHBhcnRpY2lwYXRpb24gc3RhdHVzIC0gZm9yIFVJIHN0YXRlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQYXJ0aWNpcGF0aW9uU3RhdHVzKGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgYWNjZXB0ZWRSdWxlczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpc0ZpbmlzaGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlzRmxhZ2dlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpc0Jsb2NrZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgdG90YWxWaW9sYXRpb25zOiB0cnVlLFxuICAgICAgICAgICAgICAgIHNlc3Npb25JZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wQmxvY2tlZFVudGlsOiB0cnVlLFxuICAgICAgICAgICAgICAgIHBlcm1hbmVudGx5QmxvY2tlZDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDaGVjayBpZiB0ZW1wIGJsb2NrIGhhcyBleHBpcmVkXG4gICAgICAgIGlmIChwYXJ0aWNpcGF0aW9uPy50ZW1wQmxvY2tlZFVudGlsICYmIG5ldyBEYXRlKCkgPiBwYXJ0aWNpcGF0aW9uLnRlbXBCbG9ja2VkVW50aWwpIHtcbiAgICAgICAgICAgIC8vIFRlbXAgYmxvY2sgZXhwaXJlZCAtIHVuYmxvY2tcbiAgICAgICAgICAgIGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZF9jb250ZXN0SWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBpc0Jsb2NrZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wQmxvY2tlZFVudGlsOiBudWxsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwYXJ0aWNpcGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcnRpY2lwYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGlzQmxvY2tlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBwYXJ0aWNpcGF0aW9uOiBwYXJ0aWNpcGF0aW9uIHx8IG51bGxcbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGdldCBwYXJ0aWNpcGF0aW9uIHN0YXR1c1wiIH07XG4gICAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OVEVTVCBNQU5BR0VSIC0gUEFSVElDSVBBTlQgTUFOQUdFTUVOVFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZXQgYWxsIHBhcnRpY2lwYW50cyBmb3IgYSBjb250ZXN0IHdpdGggdmlvbGF0aW9uIGRldGFpbHMgKGZvciBtYW5hZ2VycylcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbnRlc3RQYXJ0aWNpcGFudHMoY29udGVzdElkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHNlc3Npb24udXNlciBhcyBhbnk7XG5cbiAgICAvLyBDaGVjayBpZiB1c2VyIGlzIGNvbnRlc3QgbWFuYWdlci9jcmVhdG9yXG4gICAgY29uc3QgY29udGVzdCA9IGF3YWl0IHByaXNtYS5jb250ZXN0LmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogY29udGVzdElkIH0sXG4gICAgICAgIHNlbGVjdDogeyBjcmVhdG9ySWQ6IHRydWUgfVxuICAgIH0pO1xuXG4gICAgaWYgKCFjb250ZXN0KSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBub3QgZm91bmRcIiB9O1xuXG4gICAgY29uc3QgaXNBdXRob3JpemVkID1cbiAgICAgICAgY3VycmVudFVzZXIucm9sZSA9PT0gXCJBRE1JTlwiIHx8XG4gICAgICAgIGN1cnJlbnRVc2VyLnJvbGUgPT09IFwiQ09OVEVTVF9NQU5BR0VSXCIgfHxcbiAgICAgICAgY3VycmVudFVzZXIucm9sZSA9PT0gXCJURUFDSEVSXCIgfHxcbiAgICAgICAgY29udGVzdC5jcmVhdG9ySWQgPT09IGN1cnJlbnRVc2VyLmlkO1xuXG4gICAgaWYgKCFpc0F1dGhvcml6ZWQpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhbnRzID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGNvbnRlc3RJZCB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZpb2xhdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6IFwiZGVzY1wiIH0sXG4gICAgICAgICAgICAgICAgICAgIHRha2U6IDEwXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9yZGVyQnk6IFtcbiAgICAgICAgICAgICAgICB7IHBlcm1hbmVudGx5QmxvY2tlZDogXCJkZXNjXCIgfSxcbiAgICAgICAgICAgICAgICB7IGlzQmxvY2tlZDogXCJkZXNjXCIgfSxcbiAgICAgICAgICAgICAgICB7IHRvdGFsVmlvbGF0aW9uczogXCJkZXNjXCIgfVxuICAgICAgICAgICAgXVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBwYXJ0aWNpcGFudHMgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGdldCBwYXJ0aWNpcGFudHM6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBnZXQgcGFydGljaXBhbnRzXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogVW5ibG9jayBhIHBhcnRpY2lwYW50IChtYW5hZ2VyIG9ubHkpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bmJsb2NrUGFydGljaXBhbnQoY29udGVzdElkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBzZXNzaW9uLnVzZXIgYXMgYW55O1xuXG4gICAgLy8gQ2hlY2sgYXV0aG9yaXphdGlvblxuICAgIGNvbnN0IGNvbnRlc3QgPSBhd2FpdCBwcmlzbWEuY29udGVzdC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICBzZWxlY3Q6IHsgY3JlYXRvcklkOiB0cnVlIH1cbiAgICB9KTtcblxuICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgIGNvbnN0IGlzQXV0aG9yaXplZCA9XG4gICAgICAgIGN1cnJlbnRVc2VyLnJvbGUgPT09IFwiQURNSU5cIiB8fFxuICAgICAgICBjdXJyZW50VXNlci5yb2xlID09PSBcIkNPTlRFU1RfTUFOQUdFUlwiIHx8XG4gICAgICAgIGN1cnJlbnRVc2VyLnJvbGUgPT09IFwiVEVBQ0hFUlwiIHx8XG4gICAgICAgIGNvbnRlc3QuY3JlYXRvcklkID09PSBjdXJyZW50VXNlci5pZDtcblxuICAgIGlmICghaXNBdXRob3JpemVkKSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cGRhdGUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBpc0Jsb2NrZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IG51bGwsXG4gICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0b3RhbFZpb2xhdGlvbnM6IDAsXG4gICAgICAgICAgICAgICAgdGFiU3dpdGNoQ291bnQ6IDAsXG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlbkV4aXRDb3VudDogMCxcbiAgICAgICAgICAgICAgICBjb3B5UGFzdGVDb3VudDogMCxcbiAgICAgICAgICAgICAgICBkZXZUb29sc0NvdW50OiAwLFxuICAgICAgICAgICAgICAgIGtleWJvYXJkQ291bnQ6IDAsXG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvbkNvdW50OiAwLFxuICAgICAgICAgICAgICAgIGlzRmxhZ2dlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdW5ibG9ja2VkQnk6IGN1cnJlbnRVc2VyLmlkLFxuICAgICAgICAgICAgICAgIHVuYmxvY2tlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKGAvZGFzaGJvYXJkL2NvbnRlc3RzLyR7Y29udGVzdElkfS9wYXJ0aWNpcGFudHNgKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gdW5ibG9jayBwYXJ0aWNpcGFudDpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIHVuYmxvY2sgcGFydGljaXBhbnRcIiB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBHZXQgZGV0YWlsZWQgdmlvbGF0aW9ucyBmb3IgYSBwYXJ0aWNpcGFudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydGljaXBhbnRWaW9sYXRpb25zKGNvbnRlc3RJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gc2Vzc2lvbi51c2VyIGFzIGFueTtcblxuICAgIC8vIENoZWNrIGF1dGhvcml6YXRpb25cbiAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBjb250ZXN0SWQgfSxcbiAgICAgICAgc2VsZWN0OiB7IGNyZWF0b3JJZDogdHJ1ZSB9XG4gICAgfSk7XG5cbiAgICBpZiAoIWNvbnRlc3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJDb250ZXN0IG5vdCBmb3VuZFwiIH07XG5cbiAgICBjb25zdCBpc0F1dGhvcml6ZWQgPVxuICAgICAgICBjdXJyZW50VXNlci5yb2xlID09PSBcIkFETUlOXCIgfHxcbiAgICAgICAgY3VycmVudFVzZXIucm9sZSA9PT0gXCJDT05URVNUX01BTkFHRVJcIiB8fFxuICAgICAgICBjdXJyZW50VXNlci5yb2xlID09PSBcIlRFQUNIRVJcIiB8fFxuICAgICAgICBjb250ZXN0LmNyZWF0b3JJZCA9PT0gY3VycmVudFVzZXIuaWQ7XG5cbiAgICBpZiAoIWlzQXV0aG9yaXplZCkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJ0aWNpcGF0aW9uID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgZW1haWw6IHRydWUgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmlvbGF0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogXCJkZXNjXCIgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcGFydGljaXBhdGlvbiB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZ2V0IHZpb2xhdGlvbnNcIiB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgY29udGVzdCBsZWFkZXJib2FyZFxuICogLSBGZXRjaGVzIGFsbCBwYXJ0aWNpcGF0aW9uc1xuICogLSBGZXRjaGVzIGFsbCByZWxldmFudCBzdWJtaXNzaW9uc1xuICogLSBDYWxjdWxhdGVzIHNjb3Jlc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udGVzdExlYWRlcmJvYXJkKGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgXCJ1c2UgY2FjaGVcIlxuICAgIGNhY2hlVGFnKGBsZWFkZXJib2FyZC0ke2NvbnRlc3RJZH1gKVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjYWNoZUxpZmUoXCJsZWFkZXJib2FyZFwiKVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbnMgPSBhd2FpdCBwcmlzbWEuY29udGVzdFBhcnRpY2lwYXRpb24uZmluZE1hbnkoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgLy8gc3RhcnRlZEF0OiB7IG5vdDogbnVsbCB9IC8vIE9ubHkgc3RhcnRlZCBwYXJ0aWNpcGFudHMgKEZpeCBpZiBmaWVsZCBleGlzdHMsIG90aGVyd2lzZSByZWx5IG9uIGNyZWF0ZWQpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICB3aGVyZTogeyBpZDogY29udGVzdElkIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgcHJvYmxlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvYmxlbToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZpY3VsdHk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsdWc6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcmRlckJ5OiB7IG9yZGVyOiBcImFzY1wiIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgICAgICBjb25zdCBsZWFkZXJib2FyZCA9IGF3YWl0IFByb21pc2UuYWxsKHBhcnRpY2lwYXRpb25zLm1hcChhc3luYyAocCkgPT4ge1xuICAgICAgICAgICAgLy8gR2V0IHZhbGlkIHN1Ym1pc3Npb25zIGZvciB0aGlzIHVzZXIgaW4gdGhpcyBjb250ZXN0XG4gICAgICAgICAgICBjb25zdCBzdWJtaXNzaW9ucyA9IGF3YWl0IHByaXNtYS5zdWJtaXNzaW9uLmZpbmRNYW55KHtcbiAgICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZCxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBndGU6IGNvbnRlc3Quc3RhcnRUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBjb250ZXN0LmVuZFRpbWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHByb2JsZW1JZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0b3RhbCBzY29yZVxuICAgICAgICAgICAgLy8gTG9naWM6IEJlc3Qgc3VibWlzc2lvbiBwZXIgcHJvYmxlbSBjb3VudHNcbiAgICAgICAgICAgIGNvbnN0IHByb2JsZW1TY29yZXMgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuICAgICAgICAgICAgY29uc3QgcHJvYmxlbVNvbHZlVGltZXMgPSBuZXcgTWFwPHN0cmluZywgRGF0ZT4oKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2JsZW1TdWJtaXNzaW9uQ291bnRzID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2JsZW1CZXN0U3VibWlzc2lvbnMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xuXG4gICAgICAgICAgICBzdWJtaXNzaW9ucy5mb3JFYWNoKHN1YiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudENvdW50ID0gcHJvYmxlbVN1Ym1pc3Npb25Db3VudHMuZ2V0KHN1Yi5wcm9ibGVtSWQpIHx8IDA7XG4gICAgICAgICAgICAgICAgcHJvYmxlbVN1Ym1pc3Npb25Db3VudHMuc2V0KHN1Yi5wcm9ibGVtSWQsIGN1cnJlbnRDb3VudCArIDEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN1Yi5zdGF0dXMgPT09IFwiQUNDRVBURURcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50QmVzdCA9IHByb2JsZW1TY29yZXMuZ2V0KHN1Yi5wcm9ibGVtSWQpIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2JsZW1EZWYgPSBjb250ZXN0LnByb2JsZW1zLmZpbmQoY3AgPT4gY3AucHJvYmxlbUlkID09PSBzdWIucHJvYmxlbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4U2NvcmUgPSBwcm9ibGVtRGVmPy5wcm9ibGVtLnNjb3JlIHx8IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1heFNjb3JlID4gY3VycmVudEJlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ibGVtU2NvcmVzLnNldChzdWIucHJvYmxlbUlkLCBtYXhTY29yZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEJlc3RUaW1lID0gcHJvYmxlbVNvbHZlVGltZXMuZ2V0KHN1Yi5wcm9ibGVtSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudEJlc3RUaW1lIHx8IHN1Yi5jcmVhdGVkQXQgPCBjdXJyZW50QmVzdFRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvYmxlbVNvbHZlVGltZXMuc2V0KHN1Yi5wcm9ibGVtSWQsIHN1Yi5jcmVhdGVkQXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ibGVtQmVzdFN1Ym1pc3Npb25zLnNldChzdWIucHJvYmxlbUlkLCBzdWIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgdG90YWxTY29yZSA9IDA7XG4gICAgICAgICAgICBsZXQgdG90YWxUaW1lTXMgPSAwO1xuXG4gICAgICAgICAgICBwcm9ibGVtU2NvcmVzLmZvckVhY2goKHNjb3JlLCBwcm9ibGVtSWQpID0+IHtcbiAgICAgICAgICAgICAgICB0b3RhbFNjb3JlICs9IHNjb3JlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvbHZlbnRUaW1lID0gcHJvYmxlbVNvbHZlVGltZXMuZ2V0KHByb2JsZW1JZCk7XG4gICAgICAgICAgICAgICAgaWYgKHNvbHZlbnRUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsVGltZU1zICs9IChzb2x2ZW50VGltZS5nZXRUaW1lKCkgLSBjb250ZXN0LnN0YXJ0VGltZS5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBNYXAgc3RhdHMgZm9yIGVhY2ggcHJvYmxlbSBpbiB0aGUgY29udGVzdFxuICAgICAgICAgICAgY29uc3QgcHJvYmxlbVN0YXRzID0gY29udGVzdC5wcm9ibGVtcy5tYXAoY3AgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJlc3RTdWIgPSBwcm9ibGVtQmVzdFN1Ym1pc3Npb25zLmdldChjcC5wcm9ibGVtSWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHByb2JsZW1JZDogY3AucHJvYmxlbUlkLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogY3AucHJvYmxlbS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgc2x1ZzogY3AucHJvYmxlbS5zbHVnLFxuICAgICAgICAgICAgICAgICAgICBzY29yZTogcHJvYmxlbVNjb3Jlcy5nZXQoY3AucHJvYmxlbUlkKSB8fCAwLFxuICAgICAgICAgICAgICAgICAgICBtYXhTY29yZTogY3AucHJvYmxlbS5zY29yZSxcbiAgICAgICAgICAgICAgICAgICAgc3VibWlzc2lvbnM6IHByb2JsZW1TdWJtaXNzaW9uQ291bnRzLmdldChjcC5wcm9ibGVtSWQpIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgIHNvbHZlZDogcHJvYmxlbVNjb3Jlcy5oYXMoY3AucHJvYmxlbUlkKSxcbiAgICAgICAgICAgICAgICAgICAgc29sdmVkQXQ6IHByb2JsZW1Tb2x2ZVRpbWVzLmdldChjcC5wcm9ibGVtSWQpLFxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZTogYmVzdFN1Yj8ubGFuZ3VhZ2U/Lm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2VJZDogYmVzdFN1Yj8ubGFuZ3VhZ2U/LmlkIHx8IG51bGxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgLi4ucC51c2VyLFxuICAgICAgICAgICAgICAgIHNjb3JlOiB0b3RhbFNjb3JlLFxuICAgICAgICAgICAgICAgIHRpbWVUYWtlbjogdG90YWxUaW1lTXMsXG4gICAgICAgICAgICAgICAgcHJvYmxlbXNTb2x2ZWQ6IHByb2JsZW1TY29yZXMuc2l6ZSxcbiAgICAgICAgICAgICAgICBwcm9ibGVtU3RhdHNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcblxuICAgICAgICAvLyBTb3J0OiBIaWdoIHNjb3JlIGZpcnN0LCB0aGVuIGxvdyB0aW1lIHRha2VuXG4gICAgICAgIGxlYWRlcmJvYXJkLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgIGlmIChiLnNjb3JlICE9PSBhLnNjb3JlKSByZXR1cm4gYi5zY29yZSAtIGEuc2NvcmU7XG4gICAgICAgICAgICByZXR1cm4gYS50aW1lVGFrZW4gLSBiLnRpbWVUYWtlbjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBzdHVkZW50czogbGVhZGVyYm9hcmQsXG4gICAgICAgICAgICBpc0ZpbmFsaXplZDogY29udGVzdC5pc0ZpbmFsaXplZCxcbiAgICAgICAgICAgIHByb2JsZW1zOiBjb250ZXN0LnByb2JsZW1zLm1hcChjcCA9PiAoe1xuICAgICAgICAgICAgICAgIGlkOiBjcC5wcm9ibGVtSWQsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGNwLnByb2JsZW0udGl0bGUsXG4gICAgICAgICAgICAgICAgc2x1ZzogY3AucHJvYmxlbS5zbHVnLFxuICAgICAgICAgICAgICAgIG1heFNjb3JlOiBjcC5wcm9ibGVtLnNjb3JlXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJMZWFkZXJib2FyZCBlcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGdlbmVyYXRlIGxlYWRlcmJvYXJkXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgdXNlcidzIHJhbmtpbmcgaW4gYSBjb250ZXN0XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb250ZXN0UmFua2luZyhjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldENvbnRlc3RMZWFkZXJib2FyZChjb250ZXN0SWQpO1xuXG4gICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MgfHwgIXJlc3VsdC5zdHVkZW50cykge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBnZXQgcmFua2luZ1wiIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByYW5rID0gcmVzdWx0LnN0dWRlbnRzLmZpbmRJbmRleCgoczogYW55KSA9PiBzLmlkID09PSBzZXNzaW9uLnVzZXIuaWQpICsgMTtcblxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCByYW5rOiByYW5rID4gMCA/IHJhbmsgOiBudWxsIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZ2V0IHJhbmtpbmdcIiB9O1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoia1NBaWpDc0IifQ==
}),
"[project]/actions/data:bd0e29 [app-ssr] (ecmascript) <text/javascript>", ((__turbopack_context__) => {
"use strict";

/* __next_internal_action_entry_do_not_use__ [{"60995be1625901022cd2485061fb5f529d27001da0":"unblockParticipant"},"actions/contest.ts",""] */ __turbopack_context__.s([
    "unblockParticipant",
    ()=>unblockParticipant
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js [app-ssr] (ecmascript)");
"use turbopack no side effects";
;
var unblockParticipant = /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["createServerReference"])("60995be1625901022cd2485061fb5f529d27001da0", __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["callServer"], void 0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$build$2f$webpack$2f$loaders$2f$next$2d$flight$2d$loader$2f$action$2d$client$2d$wrapper$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["findSourceMapURL"], "unblockParticipant"); //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4vY29udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzZXJ2ZXJcIjtcblxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuaW1wb3J0IHsgYXV0aCB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XG5pbXBvcnQgeyBoZWFkZXJzIH0gZnJvbSBcIm5leHQvaGVhZGVyc1wiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcbmltcG9ydCB7IHJldmFsaWRhdGVQYXRoLCByZXZhbGlkYXRlVGFnIH0gZnJvbSBcIm5leHQvY2FjaGVcIjtcbmltcG9ydCB7IHVuc3RhYmxlX2NhY2hlIGFzIGNhY2hlLCB1bnN0YWJsZV9ub1N0b3JlIGFzIG5vU3RvcmUgfSBmcm9tIFwibmV4dC9jYWNoZVwiO1xuaW1wb3J0IHsgY2FjaGVUYWcsIGNhY2hlTGlmZSB9IGZyb20gXCJuZXh0L2NhY2hlXCI7XG5pbXBvcnQgeyBhZnRlciB9IGZyb20gXCJuZXh0L3NlcnZlclwiOyAvLyBGb3IgYmFja2dyb3VuZCB0YXNrc1xuXG5jb25zdCBjb250ZXN0U2NoZW1hID0gei5vYmplY3Qoe1xuICAgIHRpdGxlOiB6LnN0cmluZygpLm1pbigzLCBcIlRpdGxlIG11c3QgYmUgYXQgbGVhc3QgMyBjaGFyYWN0ZXJzXCIpLFxuICAgIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgc3RhcnRUaW1lOiB6LmNvZXJjZS5kYXRlKCksXG4gICAgZW5kVGltZTogei5jb2VyY2UuZGF0ZSgpLFxuICAgIHZpc2liaWxpdHk6IHouZW51bShbXCJQVUJMSUNcIiwgXCJJTlNUSVRVVElPTlwiLCBcIkNMQVNTUk9PTVwiXSksXG4gICAgY2xhc3Nyb29tSWQ6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBpbnN0aXR1dGlvbklkOiB6LnN0cmluZygpLm9wdGlvbmFsKCkubnVsbGFibGUoKSxcbiAgICBwcm9ibGVtczogei5hcnJheSh6LnN0cmluZygpKS5taW4oMSwgXCJTZWxlY3QgYXQgbGVhc3Qgb25lIHByb2JsZW1cIiksXG4gICAgY29udGVzdFBhc3N3b3JkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcmFuZG9taXplUXVlc3Rpb25zOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbn0pO1xuXG5jb25zdCBjb250ZXN0V2l0aFByb2JsZW1zU2NoZW1hID0gei5vYmplY3Qoe1xuICAgIHRpdGxlOiB6LnN0cmluZygpLm1pbigzLCBcIlRpdGxlIG11c3QgYmUgYXQgbGVhc3QgMyBjaGFyYWN0ZXJzXCIpLFxuICAgIHNsdWc6IHouc3RyaW5nKCkubWluKDMsIFwiU2x1ZyBtdXN0IGJlIGF0IGxlYXN0IDMgY2hhcmFjdGVyc1wiKSxcbiAgICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIHN0YXJ0VGltZTogei5kYXRlKCksXG4gICAgZW5kVGltZTogei5kYXRlKCksXG4gICAgdmlzaWJpbGl0eTogei5lbnVtKFtcIlBVQkxJQ1wiLCBcIklOU1RJVFVUSU9OXCIsIFwiQ0xBU1NST09NXCJdKSxcbiAgICBoaWRkZW46IHouYm9vbGVhbigpLmRlZmF1bHQoZmFsc2UpLFxuICAgIGNsYXNzcm9vbUlkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgaW5zdGl0dXRpb25JZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLm51bGxhYmxlKCksXG4gICAgYmFja2dyb3VuZEltYWdlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcHJpemVzOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgcnVsZXM6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBwcm9ibGVtczogei5hcnJheSh6LmFueSgpKSwgLy8gRnVsbCBwcm9ibGVtIGRhdGEgb2JqZWN0c1xuICAgIGNvbnRlc3RQYXNzd29yZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIHJhbmRvbWl6ZVF1ZXN0aW9uczogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSksXG59KTtcblxuLyoqXG4gKiBGZXRjaGVzIGNvbnRlc3RzIHZpc2libGUgdG8gdGhlIGN1cnJlbnQgdXNlci5cbiAqL1xuLyoqXG4gKiBDYWNoZWQgZmV0Y2ggZm9yIHB1YmxpYyBjb250ZXN0c1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXRQdWJsaWNDb250ZXN0cygpIHtcbiAgICBcInVzZSBjYWNoZVwiXG4gICAgY2FjaGVUYWcoXCJjb250ZXN0cy1wdWJsaWNcIik7XG4gICAgLy8gQHRzLWlnbm9yZVxuICAgIGNhY2hlTGlmZShcImNvbnRlc3RzXCIpO1xuXG4gICAgcmV0dXJuIHByaXNtYS5jb250ZXN0LmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgIHZpc2liaWxpdHk6IFwiUFVCTElDXCIsXG4gICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBfY291bnQ6IHsgc2VsZWN0OiB7IHByb2JsZW1zOiB0cnVlIH0gfVxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IHN0YXJ0VGltZTogXCJkZXNjXCIgfSxcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBGZXRjaGVzIGNvbnRlc3RzIHZpc2libGUgdG8gdGhlIGN1cnJlbnQgdXNlci5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFZpc2libGVDb250ZXN0cygpIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIHRyeSB7XG4gICAgICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xuICAgICAgICAgICAgY29uc3QgY29udGVzdHMgPSBhd2FpdCBnZXRQdWJsaWNDb250ZXN0cygpO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdHMgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gc2Vzc2lvbi51c2VyIGFzIGFueTtcblxuICAgICAgICBpZiAoY3VycmVudFVzZXIucm9sZSA9PT0gXCJBRE1JTlwiKSB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXN0cyA9IGF3YWl0IHByaXNtYS5jb250ZXN0LmZpbmRNYW55KHtcbiAgICAgICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgICAgIF9jb3VudDogeyBzZWxlY3Q6IHsgcHJvYmxlbXM6IHRydWUgfSB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvcmRlckJ5OiB7IHN0YXJ0VGltZTogXCJkZXNjXCIgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdHMgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbnRlc3RzID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZE1hbnkoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgICAgICAgICB7IHZpc2liaWxpdHk6IFwiUFVCTElDXCIgfSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgQU5EOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeyB2aXNpYmlsaXR5OiBcIklOU1RJVFVUSU9OXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGluc3RpdHV0aW9uSWQ6IGN1cnJlbnRVc2VyLmluc3RpdHV0aW9uSWQgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEFORDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgdmlzaWJpbGl0eTogXCJDTEFTU1JPT01cIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgY2xhc3Nyb29tOiB7IHN0dWRlbnRzOiB7IHNvbWU6IHsgaWQ6IGN1cnJlbnRVc2VyLmlkIH0gfSB9IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7IGNyZWF0b3JJZDogY3VycmVudFVzZXIuaWQgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgeyBjcmVhdG9ySWQ6IGN1cnJlbnRVc2VyLmlkIH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgX2NvdW50OiB7IHNlbGVjdDogeyBwcm9ibGVtczogdHJ1ZSB9IH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvcmRlckJ5OiB7IHN0YXJ0VGltZTogXCJkZXNjXCIgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdHMgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIGNvbnRlc3RzOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggY29udGVzdHNcIiB9O1xuICAgIH1cbn1cblxuXG4vKipcbiAqIEZldGNoZXMgYSBzaW5nbGUgY29udGVzdCdzIGRldGFpbHMgd2l0aCBhdXRob3JpemF0aW9uLlxuICovXG4vKipcbiAqIEZldGNoZXMgYSBzaW5nbGUgY29udGVzdCdzIGRldGFpbHMgd2l0aCBhdXRob3JpemF0aW9uLlxuICovXG4vKipcbiAqIENhY2hlZCBjb250ZXN0IGRldGFpbCBmZXRjaGVyXG4gKiBSZXR1cm5zIGNvbnRlc3QgZGF0YSB3aXRob3V0IHVzZXItc3BlY2lmaWMgY29udGV4dFxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRDYWNoZWRDb250ZXN0KGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgXCJ1c2UgY2FjaGVcIlxuICAgIGNhY2hlVGFnKGBjb250ZXN0LSR7Y29udGVzdElkfWApO1xuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjYWNoZUxpZmUoXCJjb250ZXN0LWRldGFpbFwiKTtcblxuICAgIHJldHVybiBwcmlzbWEuY29udGVzdC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgcHJvYmxlbXM6IHRydWUgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwcm9ibGVtczoge1xuICAgICAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICAgICAgcHJvYmxlbToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbHVnOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgb3JkZXI6IFwiYXNjXCIgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgfSk7XG59XG5cbi8qKlxuICogRmV0Y2hlcyBhIHNpbmdsZSBjb250ZXN0J3MgZGV0YWlscyB3aXRoIGF1dGhvcml6YXRpb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb250ZXN0RGV0YWlsKGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgZ2V0Q2FjaGVkQ29udGVzdChjb250ZXN0SWQpO1xuXG4gICAgICAgIGlmICghY29udGVzdCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gc2Vzc2lvbj8udXNlciBhcyBhbnk7XG4gICAgICAgIGNvbnN0IHBhcnRpY2lwYXRpb24gPSBjdXJyZW50VXNlciA/IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IGN1cnJlbnRVc2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkgOiBudWxsO1xuXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IGhhc1N0YXJ0ZWQgPSBub3cgPj0gY29udGVzdC5zdGFydFRpbWU7XG4gICAgICAgIGNvbnN0IGlzQ3JlYXRvciA9IGN1cnJlbnRVc2VyPy5pZCA9PT0gY29udGVzdC5jcmVhdG9ySWQ7XG4gICAgICAgIGNvbnN0IGlzQWRtaW4gPSBjdXJyZW50VXNlcj8ucm9sZSA9PT0gXCJBRE1JTlwiO1xuXG4gICAgICAgIC8vIFZpc2liaWxpdHkgQ2hlY2tcbiAgICAgICAgbGV0IGlzQXV0aG9yaXplZCA9IGZhbHNlO1xuICAgICAgICBpZiAoY29udGVzdC52aXNpYmlsaXR5ID09PSBcIlBVQkxJQ1wiKSB7XG4gICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKGlzQWRtaW4pIHtcbiAgICAgICAgICAgIGlzQXV0aG9yaXplZCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudFVzZXIpIHtcbiAgICAgICAgICAgIGlmIChpc0NyZWF0b3IpIHtcbiAgICAgICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb250ZXN0LnZpc2liaWxpdHkgPT09IFwiSU5TVElUVVRJT05cIikge1xuICAgICAgICAgICAgICAgIC8vIFVzZSA9PSBmb3IgbnVsbC91bmRlZmluZWQgbG9vc2UgZXF1YWxpdHkgY2hlY2tcbiAgICAgICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSBjdXJyZW50VXNlci5pbnN0aXR1dGlvbklkID09IGNvbnRlc3QuaW5zdGl0dXRpb25JZDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGVzdC52aXNpYmlsaXR5ID09PSBcIkNMQVNTUk9PTVwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZW5yb2xsbWVudCA9IGF3YWl0IHByaXNtYS5jbGFzc3Jvb20uZmluZEZpcnN0KHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBjb250ZXN0LmNsYXNzcm9vbUlkIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0dWRlbnRzOiB7IHNvbWU6IHsgaWQ6IGN1cnJlbnRVc2VyLmlkIH0gfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBpc0F1dGhvcml6ZWQgPSAhIWVucm9sbG1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzQXV0aG9yaXplZCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZCBhY2Nlc3MgdG8gdGhpcyBjb250ZXN0LlwiIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjYW5TZWVQcm9ibGVtcyA9IChoYXNTdGFydGVkIHx8IGlzQWRtaW4gfHwgaXNDcmVhdG9yKSAmJiAocGFydGljaXBhdGlvbj8uYWNjZXB0ZWRSdWxlcyB8fCBpc0NyZWF0b3IgfHwgaXNBZG1pbik7XG5cbiAgICAgICAgLy8gRml4OiBJZiB0aGUgY29udGVzdCBpcyBvdmVyLCBhbGxvd2VkIHJvbGVzIHNob3VsZCBjaGVjayBwYXJ0aWNpcGF0aW9uIHByb3Blcmx5LFxuICAgICAgICAvLyBidXQgdHlwaWNhbGx5IGFsbG93cyB2aWV3aW5nIGlmIHB1YmxpYy9hdXRob3JpemVkLlxuICAgICAgICAvLyBCdXQgZm9yIFwiTGl2ZVwiIGNvbnRlc3RzLCB0aGUgY3VycmVudCBsb2dpYyBpcyBjb3JyZWN0LlxuXG4gICAgICAgIGNvbnN0IHJlcXVpcmVzUGFzc3dvcmQgPSAhIWNvbnRlc3QuY29udGVzdFBhc3N3b3JkO1xuXG4gICAgICAgIC8vIFNodWZmbGUgcHJvYmxlbXMgaWYgcmFuZG9taXplUXVlc3Rpb25zIGlzIGVuYWJsZWRcbiAgICAgICAgLy8gVXNlIGEgc2ltcGxlIHNlZWRlZCBzaHVmZmxlIGJhc2VkIG9uIHVzZXJJZCArIGNvbnRlc3RJZCBmb3IgY29uc2lzdGVuY3lcbiAgICAgICAgbGV0IHZpc2libGVQcm9ibGVtcyA9IGNhblNlZVByb2JsZW1zID8gY29udGVzdC5wcm9ibGVtcyA6IFtdO1xuXG4gICAgICAgIGlmIChjb250ZXN0LnJhbmRvbWl6ZVF1ZXN0aW9ucyAmJiBjdXJyZW50VXNlciAmJiB2aXNpYmxlUHJvYmxlbXMubGVuZ3RoID4gMCAmJiAhaXNBZG1pbiAmJiAhaXNDcmVhdG9yKSB7XG4gICAgICAgICAgICAvLyBTaW1wbGUgc3RyaW5nIGhhc2ggZnVuY3Rpb24gZm9yIHNlZWRpbmdcbiAgICAgICAgICAgIGNvbnN0IHNlZWRTdHIgPSBgJHtjdXJyZW50VXNlci5pZH0tJHtjb250ZXN0SWR9YDtcbiAgICAgICAgICAgIGxldCBzZWVkID0gMDtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VlZFN0ci5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHNlZWQgPSAoKHNlZWQgPDwgNSkgLSBzZWVkKSArIHNlZWRTdHIuY2hhckNvZGVBdChpKTtcbiAgICAgICAgICAgICAgICBzZWVkIHw9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERldGVybWluaXN0aWMgc2h1ZmZsZVxuICAgICAgICAgICAgdmlzaWJsZVByb2JsZW1zID0gWy4uLnZpc2libGVQcm9ibGVtc10uc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHggPSBNYXRoLnNpbihzZWVkKyspICogMTAwMDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuICh4IC0gTWF0aC5mbG9vcih4KSkgLSAwLjU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZldGNoIHVzZXIncyBzb2x2ZWQgcHJvYmxlbXMgZm9yIHRoaXMgY29udGVzdFxuICAgICAgICBjb25zdCBzb2x2ZWRQcm9ibGVtSWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICAgIGlmIChjdXJyZW50VXNlcikge1xuICAgICAgICAgICAgY29uc3Qgc29sdmVkU3VibWlzc2lvbnMgPSBhd2FpdCBwcmlzbWEuc3VibWlzc2lvbi5maW5kTWFueSh7XG4gICAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50VXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogXCJBQ0NFUFRFRFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9ibGVtSWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluOiB2aXNpYmxlUHJvYmxlbXMubWFwKHAgPT4gcC5wcm9ibGVtLmlkKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgcHJvYmxlbUlkOiB0cnVlIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc29sdmVkU3VibWlzc2lvbnMuZm9yRWFjaChzID0+IHNvbHZlZFByb2JsZW1JZHMuYWRkKHMucHJvYmxlbUlkKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRlc3Q6IHtcbiAgICAgICAgICAgICAgICAuLi5jb250ZXN0LFxuICAgICAgICAgICAgICAgIHByb2JsZW1zOiB2aXNpYmxlUHJvYmxlbXMubWFwKHZwID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIC4uLnZwLFxuICAgICAgICAgICAgICAgICAgICBpc1NvbHZlZDogc29sdmVkUHJvYmxlbUlkcy5oYXModnAucHJvYmxlbS5pZClcbiAgICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICAgICAgaGFzU3RhcnRlZCxcbiAgICAgICAgICAgICAgICBoYXNFbmRlZDogbm93ID4gY29udGVzdC5lbmRUaW1lLFxuICAgICAgICAgICAgICAgIGNhbk1hbmFnZTogaXNBZG1pbiB8fCBpc0NyZWF0b3IsXG4gICAgICAgICAgICAgICAgaGFzQWNjZXB0ZWRSdWxlczogcGFydGljaXBhdGlvbj8uYWNjZXB0ZWRSdWxlcyB8fCBmYWxzZSxcbiAgICAgICAgICAgICAgICBpc0ZpbmlzaGVkOiBwYXJ0aWNpcGF0aW9uPy5pc0ZpbmlzaGVkIHx8IGZhbHNlLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVzUGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgY29udGVzdFBhc3N3b3JkOiBudWxsLCAvLyBOZXZlciByZXR1cm4gcGxhaW4gcGFzc3dvcmRcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQ6IHBhcnRpY2lwYXRpb24/LnNlc3Npb25JZCAvLyBSZXR1cm4gc2Vzc2lvbklkIGZvciBwcm90ZWN0aW9uXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBjb250ZXN0IGRldGFpbDpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGZldGNoIGNvbnRlc3RcIiB9O1xuICAgIH1cbn1cblxuLy8gLi4uIGV4aXN0aW5nIGNvZGUgLi4uXG5cbi8vIC4uLiBleGlzdGluZyBjb2RlIC4uLlxuXG4vLyAuLi4gZXhpc3RpbmcgY29kZSAuLi5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvbnRlc3QoZGF0YTogei5pbmZlcjx0eXBlb2YgY29udGVzdFNjaGVtYT4pIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHNlc3Npb24udXNlciBhcyBhbnk7XG5cbiAgICBpZiAoIVtcIkFETUlOXCIsIFwiSU5TVElUVVRJT05fTUFOQUdFUlwiLCBcIkNPTlRFU1RfTUFOQUdFUlwiLCBcIlRFQUNIRVJcIl0uaW5jbHVkZXMoY3VycmVudFVzZXIucm9sZSkpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGVkRGF0YSA9IGNvbnRlc3RTY2hlbWEucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgYSBtb3JlIHJvYnVzdCB1bmlxdWUgc2x1Z1xuICAgICAgICBjb25zdCBiYXNlU2x1ZyA9IHZhbGlkYXRlZERhdGEudGl0bGUudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0rL2csIFwiLVwiKS5yZXBsYWNlKC8oXi18LSQpL2csIFwiXCIpO1xuICAgICAgICBjb25zdCB1bmlxdWVTbHVnID0gYCR7YmFzZVNsdWd9LSR7RGF0ZS5ub3coKX1gO1xuXG4gICAgICAgIGNvbnN0IGNvbnRlc3QgPSBhd2FpdCBwcmlzbWEuY29udGVzdC5jcmVhdGUoe1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHRpdGxlOiB2YWxpZGF0ZWREYXRhLnRpdGxlLFxuICAgICAgICAgICAgICAgIHNsdWc6IHVuaXF1ZVNsdWcsXG4gICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHZhbGlkYXRlZERhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgc3RhcnRUaW1lOiB2YWxpZGF0ZWREYXRhLnN0YXJ0VGltZSxcbiAgICAgICAgICAgICAgICBlbmRUaW1lOiB2YWxpZGF0ZWREYXRhLmVuZFRpbWUsXG4gICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5IGFzIGFueSxcbiAgICAgICAgICAgICAgICBpbnN0aXR1dGlvbklkOiB2YWxpZGF0ZWREYXRhLnZpc2liaWxpdHkgIT09IFwiUFVCTElDXCIgPyAodmFsaWRhdGVkRGF0YS5pbnN0aXR1dGlvbklkIHx8IG51bGwpIDogbnVsbCxcbiAgICAgICAgICAgICAgICBjbGFzc3Jvb21JZDogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5ID09PSBcIkNMQVNTUk9PTVwiID8gKHZhbGlkYXRlZERhdGEuY2xhc3Nyb29tSWQgfHwgbnVsbCkgOiBudWxsLFxuICAgICAgICAgICAgICAgIGNyZWF0b3JJZDogY3VycmVudFVzZXIuaWQsXG4gICAgICAgICAgICAgICAgY29udGVzdFBhc3N3b3JkOiB2YWxpZGF0ZWREYXRhLmNvbnRlc3RQYXNzd29yZCB8fCBudWxsLFxuICAgICAgICAgICAgICAgIHJhbmRvbWl6ZVF1ZXN0aW9uczogdmFsaWRhdGVkRGF0YS5yYW5kb21pemVRdWVzdGlvbnMgfHwgZmFsc2UsXG4gICAgICAgICAgICAgICAgcHJvYmxlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlOiB2YWxpZGF0ZWREYXRhLnByb2JsZW1zLm1hcCgocHJvYmxlbUlkLCBpbmRleCkgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2JsZW1JZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiBpbmRleCxcbiAgICAgICAgICAgICAgICAgICAgfSkpLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICByZXZhbGlkYXRlUGF0aChcIi9kYXNoYm9hcmQvY29udGVzdHNcIik7XG4gICAgICAgIHJldmFsaWRhdGVQYXRoKFwiL2NvbnRlc3RcIik7XG4gICAgICAgIHJldmFsaWRhdGVUYWcoXCJjb250ZXN0c1wiLCBcIm1heFwiKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgY29udGVzdElkOiBjb250ZXN0LmlkIH07XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBjb250ZXN0OlwiLCBlcnJvcik7XG4gICAgICAgIC8vIFJldHVybiBjbGVhcmVyIGVycm9yIG1lc3NhZ2VzXG4gICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBcIkZhaWxlZCB0byBjcmVhdGUgY29udGVzdFwiO1xuICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiB6LlpvZEVycm9yKSB7XG4gICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gKGVycm9yIGFzIGFueSkuZXJyb3JzLm1hcCgoZTogYW55KSA9PiBlLm1lc3NhZ2UpLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgfSBlbHNlIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZXJyb3IubWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yTWVzc2FnZSB9O1xuICAgIH1cbiAgICB9XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNvbnRlc3RXaXRoUHJvYmxlbXMoZGF0YTogei5pbmZlcjx0eXBlb2YgY29udGVzdFdpdGhQcm9ibGVtc1NjaGVtYT4pIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHNlc3Npb24udXNlciBhcyBhbnk7XG5cbiAgICBpZiAoIVtcIkFETUlOXCIsIFwiSU5TVElUVVRJT05fTUFOQUdFUlwiLCBcIkNPTlRFU1RfTUFOQUdFUlwiLCBcIlRFQUNIRVJcIl0uaW5jbHVkZXMoY3VycmVudFVzZXIucm9sZSkpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGVkRGF0YSA9IGNvbnRlc3RXaXRoUHJvYmxlbXNTY2hlbWEucGFyc2UoZGF0YSk7XG5cbiAgICAgICAgY29uc3QgY29udGVzdCA9IGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgdHguY29udGVzdC5jcmVhdGUoe1xuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHZhbGlkYXRlZERhdGEudGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIHNsdWc6IHZhbGlkYXRlZERhdGEuc2x1ZyxcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IHZhbGlkYXRlZERhdGEuZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0VGltZTogdmFsaWRhdGVkRGF0YS5zdGFydFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIGVuZFRpbWU6IHZhbGlkYXRlZERhdGEuZW5kVGltZSxcbiAgICAgICAgICAgICAgICAgICAgdmlzaWJpbGl0eTogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5IGFzIGFueSxcbiAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiB2YWxpZGF0ZWREYXRhLmhpZGRlbixcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlOiB2YWxpZGF0ZWREYXRhLmJhY2tncm91bmRJbWFnZSxcbiAgICAgICAgICAgICAgICAgICAgcHJpemVzOiB2YWxpZGF0ZWREYXRhLnByaXplcyxcbiAgICAgICAgICAgICAgICAgICAgcnVsZXM6IHZhbGlkYXRlZERhdGEucnVsZXMsXG4gICAgICAgICAgICAgICAgICAgIGluc3RpdHV0aW9uSWQ6IHZhbGlkYXRlZERhdGEudmlzaWJpbGl0eSAhPT0gXCJQVUJMSUNcIiA/ICh2YWxpZGF0ZWREYXRhLmluc3RpdHV0aW9uSWQgfHwgbnVsbCkgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBjbGFzc3Jvb21JZDogdmFsaWRhdGVkRGF0YS52aXNpYmlsaXR5ID09PSBcIkNMQVNTUk9PTVwiID8gKHZhbGlkYXRlZERhdGEuY2xhc3Nyb29tSWQgfHwgbnVsbCkgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBjcmVhdG9ySWQ6IGN1cnJlbnRVc2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0UGFzc3dvcmQ6IHZhbGlkYXRlZERhdGEuY29udGVzdFBhc3N3b3JkIHx8IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIHJhbmRvbWl6ZVF1ZXN0aW9uczogdmFsaWRhdGVkRGF0YS5yYW5kb21pemVRdWVzdGlvbnMgfHwgZmFsc2UsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdmFsaWRhdGVkRGF0YS5wcm9ibGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHAgPSB2YWxpZGF0ZWREYXRhLnByb2JsZW1zW2ldO1xuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBzbHVnIGJ5IGFwcGVuZGluZyBjb250ZXN0IHNsdWcgYW5kIGluZGV4XG4gICAgICAgICAgICAgICAgY29uc3QgdW5pcXVlU2x1ZyA9IGAke3ZhbGlkYXRlZERhdGEuc2x1Z30tJHtwLnNsdWcgfHwgcC50aXRsZS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJy0nKX0tJHtEYXRlLm5vdygpfS0ke2l9YDtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9ibGVtID0gYXdhaXQgdHgucHJvYmxlbS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogcC50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBwLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogcC5kaWZmaWN1bHR5LFxuICAgICAgICAgICAgICAgICAgICAgICAgc2x1ZzogdW5pcXVlU2x1ZyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlOiBwLnNjb3JlIHx8IDEwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBwLmRvbWFpbixcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiQ09OVEVTVFwiLCAvLyBDb250ZXN0IHByb2JsZW1zIGFyZSBtYXJrZWQgc2VwYXJhdGVseVxuICAgICAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiB0cnVlLCAvLyBDb250ZXN0IHByb2JsZW1zIGFyZSBoaWRkZW4gZnJvbSBtYWluIGJhbmtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlc3RDYXNlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZTogcC50ZXN0Q2FzZXMsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdGFnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbm5lY3Q6IHAudGFncz8ubWFwKCh0OiBzdHJpbmcpID0+ICh7IG5hbWU6IHQgfSkpIHx8IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBhd2FpdCB0eC5jb250ZXN0UHJvYmxlbS5jcmVhdGUoe1xuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3QuaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9ibGVtSWQ6IHByb2JsZW0uaWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlcjogaSxcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gY29udGVzdDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoXCIvZGFzaGJvYXJkL2NvbnRlc3RzXCIpO1xuICAgICAgICByZXZhbGlkYXRlUGF0aChcIi9jb250ZXN0c1wiKTtcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoXCIvY29udGVzdFwiKTtcbiAgICAgICAgcmV2YWxpZGF0ZVRhZyhcImNvbnRlc3RzXCIsIFwibWF4XCIpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjb250ZXN0SWQ6IGNvbnRlc3QuaWQgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBjb250ZXN0IHdpdGggcHJvYmxlbXM6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBjcmVhdGUgY29udGVzdFwiIH07XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SW5zdGl0dXRpb25hbENsYXNzcm9vbXMoaW5zdGl0dXRpb25JZDogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY2xhc3Nyb29tcyA9IGF3YWl0IHByaXNtYS5jbGFzc3Jvb20uZmluZE1hbnkoe1xuICAgICAgICAgICAgd2hlcmU6IHsgaW5zdGl0dXRpb25JZCB9LFxuICAgICAgICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlLCBuYW1lOiB0cnVlLCBzZWN0aW9uOiB0cnVlIH0sXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjbGFzc3Jvb21zIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCBjbGFzc3Jvb21zOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggY2xhc3Nyb29tc1wiIH07XG4gICAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U2VsZWN0YWJsZVByb2JsZW1zKHNlYXJjaDogc3RyaW5nKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvYmxlbXMgPSBhd2FpdCBwcmlzbWEucHJvYmxlbS5maW5kTWFueSh7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICAgICAgICAgIHsgdGl0bGU6IHsgY29udGFpbnM6IHNlYXJjaCwgbW9kZTogXCJpbnNlbnNpdGl2ZVwiIH0gfSxcbiAgICAgICAgICAgICAgICAgICAgeyBzbHVnOiB7IGNvbnRhaW5zOiBzZWFyY2gsIG1vZGU6IFwiaW5zZW5zaXRpdmVcIiB9IH0sXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBoaWRkZW46IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgdGl0bGU6IHRydWUsIGRpZmZpY3VsdHk6IHRydWUsIHNsdWc6IHRydWUgfSxcbiAgICAgICAgICAgIHRha2U6IDEwLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcHJvYmxlbXMgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHByb2JsZW1zOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggcHJvYmxlbXNcIiB9O1xuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFjY2VwdENvbnRlc3RSdWxlcyhjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cHNlcnQoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1cGRhdGU6IHsgYWNjZXB0ZWRSdWxlczogdHJ1ZSB9LFxuICAgICAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgYWNjZXB0ZWRSdWxlczogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoYC9jb250ZXN0LyR7Y29udGVzdElkfWApO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBhY2NlcHQgcnVsZXNcIiB9O1xuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmlzaENvbnRlc3RBY3Rpb24oY29udGVzdElkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICB0cnkge1xuICAgICAgICBhd2FpdCBwcmlzbWEuY29udGVzdFBhcnRpY2lwYXRpb24udXBzZXJ0KHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgICAgICAgaXNGaW5pc2hlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBmaW5pc2hlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgYWNjZXB0ZWRSdWxlczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpc0ZpbmlzaGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGZpbmlzaGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldmFsaWRhdGVQYXRoKGAvY29udGVzdC8ke2NvbnRlc3RJZH1gKTtcbiAgICAgICAgcmV2YWxpZGF0ZVBhdGgoYC9wcm9ibGVtc2ApO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBmaW5pc2ggY29udGVzdFwiIH07XG4gICAgfVxufVxuXG4vKipcbiAqIEZpbmFsaXplIENvbnRlc3QgJiBBd2FyZCBCYWRnZXNcbiAqIC0gQ2FsY3VsYXRlcyBsZWFkZXJib2FyZFxuICogLSBBd2FyZHMgR29sZCwgU2lsdmVyLCBCcm9uemUgdG8gVG9wIDNcbiAqIC0gTWFya3MgY29udGVzdCBhcyBmaW5hbGl6ZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmFsaXplQ29udGVzdChjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIC8vIE9ubHkgYWRtaW5zIG9yIGNvbnRlc3QgbWFuYWdlcnMgY2FuIGZpbmFsaXplXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBzZXNzaW9uLnVzZXIgYXMgYW55O1xuICAgIGlmICghW1wiQURNSU5cIiwgXCJDT05URVNUX01BTkFHRVJcIiwgXCJJTlNUSVRVVElPTl9NQU5BR0VSXCIsIFwiVEVBQ0hFUlwiXS5pbmNsdWRlcyhjdXJyZW50VXNlci5yb2xlKSkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICAgICAgIHNlbGVjdDogeyBpc0ZpbmFsaXplZDogdHJ1ZSwgdGl0bGU6IHRydWUgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWNvbnRlc3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJDb250ZXN0IG5vdCBmb3VuZFwiIH07XG4gICAgICAgIGlmIChjb250ZXN0LmlzRmluYWxpemVkKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBpcyBhbHJlYWR5IGZpbmFsaXplZFwiIH07XG5cbiAgICAgICAgLy8gUmV1c2UgbGVhZGVyYm9hcmQgbG9naWMgdG8gZ2V0IHJhbmtpbmdzXG4gICAgICAgIGNvbnN0IGxlYWRlcmJvYXJkID0gYXdhaXQgZ2V0Q29udGVzdExlYWRlcmJvYXJkKGNvbnRlc3RJZCk7XG4gICAgICAgIGlmICghbGVhZGVyYm9hcmQuc3VjY2VzcyB8fCAhbGVhZGVyYm9hcmQuc3R1ZGVudHMpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZmV0Y2ggbGVhZGVyYm9hcmRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgc3R1ZGVudHMgPSBsZWFkZXJib2FyZC5zdHVkZW50cyBhcyBhbnlbXTtcblxuICAgICAgICAvLyBBdCBsZWFzdCAxIHN0dWRlbnQgbmVlZGVkXG4gICAgICAgIGlmIChzdHVkZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICBhd2FpdCBwcmlzbWEuY29udGVzdC51cGRhdGUoe1xuICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogY29udGVzdElkIH0sXG4gICAgICAgICAgICAgICAgIGRhdGE6IHsgaXNGaW5hbGl6ZWQ6IHRydWUgfVxuICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6IFwiQ29udGVzdCBmaW5hbGl6ZWQgKG5vIHBhcnRpY2lwYW50cylcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVG9wIDMgSURzXG4gICAgICAgIGNvbnN0IGdvbGRVc2VySWQgPSBzdHVkZW50c1swXT8uaWQ7XG4gICAgICAgIGNvbnN0IHNpbHZlclVzZXJJZCA9IHN0dWRlbnRzWzFdPy5pZDtcbiAgICAgICAgY29uc3QgYnJvbnplVXNlcklkID0gc3R1ZGVudHNbMl0/LmlkO1xuXG4gICAgICAgIGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XG4gICAgICAgICAgICAvLyBBd2FyZCBHb2xkXG4gICAgICAgICAgICBpZiAoZ29sZFVzZXJJZCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHR4LnVzZXIudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGdvbGRVc2VySWQgfSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBnb2xkQmFkZ2VzOiB7IGluY3JlbWVudDogMSB9IH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEF3YXJkIFNpbHZlclxuICAgICAgICAgICAgaWYgKHNpbHZlclVzZXJJZCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHR4LnVzZXIudXBkYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHNpbHZlclVzZXJJZCB9LFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7IHNpbHZlckJhZGdlczogeyBpbmNyZW1lbnQ6IDEgfSB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBBd2FyZCBCcm9uemVcbiAgICAgICAgICAgIGlmIChicm9uemVVc2VySWQpIHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0eC51c2VyLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBicm9uemVVc2VySWQgfSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBicm9uemVCYWRnZXM6IHsgaW5jcmVtZW50OiAxIH0gfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBNYXJrIEZpbmFsaXplZFxuICAgICAgICAgICAgYXdhaXQgdHguY29udGVzdC51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjb250ZXN0SWQgfSxcbiAgICAgICAgICAgICAgICBkYXRhOiB7IGlzRmluYWxpemVkOiB0cnVlIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXZhbGlkYXRlUGF0aChgL2Rhc2hib2FyZGApO1xuICAgICAgICByZXZhbGlkYXRlUGF0aChgL3Byb2ZpbGUvJHtnb2xkVXNlcklkfWApO1xuICAgICAgICBpZihzaWx2ZXJVc2VySWQpIHJldmFsaWRhdGVQYXRoKGAvcHJvZmlsZS8ke3NpbHZlclVzZXJJZH1gKTtcbiAgICAgICAgaWYoYnJvbnplVXNlcklkKSByZXZhbGlkYXRlUGF0aChgL3Byb2ZpbGUvJHticm9uemVVc2VySWR9YCk7XG4gICAgICAgIHJldmFsaWRhdGVQYXRoKGAvY29udGVzdC8ke2NvbnRlc3RJZH1gKTtcbiAgICAgICAgcmV2YWxpZGF0ZVRhZyhgY29udGVzdC0ke2NvbnRlc3RJZH1gLCBcIm1heFwiKTtcbiAgICAgICAgcmV2YWxpZGF0ZVRhZyhgbGVhZGVyYm9hcmQtJHtjb250ZXN0SWR9YCwgXCJtYXhcIik7XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gZmluYWxpemUgY29udGVzdDpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGZpbmFsaXplIGNvbnRlc3RcIiB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgY29udGVzdCBwYXNzd29yZCB3aXRob3V0IHN0YXJ0aW5nIHNlc3Npb24uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2ZXJpZnlDb250ZXN0UGFzc3dvcmQoY29udGVzdElkOiBzdHJpbmcsIHBhc3N3b3JkPzogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29udGVzdCA9IGF3YWl0IHByaXNtYS5jb250ZXN0LmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICAgICAgc2VsZWN0OiB7IGNvbnRlc3RQYXNzd29yZDogdHJ1ZSB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgICAgICBpZiAoY29udGVzdC5jb250ZXN0UGFzc3dvcmQgJiYgY29udGVzdC5jb250ZXN0UGFzc3dvcmQgIT09IHBhc3N3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSW52YWxpZCBjb250ZXN0IHBhc3N3b3JkXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHZlcmlmeSBjb250ZXN0IHBhc3N3b3JkOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gdmVyaWZ5IHBhc3N3b3JkXCIgfTtcbiAgICB9XG59XG5cblxuLyoqXG4gKiBTdGFydCBhIGNvbnRlc3Qgc2Vzc2lvbiAtIHZhbGlkYXRlcyB0aW1lIGJvdW5kcyBhbmQgY3JlYXRlcyBzZXNzaW9uIElEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzdGFydENvbnRlc3RTZXNzaW9uKGNvbnRlc3RJZDogc3RyaW5nLCBwYXNzd29yZD86IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNvbnRlc3QgPSBhd2FpdCBwcmlzbWEuY29udGVzdC5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBjb250ZXN0SWQgfSxcbiAgICAgICAgICAgIHNlbGVjdDogeyBzdGFydFRpbWU6IHRydWUsIGVuZFRpbWU6IHRydWUsIGNvbnRlc3RQYXNzd29yZDogdHJ1ZSB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgICAgICBpZiAoY29udGVzdC5jb250ZXN0UGFzc3dvcmQgJiYgY29udGVzdC5jb250ZXN0UGFzc3dvcmQgIT09IHBhc3N3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSW52YWxpZCBjb250ZXN0IHBhc3N3b3JkXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG5cbiAgICAgICAgLy8gVGltZSBib3VuZHMgY2hlY2tcbiAgICAgICAgaWYgKG5vdyA8IGNvbnRlc3Quc3RhcnRUaW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBoYXMgbm90IHN0YXJ0ZWQgeWV0XCIgfTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm93ID4gY29udGVzdC5lbmRUaW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBoYXMgYWxyZWFkeSBlbmRlZFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZW5lcmF0ZSB1bmlxdWUgc2Vzc2lvbiBJRFxuICAgICAgICBjb25zdCBzZXNzaW9uSWQgPSBgJHtzZXNzaW9uLnVzZXIuaWR9LSR7Y29udGVzdElkfS0ke0RhdGUubm93KCl9YDtcblxuICAgICAgICAvLyBDaGVjayBmb3IgZXhpc3RpbmcgYWN0aXZlIHNlc3Npb24gKG11bHRpLXRhYiBkZXRlY3Rpb24pXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nUGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChleGlzdGluZ1BhcnRpY2lwYXRpb24/LmlzQmxvY2tlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIllvdSBoYXZlIGJlZW4gYmxvY2tlZCBmcm9tIHRoaXMgY29udGVzdCBkdWUgdG8gdmlvbGF0aW9uc1wiIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZXhpc3RpbmdQYXJ0aWNpcGF0aW9uPy5pc0ZpbmlzaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiWW91IGhhdmUgYWxyZWFkeSBmaW5pc2hlZCB0aGlzIGNvbnRlc3RcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVXBkYXRlIG9yIGNyZWF0ZSBwYXJ0aWNpcGF0aW9uIHdpdGggbmV3IHNlc3Npb25cbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cHNlcnQoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQsXG4gICAgICAgICAgICAgICAgc2Vzc2lvblN0YXJ0ZWRBdDogbm93LFxuICAgICAgICAgICAgICAgIGFjY2VwdGVkUnVsZXM6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZCxcbiAgICAgICAgICAgICAgICBzZXNzaW9uSWQsXG4gICAgICAgICAgICAgICAgc2Vzc2lvblN0YXJ0ZWRBdDogbm93LFxuICAgICAgICAgICAgICAgIGFjY2VwdGVkUnVsZXM6IHRydWVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBzZXNzaW9uSWQsXG4gICAgICAgICAgICBwYXJ0aWNpcGF0aW9uSWQ6IHBhcnRpY2lwYXRpb24uaWQsXG4gICAgICAgICAgICB0b3RhbFZpb2xhdGlvbnM6IHBhcnRpY2lwYXRpb24udG90YWxWaW9sYXRpb25zLFxuICAgICAgICAgICAgaXNGbGFnZ2VkOiBwYXJ0aWNpcGF0aW9uLmlzRmxhZ2dlZFxuICAgICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gc3RhcnQgY29udGVzdCBzZXNzaW9uOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gc3RhcnQgY29udGVzdCBzZXNzaW9uXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogTG9nIGEgY29udGVzdCB2aW9sYXRpb24gLSByZWNvcmRzIHRvIGRhdGFiYXNlIGFuZCB1cGRhdGVzIGNvdW50ZXJzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dDb250ZXN0VmlvbGF0aW9uKFxuICAgIGNvbnRlc3RJZDogc3RyaW5nLFxuICAgIHR5cGU6IFwiVEFCX1NXSVRDSFwiIHwgXCJGVUxMU0NSRUVOX0VYSVRcIiB8IFwiQ09QWV9QQVNURVwiIHwgXCJERVZUT09MU19PUEVOXCIgfCBcIktFWUJPQVJEX1NIT1JUQ1VUXCIgfCBcIk5BVklHQVRJT05fQVRURU1QVFwiIHwgXCJNVUxUSV9UQUJcIiB8IFwiU1VTUElDSU9VU19JTlBVVFwiLFxuICAgIG1lc3NhZ2U/OiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJ0aWNpcGF0aW9uID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFwYXJ0aWNpcGF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiTm8gYWN0aXZlIHBhcnRpY2lwYXRpb24gZm91bmRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHdoaWNoIGNvdW50ZXIgdG8gaW5jcmVtZW50XG4gICAgICAgIGNvbnN0IGNvdW50ZXJGaWVsZCA9IHtcbiAgICAgICAgICAgIFRBQl9TV0lUQ0g6IFwidGFiU3dpdGNoQ291bnRcIixcbiAgICAgICAgICAgIEZVTExTQ1JFRU5fRVhJVDogXCJmdWxsc2NyZWVuRXhpdENvdW50XCIsXG4gICAgICAgICAgICBDT1BZX1BBU1RFOiBcImNvcHlQYXN0ZUNvdW50XCIsXG4gICAgICAgICAgICBERVZUT09MU19PUEVOOiBcImRldlRvb2xzQ291bnRcIixcbiAgICAgICAgICAgIEtFWUJPQVJEX1NIT1JUQ1VUOiBcImtleWJvYXJkQ291bnRcIixcbiAgICAgICAgICAgIE5BVklHQVRJT05fQVRURU1QVDogXCJuYXZpZ2F0aW9uQ291bnRcIixcbiAgICAgICAgICAgIE1VTFRJX1RBQjogXCJ0YWJTd2l0Y2hDb3VudFwiLFxuICAgICAgICAgICAgU1VTUElDSU9VU19JTlBVVDogXCJjb3B5UGFzdGVDb3VudFwiXG4gICAgICAgIH1bdHlwZV0gYXMgc3RyaW5nO1xuXG4gICAgICAgIC8vIFVzZSB0cmFuc2FjdGlvbiB0byBlbnN1cmUgYXRvbWljIHVwZGF0ZVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xuICAgICAgICAgICAgLy8gQ2hlY2sgbGFzdCB2aW9sYXRpb24gdGltZSB0byBwcmV2ZW50IHJhcGlkLWZpcmUgZHVwbGljYXRlcyAoU2VydmVyLXNpZGUgZGVib3VuY2UpXG4gICAgICAgICAgICBjb25zdCBsYXN0VmlvbGF0aW9uID0gYXdhaXQgdHguY29udGVzdFZpb2xhdGlvbi5maW5kRmlyc3Qoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7IHBhcnRpY2lwYXRpb25JZDogcGFydGljaXBhdGlvbi5pZCB9LFxuICAgICAgICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmIChsYXN0VmlvbGF0aW9uKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdGltZURpZmYgPSBEYXRlLm5vdygpIC0gbGFzdFZpb2xhdGlvbi5jcmVhdGVkQXQuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgIC8vIElmIGxlc3MgdGhhbiAyIHNlY29uZHMgc2luY2UgbGFzdCB2aW9sYXRpb24sIGlnbm9yZSB0aGlzIG9uZVxuICAgICAgICAgICAgICAgIGlmICh0aW1lRGlmZiA8IDIwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLnBhcnRpY2lwYXRpb24sIC8vIFJldHVybiBleGlzdGluZyBzdGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgaXNGbGFnZ2VkOiBwYXJ0aWNpcGF0aW9uLmlzRmxhZ2dlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzQmxvY2tlZDogcGFydGljaXBhdGlvbi5pc0Jsb2NrZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbFZpb2xhdGlvbnM6IHBhcnRpY2lwYXRpb24udG90YWxWaW9sYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkOiBwYXJ0aWNpcGF0aW9uLnBlcm1hbmVudGx5QmxvY2tlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IHBhcnRpY2lwYXRpb24udGVtcEJsb2NrZWRVbnRpbFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHZpb2xhdGlvbiByZWNvcmRcbiAgICAgICAgICAgIGF3YWl0IHR4LmNvbnRlc3RWaW9sYXRpb24uY3JlYXRlKHtcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnRpY2lwYXRpb25JZDogcGFydGljaXBhdGlvbi5pZCxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSBhcyBhbnksXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBtZXRhZGF0YSA/PyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIG5ldyB0b3RhbCBhbmQgZGV0ZXJtaW5lIGJsb2NraW5nIHRpZXJcbiAgICAgICAgICAgIGNvbnN0IG5ld1RvdGFsVmlvbGF0aW9ucyA9IHBhcnRpY2lwYXRpb24udG90YWxWaW9sYXRpb25zICsgMTtcbiAgICAgICAgICAgIGNvbnN0IHNob3VsZEZsYWcgPSBuZXdUb3RhbFZpb2xhdGlvbnMgPj0gMztcblxuICAgICAgICAgICAgLy8gVGllcmVkIGJsb2NraW5nIGxvZ2ljXG4gICAgICAgICAgICBsZXQgdGVtcEJsb2NrZWRVbnRpbDogRGF0ZSB8IG51bGwgPSBudWxsO1xuICAgICAgICAgICAgbGV0IHBlcm1hbmVudGx5QmxvY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IGlzQmxvY2tlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAobmV3VG90YWxWaW9sYXRpb25zID49IDYpIHtcbiAgICAgICAgICAgICAgICAvLyA2KyB2aW9sYXRpb25zID0gcGVybWFuZW50IGJsb2NrXG4gICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpc0Jsb2NrZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuZXdUb3RhbFZpb2xhdGlvbnMgPj0gNCkge1xuICAgICAgICAgICAgICAgIC8vIDQtNSB2aW9sYXRpb25zID0gNSBtaW51dGUgdGVtcCBibG9ja1xuICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWwgPSBuZXcgRGF0ZShEYXRlLm5vdygpICsgNSAqIDYwICogMTAwMCk7IC8vIDUgbWludXRlc1xuICAgICAgICAgICAgICAgIGlzQmxvY2tlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCB0eC5jb250ZXN0UGFydGljaXBhdGlvbi51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXJ0aWNpcGF0aW9uLmlkIH0sXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBbY291bnRlckZpZWxkXTogeyBpbmNyZW1lbnQ6IDEgfSxcbiAgICAgICAgICAgICAgICAgICAgdG90YWxWaW9sYXRpb25zOiB7IGluY3JlbWVudDogMSB9LFxuICAgICAgICAgICAgICAgICAgICBpc0ZsYWdnZWQ6IHNob3VsZEZsYWcgfHwgcGFydGljaXBhdGlvbi5pc0ZsYWdnZWQsXG4gICAgICAgICAgICAgICAgICAgIGlzQmxvY2tlZCxcbiAgICAgICAgICAgICAgICAgICAgdGVtcEJsb2NrZWRVbnRpbCxcbiAgICAgICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB1cGRhdGVkO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIHRvdGFsVmlvbGF0aW9uczogcmVzdWx0LnRvdGFsVmlvbGF0aW9ucyxcbiAgICAgICAgICAgIGlzRmxhZ2dlZDogcmVzdWx0LmlzRmxhZ2dlZCxcbiAgICAgICAgICAgIGlzQmxvY2tlZDogcmVzdWx0LmlzQmxvY2tlZCxcbiAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IHJlc3VsdC50ZW1wQmxvY2tlZFVudGlsPy50b0lTT1N0cmluZygpIHx8IG51bGwsXG4gICAgICAgICAgICBwZXJtYW5lbnRseUJsb2NrZWQ6IHJlc3VsdC5wZXJtYW5lbnRseUJsb2NrZWRcbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGxvZyB2aW9sYXRpb246XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBsb2cgdmlvbGF0aW9uXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogVmFsaWRhdGUgY29udGVzdCBzZXNzaW9uIC0gY2hlY2tzIGlmIHNlc3Npb24gaXMgdmFsaWQgZm9yIHN1Ym1pc3Npb25zXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUNvbnRlc3RTZXNzaW9uKGNvbnRlc3RJZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgdmFsaWQ6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIGNvbnRlc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7IHN0YXJ0VGltZTogdHJ1ZSwgZW5kVGltZTogdHJ1ZSB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIXBhcnRpY2lwYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbGlkOiBmYWxzZSwgcmVhc29uOiBcIk5vIHBhcnRpY2lwYXRpb24gZm91bmRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgYmxvY2tlZFxuICAgICAgICBpZiAocGFydGljaXBhdGlvbi5pc0Jsb2NrZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbGlkOiBmYWxzZSwgcmVhc29uOiBcIkJsb2NrZWQgZHVlIHRvIHZpb2xhdGlvbnNcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgZmluaXNoZWRcbiAgICAgICAgaWYgKHBhcnRpY2lwYXRpb24uaXNGaW5pc2hlZCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdmFsaWQ6IGZhbHNlLCByZWFzb246IFwiQ29udGVzdCBhbHJlYWR5IGZpbmlzaGVkXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIHNlc3Npb24gSUQgKG11bHRpLXRhYiBkZXRlY3Rpb24pXG4gICAgICAgIGlmIChwYXJ0aWNpcGF0aW9uLnNlc3Npb25JZCAhPT0gc2Vzc2lvbklkKSB7XG4gICAgICAgICAgICAvLyBMb2cgbXVsdGktdGFiIHZpb2xhdGlvblxuICAgICAgICAgICAgYXdhaXQgbG9nQ29udGVzdFZpb2xhdGlvbihjb250ZXN0SWQsIFwiTVVMVElfVEFCXCIsIFwiTXVsdGlwbGUgdGFicyBkZXRlY3RlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHZhbGlkOiBmYWxzZSwgcmVhc29uOiBcIlNlc3Npb24gbWlzbWF0Y2ggLSBwb3NzaWJsZSBtdWx0aXBsZSB0YWJzXCIgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIHRpbWUgYm91bmRzXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGlmIChub3cgPiBwYXJ0aWNpcGF0aW9uLmNvbnRlc3QuZW5kVGltZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgdmFsaWQ6IGZhbHNlLCByZWFzb246IFwiQ29udGVzdCBoYXMgZW5kZWRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgICAgICAgIHRvdGFsVmlvbGF0aW9uczogcGFydGljaXBhdGlvbi50b3RhbFZpb2xhdGlvbnMsXG4gICAgICAgICAgICBpc0ZsYWdnZWQ6IHBhcnRpY2lwYXRpb24uaXNGbGFnZ2VkXG4gICAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byB2YWxpZGF0ZSBzZXNzaW9uOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCB2YWxpZDogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byB2YWxpZGF0ZSBzZXNzaW9uXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdXNlciBpcyBlbGlnaWJsZSB0byBzdWJtaXQgLSBwcmUtc3VibWlzc2lvbiB2YWxpZGF0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1N1Ym1pc3Npb25FbGlnaWJpbGl0eShjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJ0aWNpcGF0aW9uID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgY29udGVzdDoge1xuICAgICAgICAgICAgICAgICAgICBzZWxlY3Q6IHsgc3RhcnRUaW1lOiB0cnVlLCBlbmRUaW1lOiB0cnVlIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghcGFydGljaXBhdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHsgZWxpZ2libGU6IGZhbHNlLCByZWFzb246IFwiTm8gcGFydGljaXBhdGlvbiBmb3VuZFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayB2YXJpb3VzIGNvbmRpdGlvbnNcbiAgICAgICAgaWYgKHBhcnRpY2lwYXRpb24uaXNCbG9ja2VkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIHJlYXNvbjogXCJCbG9ja2VkIGR1ZSB0byBleGNlc3NpdmUgdmlvbGF0aW9uc1wiIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGFydGljaXBhdGlvbi5pc0ZpbmlzaGVkKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIHJlYXNvbjogXCJZb3UgaGF2ZSBhbHJlYWR5IGZpbmlzaGVkIHRoaXMgY29udGVzdFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBpZiAobm93IDwgcGFydGljaXBhdGlvbi5jb250ZXN0LnN0YXJ0VGltZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgZWxpZ2libGU6IGZhbHNlLCByZWFzb246IFwiQ29udGVzdCBoYXMgbm90IHN0YXJ0ZWRcIiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG5vdyA+IHBhcnRpY2lwYXRpb24uY29udGVzdC5lbmRUaW1lKSB7XG4gICAgICAgICAgICByZXR1cm4geyBlbGlnaWJsZTogZmFsc2UsIHJlYXNvbjogXCJDb250ZXN0IGhhcyBlbmRlZFwiIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZWxpZ2libGU6IHRydWUsXG4gICAgICAgICAgICB3YXJuaW5nczogcGFydGljaXBhdGlvbi5pc0ZsYWdnZWQgPyBbXCJZb3VyIHNlc3Npb24gaGFzIGJlZW4gZmxhZ2dlZCBmb3IgcmV2aWV3XCJdIDogW11cbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGNoZWNrIGVsaWdpYmlsaXR5OlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiB7IGVsaWdpYmxlOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGNoZWNrIGVsaWdpYmlsaXR5XCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogR2V0IHBhcnRpY2lwYXRpb24gc3RhdHVzIC0gZm9yIFVJIHN0YXRlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQYXJ0aWNpcGF0aW9uU3RhdHVzKGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbiA9IGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi5maW5kVW5pcXVlKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcklkX2NvbnRlc3RJZDoge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgYWNjZXB0ZWRSdWxlczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpc0ZpbmlzaGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlzRmxhZ2dlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBpc0Jsb2NrZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgdG90YWxWaW9sYXRpb25zOiB0cnVlLFxuICAgICAgICAgICAgICAgIHNlc3Npb25JZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICB0ZW1wQmxvY2tlZFVudGlsOiB0cnVlLFxuICAgICAgICAgICAgICAgIHBlcm1hbmVudGx5QmxvY2tlZDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDaGVjayBpZiB0ZW1wIGJsb2NrIGhhcyBleHBpcmVkXG4gICAgICAgIGlmIChwYXJ0aWNpcGF0aW9uPy50ZW1wQmxvY2tlZFVudGlsICYmIG5ldyBEYXRlKCkgPiBwYXJ0aWNpcGF0aW9uLnRlbXBCbG9ja2VkVW50aWwpIHtcbiAgICAgICAgICAgIC8vIFRlbXAgYmxvY2sgZXhwaXJlZCAtIHVuYmxvY2tcbiAgICAgICAgICAgIGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cGRhdGUoe1xuICAgICAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZF9jb250ZXN0SWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVzdElkOiBjb250ZXN0SWRcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBpc0Jsb2NrZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wQmxvY2tlZFVudGlsOiBudWxsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICBwYXJ0aWNpcGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnBhcnRpY2lwYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGlzQmxvY2tlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IG51bGxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBwYXJ0aWNpcGF0aW9uOiBwYXJ0aWNpcGF0aW9uIHx8IG51bGxcbiAgICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGdldCBwYXJ0aWNpcGF0aW9uIHN0YXR1c1wiIH07XG4gICAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OVEVTVCBNQU5BR0VSIC0gUEFSVElDSVBBTlQgTUFOQUdFTUVOVFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBHZXQgYWxsIHBhcnRpY2lwYW50cyBmb3IgYSBjb250ZXN0IHdpdGggdmlvbGF0aW9uIGRldGFpbHMgKGZvciBtYW5hZ2VycylcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbnRlc3RQYXJ0aWNpcGFudHMoY29udGVzdElkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYXV0aC5hcGkuZ2V0U2Vzc2lvbih7XG4gICAgICAgIGhlYWRlcnM6IGF3YWl0IGhlYWRlcnMoKSxcbiAgICB9KTtcblxuICAgIGlmICghc2Vzc2lvbj8udXNlcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG5cbiAgICBjb25zdCBjdXJyZW50VXNlciA9IHNlc3Npb24udXNlciBhcyBhbnk7XG5cbiAgICAvLyBDaGVjayBpZiB1c2VyIGlzIGNvbnRlc3QgbWFuYWdlci9jcmVhdG9yXG4gICAgY29uc3QgY29udGVzdCA9IGF3YWl0IHByaXNtYS5jb250ZXN0LmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogY29udGVzdElkIH0sXG4gICAgICAgIHNlbGVjdDogeyBjcmVhdG9ySWQ6IHRydWUgfVxuICAgIH0pO1xuXG4gICAgaWYgKCFjb250ZXN0KSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiQ29udGVzdCBub3QgZm91bmRcIiB9O1xuXG4gICAgY29uc3QgaXNBdXRob3JpemVkID1cbiAgICAgICAgY3VycmVudFVzZXIucm9sZSA9PT0gXCJBRE1JTlwiIHx8XG4gICAgICAgIGN1cnJlbnRVc2VyLnJvbGUgPT09IFwiQ09OVEVTVF9NQU5BR0VSXCIgfHxcbiAgICAgICAgY3VycmVudFVzZXIucm9sZSA9PT0gXCJURUFDSEVSXCIgfHxcbiAgICAgICAgY29udGVzdC5jcmVhdG9ySWQgPT09IGN1cnJlbnRVc2VyLmlkO1xuXG4gICAgaWYgKCFpc0F1dGhvcml6ZWQpIHtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIlVuYXV0aG9yaXplZFwiIH07XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhbnRzID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRNYW55KHtcbiAgICAgICAgICAgIHdoZXJlOiB7IGNvbnRlc3RJZCB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHZpb2xhdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgb3JkZXJCeTogeyBjcmVhdGVkQXQ6IFwiZGVzY1wiIH0sXG4gICAgICAgICAgICAgICAgICAgIHRha2U6IDEwXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9yZGVyQnk6IFtcbiAgICAgICAgICAgICAgICB7IHBlcm1hbmVudGx5QmxvY2tlZDogXCJkZXNjXCIgfSxcbiAgICAgICAgICAgICAgICB7IGlzQmxvY2tlZDogXCJkZXNjXCIgfSxcbiAgICAgICAgICAgICAgICB7IHRvdGFsVmlvbGF0aW9uczogXCJkZXNjXCIgfVxuICAgICAgICAgICAgXVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBwYXJ0aWNpcGFudHMgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGdldCBwYXJ0aWNpcGFudHM6XCIsIGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBnZXQgcGFydGljaXBhbnRzXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogVW5ibG9jayBhIHBhcnRpY2lwYW50IChtYW5hZ2VyIG9ubHkpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1bmJsb2NrUGFydGljaXBhbnQoY29udGVzdElkOiBzdHJpbmcsIHVzZXJJZDogc3RyaW5nKSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGF1dGguYXBpLmdldFNlc3Npb24oe1xuICAgICAgICBoZWFkZXJzOiBhd2FpdCBoZWFkZXJzKCksXG4gICAgfSk7XG5cbiAgICBpZiAoIXNlc3Npb24/LnVzZXIpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuXG4gICAgY29uc3QgY3VycmVudFVzZXIgPSBzZXNzaW9uLnVzZXIgYXMgYW55O1xuXG4gICAgLy8gQ2hlY2sgYXV0aG9yaXphdGlvblxuICAgIGNvbnN0IGNvbnRlc3QgPSBhd2FpdCBwcmlzbWEuY29udGVzdC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGNvbnRlc3RJZCB9LFxuICAgICAgICBzZWxlY3Q6IHsgY3JlYXRvcklkOiB0cnVlIH1cbiAgICB9KTtcblxuICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgIGNvbnN0IGlzQXV0aG9yaXplZCA9XG4gICAgICAgIGN1cnJlbnRVc2VyLnJvbGUgPT09IFwiQURNSU5cIiB8fFxuICAgICAgICBjdXJyZW50VXNlci5yb2xlID09PSBcIkNPTlRFU1RfTUFOQUdFUlwiIHx8XG4gICAgICAgIGN1cnJlbnRVc2VyLnJvbGUgPT09IFwiVEVBQ0hFUlwiIHx8XG4gICAgICAgIGNvbnRlc3QuY3JlYXRvcklkID09PSBjdXJyZW50VXNlci5pZDtcblxuICAgIGlmICghaXNBdXRob3JpemVkKSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJVbmF1dGhvcml6ZWRcIiB9O1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHByaXNtYS5jb250ZXN0UGFydGljaXBhdGlvbi51cGRhdGUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICBpc0Jsb2NrZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHRlbXBCbG9ja2VkVW50aWw6IG51bGwsXG4gICAgICAgICAgICAgICAgcGVybWFuZW50bHlCbG9ja2VkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB0b3RhbFZpb2xhdGlvbnM6IDAsXG4gICAgICAgICAgICAgICAgdGFiU3dpdGNoQ291bnQ6IDAsXG4gICAgICAgICAgICAgICAgZnVsbHNjcmVlbkV4aXRDb3VudDogMCxcbiAgICAgICAgICAgICAgICBjb3B5UGFzdGVDb3VudDogMCxcbiAgICAgICAgICAgICAgICBkZXZUb29sc0NvdW50OiAwLFxuICAgICAgICAgICAgICAgIGtleWJvYXJkQ291bnQ6IDAsXG4gICAgICAgICAgICAgICAgbmF2aWdhdGlvbkNvdW50OiAwLFxuICAgICAgICAgICAgICAgIGlzRmxhZ2dlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgdW5ibG9ja2VkQnk6IGN1cnJlbnRVc2VyLmlkLFxuICAgICAgICAgICAgICAgIHVuYmxvY2tlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldmFsaWRhdGVQYXRoKGAvZGFzaGJvYXJkL2NvbnRlc3RzLyR7Y29udGVzdElkfS9wYXJ0aWNpcGFudHNgKTtcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gdW5ibG9jayBwYXJ0aWNpcGFudDpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIHVuYmxvY2sgcGFydGljaXBhbnRcIiB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBHZXQgZGV0YWlsZWQgdmlvbGF0aW9ucyBmb3IgYSBwYXJ0aWNpcGFudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UGFydGljaXBhbnRWaW9sYXRpb25zKGNvbnRlc3RJZDogc3RyaW5nLCB1c2VySWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIGNvbnN0IGN1cnJlbnRVc2VyID0gc2Vzc2lvbi51c2VyIGFzIGFueTtcblxuICAgIC8vIENoZWNrIGF1dGhvcml6YXRpb25cbiAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBjb250ZXN0SWQgfSxcbiAgICAgICAgc2VsZWN0OiB7IGNyZWF0b3JJZDogdHJ1ZSB9XG4gICAgfSk7XG5cbiAgICBpZiAoIWNvbnRlc3QpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJDb250ZXN0IG5vdCBmb3VuZFwiIH07XG5cbiAgICBjb25zdCBpc0F1dGhvcml6ZWQgPVxuICAgICAgICBjdXJyZW50VXNlci5yb2xlID09PSBcIkFETUlOXCIgfHxcbiAgICAgICAgY3VycmVudFVzZXIucm9sZSA9PT0gXCJDT05URVNUX01BTkFHRVJcIiB8fFxuICAgICAgICBjdXJyZW50VXNlci5yb2xlID09PSBcIlRFQUNIRVJcIiB8fFxuICAgICAgICBjb250ZXN0LmNyZWF0b3JJZCA9PT0gY3VycmVudFVzZXIuaWQ7XG5cbiAgICBpZiAoIWlzQXV0aG9yaXplZCkge1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgICBjb25zdCBwYXJ0aWNpcGF0aW9uID0gYXdhaXQgcHJpc21hLmNvbnRlc3RQYXJ0aWNpcGF0aW9uLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB1c2VySWRfY29udGVzdElkOiB7XG4gICAgICAgICAgICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVzdElkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdDogeyBpZDogdHJ1ZSwgbmFtZTogdHJ1ZSwgZW1haWw6IHRydWUgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdmlvbGF0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogXCJkZXNjXCIgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgcGFydGljaXBhdGlvbiB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZ2V0IHZpb2xhdGlvbnNcIiB9O1xuICAgIH1cbn1cblxuLyoqXG4gKiBDYWxjdWxhdGUgY29udGVzdCBsZWFkZXJib2FyZFxuICogLSBGZXRjaGVzIGFsbCBwYXJ0aWNpcGF0aW9uc1xuICogLSBGZXRjaGVzIGFsbCByZWxldmFudCBzdWJtaXNzaW9uc1xuICogLSBDYWxjdWxhdGVzIHNjb3Jlc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q29udGVzdExlYWRlcmJvYXJkKGNvbnRlc3RJZDogc3RyaW5nKSB7XG4gICAgXCJ1c2UgY2FjaGVcIlxuICAgIGNhY2hlVGFnKGBsZWFkZXJib2FyZC0ke2NvbnRlc3RJZH1gKVxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICBjYWNoZUxpZmUoXCJsZWFkZXJib2FyZFwiKVxuXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcGFydGljaXBhdGlvbnMgPSBhd2FpdCBwcmlzbWEuY29udGVzdFBhcnRpY2lwYXRpb24uZmluZE1hbnkoe1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICBjb250ZXN0SWQsXG4gICAgICAgICAgICAgICAgLy8gc3RhcnRlZEF0OiB7IG5vdDogbnVsbCB9IC8vIE9ubHkgc3RhcnRlZCBwYXJ0aWNpcGFudHMgKEZpeCBpZiBmaWVsZCBleGlzdHMsIG90aGVyd2lzZSByZWx5IG9uIGNyZWF0ZWQpXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjb250ZXN0ID0gYXdhaXQgcHJpc21hLmNvbnRlc3QuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICB3aGVyZTogeyBpZDogY29udGVzdElkIH0sXG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgICAgcHJvYmxlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJvYmxlbToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmZpY3VsdHk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsdWc6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBvcmRlckJ5OiB7IG9yZGVyOiBcImFzY1wiIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghY29udGVzdCkgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkNvbnRlc3Qgbm90IGZvdW5kXCIgfTtcblxuICAgICAgICBjb25zdCBsZWFkZXJib2FyZCA9IGF3YWl0IFByb21pc2UuYWxsKHBhcnRpY2lwYXRpb25zLm1hcChhc3luYyAocCkgPT4ge1xuICAgICAgICAgICAgLy8gR2V0IHZhbGlkIHN1Ym1pc3Npb25zIGZvciB0aGlzIHVzZXIgaW4gdGhpcyBjb250ZXN0XG4gICAgICAgICAgICBjb25zdCBzdWJtaXNzaW9ucyA9IGF3YWl0IHByaXNtYS5zdWJtaXNzaW9uLmZpbmRNYW55KHtcbiAgICAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgICAgICB1c2VySWQ6IHAudXNlcklkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZXN0SWQ6IGNvbnRlc3RJZCxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBndGU6IGNvbnRlc3Quc3RhcnRUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgbHRlOiBjb250ZXN0LmVuZFRpbWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHByb2JsZW1JZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlZEF0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB0b3RhbCBzY29yZVxuICAgICAgICAgICAgLy8gTG9naWM6IEJlc3Qgc3VibWlzc2lvbiBwZXIgcHJvYmxlbSBjb3VudHNcbiAgICAgICAgICAgIGNvbnN0IHByb2JsZW1TY29yZXMgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuICAgICAgICAgICAgY29uc3QgcHJvYmxlbVNvbHZlVGltZXMgPSBuZXcgTWFwPHN0cmluZywgRGF0ZT4oKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2JsZW1TdWJtaXNzaW9uQ291bnRzID0gbmV3IE1hcDxzdHJpbmcsIG51bWJlcj4oKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2JsZW1CZXN0U3VibWlzc2lvbnMgPSBuZXcgTWFwPHN0cmluZywgYW55PigpO1xuXG4gICAgICAgICAgICBzdWJtaXNzaW9ucy5mb3JFYWNoKHN1YiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudENvdW50ID0gcHJvYmxlbVN1Ym1pc3Npb25Db3VudHMuZ2V0KHN1Yi5wcm9ibGVtSWQpIHx8IDA7XG4gICAgICAgICAgICAgICAgcHJvYmxlbVN1Ym1pc3Npb25Db3VudHMuc2V0KHN1Yi5wcm9ibGVtSWQsIGN1cnJlbnRDb3VudCArIDEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHN1Yi5zdGF0dXMgPT09IFwiQUNDRVBURURcIikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50QmVzdCA9IHByb2JsZW1TY29yZXMuZ2V0KHN1Yi5wcm9ibGVtSWQpIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByb2JsZW1EZWYgPSBjb250ZXN0LnByb2JsZW1zLmZpbmQoY3AgPT4gY3AucHJvYmxlbUlkID09PSBzdWIucHJvYmxlbUlkKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF4U2NvcmUgPSBwcm9ibGVtRGVmPy5wcm9ibGVtLnNjb3JlIHx8IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1heFNjb3JlID4gY3VycmVudEJlc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ibGVtU2NvcmVzLnNldChzdWIucHJvYmxlbUlkLCBtYXhTY29yZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEJlc3RUaW1lID0gcHJvYmxlbVNvbHZlVGltZXMuZ2V0KHN1Yi5wcm9ibGVtSWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghY3VycmVudEJlc3RUaW1lIHx8IHN1Yi5jcmVhdGVkQXQgPCBjdXJyZW50QmVzdFRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvYmxlbVNvbHZlVGltZXMuc2V0KHN1Yi5wcm9ibGVtSWQsIHN1Yi5jcmVhdGVkQXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ibGVtQmVzdFN1Ym1pc3Npb25zLnNldChzdWIucHJvYmxlbUlkLCBzdWIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsZXQgdG90YWxTY29yZSA9IDA7XG4gICAgICAgICAgICBsZXQgdG90YWxUaW1lTXMgPSAwO1xuXG4gICAgICAgICAgICBwcm9ibGVtU2NvcmVzLmZvckVhY2goKHNjb3JlLCBwcm9ibGVtSWQpID0+IHtcbiAgICAgICAgICAgICAgICB0b3RhbFNjb3JlICs9IHNjb3JlO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNvbHZlbnRUaW1lID0gcHJvYmxlbVNvbHZlVGltZXMuZ2V0KHByb2JsZW1JZCk7XG4gICAgICAgICAgICAgICAgaWYgKHNvbHZlbnRUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvdGFsVGltZU1zICs9IChzb2x2ZW50VGltZS5nZXRUaW1lKCkgLSBjb250ZXN0LnN0YXJ0VGltZS5nZXRUaW1lKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBNYXAgc3RhdHMgZm9yIGVhY2ggcHJvYmxlbSBpbiB0aGUgY29udGVzdFxuICAgICAgICAgICAgY29uc3QgcHJvYmxlbVN0YXRzID0gY29udGVzdC5wcm9ibGVtcy5tYXAoY3AgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJlc3RTdWIgPSBwcm9ibGVtQmVzdFN1Ym1pc3Npb25zLmdldChjcC5wcm9ibGVtSWQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHByb2JsZW1JZDogY3AucHJvYmxlbUlkLFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogY3AucHJvYmxlbS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgc2x1ZzogY3AucHJvYmxlbS5zbHVnLFxuICAgICAgICAgICAgICAgICAgICBzY29yZTogcHJvYmxlbVNjb3Jlcy5nZXQoY3AucHJvYmxlbUlkKSB8fCAwLFxuICAgICAgICAgICAgICAgICAgICBtYXhTY29yZTogY3AucHJvYmxlbS5zY29yZSxcbiAgICAgICAgICAgICAgICAgICAgc3VibWlzc2lvbnM6IHByb2JsZW1TdWJtaXNzaW9uQ291bnRzLmdldChjcC5wcm9ibGVtSWQpIHx8IDAsXG4gICAgICAgICAgICAgICAgICAgIHNvbHZlZDogcHJvYmxlbVNjb3Jlcy5oYXMoY3AucHJvYmxlbUlkKSxcbiAgICAgICAgICAgICAgICAgICAgc29sdmVkQXQ6IHByb2JsZW1Tb2x2ZVRpbWVzLmdldChjcC5wcm9ibGVtSWQpLFxuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZTogYmVzdFN1Yj8ubGFuZ3VhZ2U/Lm5hbWUgfHwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2VJZDogYmVzdFN1Yj8ubGFuZ3VhZ2U/LmlkIHx8IG51bGxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgLi4ucC51c2VyLFxuICAgICAgICAgICAgICAgIHNjb3JlOiB0b3RhbFNjb3JlLFxuICAgICAgICAgICAgICAgIHRpbWVUYWtlbjogdG90YWxUaW1lTXMsXG4gICAgICAgICAgICAgICAgcHJvYmxlbXNTb2x2ZWQ6IHByb2JsZW1TY29yZXMuc2l6ZSxcbiAgICAgICAgICAgICAgICBwcm9ibGVtU3RhdHNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcblxuICAgICAgICAvLyBTb3J0OiBIaWdoIHNjb3JlIGZpcnN0LCB0aGVuIGxvdyB0aW1lIHRha2VuXG4gICAgICAgIGxlYWRlcmJvYXJkLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgICAgIGlmIChiLnNjb3JlICE9PSBhLnNjb3JlKSByZXR1cm4gYi5zY29yZSAtIGEuc2NvcmU7XG4gICAgICAgICAgICByZXR1cm4gYS50aW1lVGFrZW4gLSBiLnRpbWVUYWtlbjtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgICAgICBzdHVkZW50czogbGVhZGVyYm9hcmQsXG4gICAgICAgICAgICBpc0ZpbmFsaXplZDogY29udGVzdC5pc0ZpbmFsaXplZCxcbiAgICAgICAgICAgIHByb2JsZW1zOiBjb250ZXN0LnByb2JsZW1zLm1hcChjcCA9PiAoe1xuICAgICAgICAgICAgICAgIGlkOiBjcC5wcm9ibGVtSWQsXG4gICAgICAgICAgICAgICAgdGl0bGU6IGNwLnByb2JsZW0udGl0bGUsXG4gICAgICAgICAgICAgICAgc2x1ZzogY3AucHJvYmxlbS5zbHVnLFxuICAgICAgICAgICAgICAgIG1heFNjb3JlOiBjcC5wcm9ibGVtLnNjb3JlXG4gICAgICAgICAgICB9KSlcbiAgICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJMZWFkZXJib2FyZCBlcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRmFpbGVkIHRvIGdlbmVyYXRlIGxlYWRlcmJvYXJkXCIgfTtcbiAgICB9XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgdXNlcidzIHJhbmtpbmcgaW4gYSBjb250ZXN0XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDb250ZXN0UmFua2luZyhjb250ZXN0SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBhdXRoLmFwaS5nZXRTZXNzaW9uKHtcbiAgICAgICAgaGVhZGVyczogYXdhaXQgaGVhZGVycygpLFxuICAgIH0pO1xuXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiVW5hdXRob3JpemVkXCIgfTtcblxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldENvbnRlc3RMZWFkZXJib2FyZChjb250ZXN0SWQpO1xuXG4gICAgICAgIGlmICghcmVzdWx0LnN1Y2Nlc3MgfHwgIXJlc3VsdC5zdHVkZW50cykge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkZhaWxlZCB0byBnZXQgcmFua2luZ1wiIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByYW5rID0gcmVzdWx0LnN0dWRlbnRzLmZpbmRJbmRleCgoczogYW55KSA9PiBzLmlkID09PSBzZXNzaW9uLnVzZXIuaWQpICsgMTtcblxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCByYW5rOiByYW5rID4gMCA/IHJhbmsgOiBudWxsIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJGYWlsZWQgdG8gZ2V0IHJhbmtpbmdcIiB9O1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOFJBOG1Dc0IifQ==
}),
"[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx [app-ssr] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>ContestParticipantsPage
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/navigation.js [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$arrow$2d$left$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ArrowLeft$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/arrow-left.js [app-ssr] (ecmascript) <export default as ArrowLeft>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$users$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Users$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/users.js [app-ssr] (ecmascript) <export default as Users>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$triangle$2d$alert$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertTriangle$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/triangle-alert.js [app-ssr] (ecmascript) <export default as AlertTriangle>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$ban$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Ban$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/ban.js [app-ssr] (ecmascript) <export default as Ban>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$clock$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Clock$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/clock.js [app-ssr] (ecmascript) <export default as Clock>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$check$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__CheckCircle2$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/circle-check.js [app-ssr] (ecmascript) <export default as CheckCircle2>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$chevron$2d$down$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ChevronDown$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/chevron-down.js [app-ssr] (ecmascript) <export default as ChevronDown>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$chevron$2d$up$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ChevronUp$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/chevron-up.js [app-ssr] (ecmascript) <export default as ChevronUp>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$lock$2d$open$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Unlock$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/lock-open.js [app-ssr] (ecmascript) <export default as Unlock>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$shield$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Shield$3e$__ = __turbopack_context__.i("[project]/node_modules/lucide-react/dist/esm/icons/shield.js [app-ssr] (ecmascript) <export default as Shield>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/sonner/dist/index.mjs [app-ssr] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$actions$2f$data$3a$5704e2__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/actions/data:5704e2 [app-ssr] (ecmascript) <text/javascript>");
var __TURBOPACK__imported__module__$5b$project$5d2f$actions$2f$data$3a$bd0e29__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__ = __turbopack_context__.i("[project]/actions/data:bd0e29 [app-ssr] (ecmascript) <text/javascript>");
"use client";
;
;
;
;
;
;
function ContestParticipantsPage() {
    const params = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useParams"])();
    const router = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$navigation$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useRouter"])();
    const contestId = params.id;
    const [participants, setParticipants] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])([]);
    const [loading, setLoading] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])(true);
    const [expandedId, setExpandedId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])(null);
    const [unblocking, setUnblocking] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useState"])(null);
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["useEffect"])(()=>{
        loadParticipants();
    }, [
        contestId
    ]);
    const loadParticipants = async ()=>{
        setLoading(true);
        const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$actions$2f$data$3a$5704e2__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["getContestParticipants"])(contestId);
        if (result.success && result.participants) {
            // Map to handle Date to string conversion
            const mapped = result.participants.map((p)=>({
                    ...p,
                    violations: p.violations.map((v)=>({
                            ...v,
                            createdAt: v.createdAt instanceof Date ? v.createdAt.toISOString() : v.createdAt
                        }))
                }));
            setParticipants(mapped);
        } else {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].error(result.error || "Failed to load participants");
        }
        setLoading(false);
    };
    const handleUnblock = async (userId)=>{
        setUnblocking(userId);
        const result = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$actions$2f$data$3a$bd0e29__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$text$2f$javascript$3e$__["unblockParticipant"])(contestId, userId);
        if (result.success) {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].success("Participant unblocked successfully");
            loadParticipants();
        } else {
            __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$sonner$2f$dist$2f$index$2e$mjs__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["toast"].error(result.error || "Failed to unblock participant");
        }
        setUnblocking(null);
    };
    const getStatusBadge = (p)=>{
        if (p.permanentlyBlocked) {
            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                className: "px-2 py-1 bg-red-100 dark:bg-red-500/10 text-red-700 dark:text-red-400 text-xs font-medium rounded-full flex items-center gap-1",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$ban$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Ban$3e$__["Ban"], {
                        className: "w-3 h-3"
                    }, void 0, false, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 85,
                        columnNumber: 17
                    }, this),
                    " Permanently Blocked"
                ]
            }, void 0, true, {
                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                lineNumber: 84,
                columnNumber: 20
            }, this);
        }
        if (p.tempBlockedUntil && new Date(p.tempBlockedUntil) > new Date()) {
            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                className: "px-2 py-1 bg-orange-100 dark:bg-orange-500/10 text-orange-700 dark:text-orange-400 text-xs font-medium rounded-full flex items-center gap-1",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$clock$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Clock$3e$__["Clock"], {
                        className: "w-3 h-3"
                    }, void 0, false, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 90,
                        columnNumber: 17
                    }, this),
                    " Temp Blocked"
                ]
            }, void 0, true, {
                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                lineNumber: 89,
                columnNumber: 20
            }, this);
        }
        if (p.isBlocked) {
            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                className: "px-2 py-1 bg-red-100 dark:bg-red-500/10 text-red-700 dark:text-red-400 text-xs font-medium rounded-full flex items-center gap-1",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$ban$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Ban$3e$__["Ban"], {
                        className: "w-3 h-3"
                    }, void 0, false, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 95,
                        columnNumber: 17
                    }, this),
                    " Blocked"
                ]
            }, void 0, true, {
                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                lineNumber: 94,
                columnNumber: 20
            }, this);
        }
        if (p.isFlagged) {
            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                className: "px-2 py-1 bg-yellow-100 dark:bg-yellow-500/10 text-yellow-700 dark:text-yellow-400 text-xs font-medium rounded-full flex items-center gap-1",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$triangle$2d$alert$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertTriangle$3e$__["AlertTriangle"], {
                        className: "w-3 h-3"
                    }, void 0, false, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 100,
                        columnNumber: 17
                    }, this),
                    " Flagged"
                ]
            }, void 0, true, {
                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                lineNumber: 99,
                columnNumber: 20
            }, this);
        }
        if (p.unblockedAt) {
            return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                className: "px-2 py-1 bg-green-100 dark:bg-green-500/10 text-green-700 dark:text-green-400 text-xs font-medium rounded-full flex items-center gap-1",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$circle$2d$check$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__CheckCircle2$3e$__["CheckCircle2"], {
                        className: "w-3 h-3"
                    }, void 0, false, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 105,
                        columnNumber: 17
                    }, this),
                    " Unblocked"
                ]
            }, void 0, true, {
                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                lineNumber: 104,
                columnNumber: 20
            }, this);
        }
        return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
            className: "px-2 py-1 bg-gray-100 dark:bg-[#1a1a1a] text-gray-700 dark:text-gray-300 text-xs font-medium rounded-full",
            children: "Active"
        }, void 0, false, {
            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
            lineNumber: 108,
            columnNumber: 16
        }, this);
    };
    const blockedCount = participants.filter((p)=>p.isBlocked || p.permanentlyBlocked).length;
    const flaggedCount = participants.filter((p)=>p.isFlagged && !p.isBlocked).length;
    return /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
        className: "min-h-screen bg-gray-50 dark:bg-[#0a0a0a]",
        children: [
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "bg-white dark:bg-[#141414] border-b border-gray-200 dark:border-[#262626] sticky top-0 z-10",
                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                    className: "max-w-6xl mx-auto px-4 py-4",
                    children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "flex items-center gap-4",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                onClick: ()=>router.back(),
                                className: "p-2 hover:bg-gray-100 dark:hover:bg-[#1a1a1a] rounded-lg transition-colors text-gray-500 dark:text-gray-400",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$arrow$2d$left$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ArrowLeft$3e$__["ArrowLeft"], {
                                    className: "w-5 h-5"
                                }, void 0, false, {
                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                    lineNumber: 126,
                                    columnNumber: 29
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                lineNumber: 122,
                                columnNumber: 25
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                children: [
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("h1", {
                                        className: "text-xl font-bold text-gray-900 dark:text-white",
                                        children: "Contest Participants"
                                    }, void 0, false, {
                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                        lineNumber: 129,
                                        columnNumber: 29
                                    }, this),
                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                        className: "text-sm text-gray-500 dark:text-gray-400",
                                        children: "View violations and manage blocked participants"
                                    }, void 0, false, {
                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                        lineNumber: 130,
                                        columnNumber: 29
                                    }, this)
                                ]
                            }, void 0, true, {
                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                lineNumber: 128,
                                columnNumber: 25
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 121,
                        columnNumber: 21
                    }, this)
                }, void 0, false, {
                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                    lineNumber: 120,
                    columnNumber: 17
                }, this)
            }, void 0, false, {
                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                lineNumber: 119,
                columnNumber: 13
            }, this),
            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                className: "max-w-6xl mx-auto px-4 py-6",
                children: [
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",
                        children: [
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "bg-white dark:bg-[#141414] rounded-xl p-4 border border-gray-200 dark:border-[#262626]",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex items-center gap-3",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "w-10 h-10 bg-blue-100 dark:bg-blue-500/10 rounded-lg flex items-center justify-center",
                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$users$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Users$3e$__["Users"], {
                                                className: "w-5 h-5 text-blue-600 dark:text-blue-500"
                                            }, void 0, false, {
                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                lineNumber: 142,
                                                columnNumber: 33
                                            }, this)
                                        }, void 0, false, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 141,
                                            columnNumber: 29
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-2xl font-bold text-gray-900 dark:text-gray-100",
                                                    children: participants.length
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 145,
                                                    columnNumber: 33
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-sm text-gray-500 dark:text-gray-400",
                                                    children: "Total Participants"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 146,
                                                    columnNumber: 33
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 144,
                                            columnNumber: 29
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                    lineNumber: 140,
                                    columnNumber: 25
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                lineNumber: 139,
                                columnNumber: 21
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "bg-white dark:bg-[#141414] rounded-xl p-4 border border-gray-200 dark:border-[#262626]",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex items-center gap-3",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "w-10 h-10 bg-red-100 dark:bg-red-500/10 rounded-lg flex items-center justify-center",
                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$ban$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Ban$3e$__["Ban"], {
                                                className: "w-5 h-5 text-red-600 dark:text-red-500"
                                            }, void 0, false, {
                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                lineNumber: 153,
                                                columnNumber: 33
                                            }, this)
                                        }, void 0, false, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 152,
                                            columnNumber: 29
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-2xl font-bold text-gray-900 dark:text-gray-100",
                                                    children: blockedCount
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 156,
                                                    columnNumber: 33
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-sm text-gray-500 dark:text-gray-400",
                                                    children: "Blocked"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 157,
                                                    columnNumber: 33
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 155,
                                            columnNumber: 29
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                    lineNumber: 151,
                                    columnNumber: 25
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                lineNumber: 150,
                                columnNumber: 21
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "bg-white dark:bg-[#141414] rounded-xl p-4 border border-gray-200 dark:border-[#262626]",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex items-center gap-3",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "w-10 h-10 bg-yellow-100 dark:bg-yellow-500/10 rounded-lg flex items-center justify-center",
                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$triangle$2d$alert$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__AlertTriangle$3e$__["AlertTriangle"], {
                                                className: "w-5 h-5 text-yellow-600 dark:text-yellow-500"
                                            }, void 0, false, {
                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                lineNumber: 164,
                                                columnNumber: 33
                                            }, this)
                                        }, void 0, false, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 163,
                                            columnNumber: 29
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-2xl font-bold text-gray-900 dark:text-gray-100",
                                                    children: flaggedCount
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 167,
                                                    columnNumber: 33
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-sm text-gray-500 dark:text-gray-400",
                                                    children: "Flagged"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 168,
                                                    columnNumber: 33
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 166,
                                            columnNumber: 29
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                    lineNumber: 162,
                                    columnNumber: 25
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                lineNumber: 161,
                                columnNumber: 21
                            }, this),
                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                className: "bg-white dark:bg-[#141414] rounded-xl p-4 border border-gray-200 dark:border-[#262626]",
                                children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "flex items-center gap-3",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "w-10 h-10 bg-green-100 dark:bg-green-500/10 rounded-lg flex items-center justify-center",
                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$shield$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Shield$3e$__["Shield"], {
                                                className: "w-5 h-5 text-green-600 dark:text-green-500"
                                            }, void 0, false, {
                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                lineNumber: 175,
                                                columnNumber: 33
                                            }, this)
                                        }, void 0, false, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 174,
                                            columnNumber: 29
                                        }, this),
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-2xl font-bold text-gray-900 dark:text-gray-100",
                                                    children: participants.filter((p)=>p.totalViolations === 0).length
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 178,
                                                    columnNumber: 33
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                    className: "text-sm text-gray-500 dark:text-gray-400",
                                                    children: "Clean"
                                                }, void 0, false, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 181,
                                                    columnNumber: 33
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 177,
                                            columnNumber: 29
                                        }, this)
                                    ]
                                }, void 0, true, {
                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                    lineNumber: 173,
                                    columnNumber: 25
                                }, this)
                            }, void 0, false, {
                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                lineNumber: 172,
                                columnNumber: 21
                            }, this)
                        ]
                    }, void 0, true, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 138,
                        columnNumber: 17
                    }, this),
                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                        className: "bg-white dark:bg-[#141414] rounded-xl border border-gray-200 dark:border-[#262626] overflow-hidden",
                        children: loading ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "p-8 text-center text-gray-500 dark:text-gray-400",
                            children: "Loading participants..."
                        }, void 0, false, {
                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                            lineNumber: 190,
                            columnNumber: 25
                        }, this) : participants.length === 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "p-8 text-center text-gray-500 dark:text-gray-400",
                            children: "No participants yet"
                        }, void 0, false, {
                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                            lineNumber: 192,
                            columnNumber: 25
                        }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                            className: "divide-y divide-gray-100 dark:divide-[#262626]",
                            children: participants.map((p)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                    className: "hover:bg-gray-50 dark:hover:bg-[#1a1a1a]",
                                    children: [
                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "p-4 flex items-center justify-between cursor-pointer",
                                            onClick: ()=>setExpandedId(expandedId === p.id ? null : p.id),
                                            children: [
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                    className: "flex items-center gap-4",
                                                    children: [
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                            className: "w-10 h-10 bg-gray-200 dark:bg-[#262626] rounded-full flex items-center justify-center overflow-hidden",
                                                            children: p.user.image ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("img", {
                                                                src: p.user.image,
                                                                alt: "",
                                                                className: "w-full h-full object-cover",
                                                                referrerPolicy: "no-referrer"
                                                            }, void 0, false, {
                                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                lineNumber: 204,
                                                                columnNumber: 53
                                                            }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                className: "text-gray-600 dark:text-gray-400 font-medium",
                                                                children: p.user.name?.charAt(0) || '?'
                                                            }, void 0, false, {
                                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                lineNumber: 206,
                                                                columnNumber: 53
                                                            }, this)
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                            lineNumber: 202,
                                                            columnNumber: 45
                                                        }, this),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                            children: [
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                    className: "font-medium text-gray-900 dark:text-gray-100",
                                                                    children: p.user.name
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                    lineNumber: 212,
                                                                    columnNumber: 49
                                                                }, this),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                    className: "text-sm text-gray-500 dark:text-gray-400",
                                                                    children: p.user.email
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                    lineNumber: 213,
                                                                    columnNumber: 49
                                                                }, this)
                                                            ]
                                                        }, void 0, true, {
                                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                            lineNumber: 211,
                                                            columnNumber: 45
                                                        }, this)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 201,
                                                    columnNumber: 41
                                                }, this),
                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                    className: "flex items-center gap-4",
                                                    children: [
                                                        getStatusBadge(p),
                                                        /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                            className: "text-center",
                                                            children: [
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                    className: `text-lg font-bold ${p.totalViolations >= 6 ? 'text-red-600' : p.totalViolations >= 4 ? 'text-orange-600' : p.totalViolations >= 1 ? 'text-yellow-600' : 'text-green-600'}`,
                                                                    children: p.totalViolations
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                    lineNumber: 220,
                                                                    columnNumber: 49
                                                                }, this),
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                                    className: "text-xs text-gray-500",
                                                                    children: "Violations"
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                    lineNumber: 227,
                                                                    columnNumber: 49
                                                                }, this)
                                                            ]
                                                        }, void 0, true, {
                                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                            lineNumber: 219,
                                                            columnNumber: 45
                                                        }, this),
                                                        expandedId === p.id ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$chevron$2d$up$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ChevronUp$3e$__["ChevronUp"], {
                                                            className: "w-5 h-5 text-gray-400"
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                            lineNumber: 230,
                                                            columnNumber: 49
                                                        }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$chevron$2d$down$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__ChevronDown$3e$__["ChevronDown"], {
                                                            className: "w-5 h-5 text-gray-400"
                                                        }, void 0, false, {
                                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                            lineNumber: 232,
                                                            columnNumber: 49
                                                        }, this)
                                                    ]
                                                }, void 0, true, {
                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                    lineNumber: 217,
                                                    columnNumber: 41
                                                }, this)
                                            ]
                                        }, void 0, true, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 197,
                                            columnNumber: 37
                                        }, this),
                                        expandedId === p.id && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                            className: "px-4 pb-4 border-t border-gray-100 dark:border-[#262626] bg-gray-50 dark:bg-[#1a1a1a]",
                                            children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                className: "pt-4",
                                                children: [
                                                    (p.isBlocked || p.permanentlyBlocked) && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                        className: "mb-4",
                                                        children: /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("button", {
                                                            onClick: (e)=>{
                                                                e.stopPropagation();
                                                                handleUnblock(p.userId);
                                                            },
                                                            disabled: unblocking === p.userId,
                                                            className: "px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center gap-2 disabled:opacity-50",
                                                            children: [
                                                                /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$lucide$2d$react$2f$dist$2f$esm$2f$icons$2f$lock$2d$open$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__$3c$export__default__as__Unlock$3e$__["Unlock"], {
                                                                    className: "w-4 h-4"
                                                                }, void 0, false, {
                                                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                    lineNumber: 252,
                                                                    columnNumber: 61
                                                                }, this),
                                                                unblocking === p.userId ? 'Unblocking...' : 'Unblock Participant'
                                                            ]
                                                        }, void 0, true, {
                                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                            lineNumber: 244,
                                                            columnNumber: 57
                                                        }, this)
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                        lineNumber: 243,
                                                        columnNumber: 53
                                                    }, this),
                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",
                                                        children: "Recent Violations:"
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                        lineNumber: 259,
                                                        columnNumber: 49
                                                    }, this),
                                                    p.violations.length === 0 ? /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("p", {
                                                        className: "text-sm text-gray-500 dark:text-gray-400",
                                                        children: "No violations recorded"
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                        lineNumber: 261,
                                                        columnNumber: 53
                                                    }, this) : /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                        className: "space-y-2",
                                                        children: p.violations.map((v)=>/*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                className: "flex items-center justify-between p-2 bg-white dark:bg-[#141414] rounded-lg border border-gray-200 dark:border-[#262626]",
                                                                children: [
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("div", {
                                                                        className: "flex items-center gap-2",
                                                                        children: [
                                                                            /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                                className: "px-2 py-0.5 bg-red-100 dark:bg-red-500/10 text-red-700 dark:text-red-400 text-xs rounded font-medium",
                                                                                children: v.type.replace(/_/g, ' ')
                                                                            }, void 0, false, {
                                                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                                lineNumber: 267,
                                                                                columnNumber: 69
                                                                            }, this),
                                                                            v.message && /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                                className: "text-sm text-gray-600 dark:text-gray-400",
                                                                                children: v.message
                                                                            }, void 0, false, {
                                                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                                lineNumber: 271,
                                                                                columnNumber: 73
                                                                            }, this)
                                                                        ]
                                                                    }, void 0, true, {
                                                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                        lineNumber: 266,
                                                                        columnNumber: 65
                                                                    }, this),
                                                                    /*#__PURE__*/ (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$dist$2f$server$2f$route$2d$modules$2f$app$2d$page$2f$vendored$2f$ssr$2f$react$2d$jsx$2d$dev$2d$runtime$2e$js__$5b$app$2d$ssr$5d$__$28$ecmascript$29$__["jsxDEV"])("span", {
                                                                        className: "text-xs text-gray-400 dark:text-gray-500",
                                                                        children: new Date(v.createdAt).toLocaleTimeString()
                                                                    }, void 0, false, {
                                                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                        lineNumber: 274,
                                                                        columnNumber: 65
                                                                    }, this)
                                                                ]
                                                            }, v.id, true, {
                                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                                lineNumber: 265,
                                                                columnNumber: 61
                                                            }, this))
                                                    }, void 0, false, {
                                                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                        lineNumber: 263,
                                                        columnNumber: 53
                                                    }, this)
                                                ]
                                            }, void 0, true, {
                                                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                                lineNumber: 240,
                                                columnNumber: 45
                                            }, this)
                                        }, void 0, false, {
                                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                            lineNumber: 239,
                                            columnNumber: 41
                                        }, this)
                                    ]
                                }, p.id, true, {
                                    fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                                    lineNumber: 196,
                                    columnNumber: 33
                                }, this))
                        }, void 0, false, {
                            fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                            lineNumber: 194,
                            columnNumber: 25
                        }, this)
                    }, void 0, false, {
                        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                        lineNumber: 188,
                        columnNumber: 17
                    }, this)
                ]
            }, void 0, true, {
                fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
                lineNumber: 137,
                columnNumber: 13
            }, this)
        ]
    }, void 0, true, {
        fileName: "[project]/app/(main)/dashboard/contests/[id]/participants/page.tsx",
        lineNumber: 117,
        columnNumber: 9
    }, this);
}
}),
];

//# sourceMappingURL=_a009357e._.js.map