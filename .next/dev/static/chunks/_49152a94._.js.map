{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/vishnu/Documents/projects/Algo-fox/lib/languages.ts"],"sourcesContent":["\nexport interface Language {\n    id: number; // Judge0 ID\n    name: string;\n    monacoLanguage: string; // Monaco Editor language identifier\n    boilerplate: string;\n}\n\nexport const LANGUAGES: Language[] = [\n    {\n        id: 63,\n        name: \"JavaScript\",\n        monacoLanguage: \"javascript\",\n        boilerplate: `const fs = require(\"fs\");\n\nconst input = fs.readFileSync(0, \"utf8\").trim().split(/\\\\s+/);\n\n// write your code here\n\nconsole.log();`\n    },\n\n    {\n        id: 62,\n        name: \"Java\",\n        monacoLanguage: \"java\",\n        boilerplate: `import java.util.*;\n\npublic class Main {\n    public static void main(String[] args) {\n\n        // write your code here\n\n        \n    }\n}`\n    },\n\n    {\n        id: 71,\n        name: \"Python\",\n        monacoLanguage: \"python\",\n        boilerplate: `import sys\n\ndata = sys.stdin.read().split()\n\n# write your code here\n\nprint()`\n    },\n\n    {\n        id: 50,\n        name: \"C\",\n        monacoLanguage: \"c\",\n        boilerplate: `#include <stdio.h>\n\nint main() {\n\n    // write your code here\n\n    return 0;\n}`\n    },\n\n    {\n        id: 54,\n        name: \"C++\",\n        monacoLanguage: \"cpp\",\n        boilerplate: `#include <bits/stdc++.h>\nusing namespace std;\n\nint main() {\n\n    // write your code here\n\n    return 0;\n}`\n    },\n\n    {\n        id: 73,\n        name: \"Rust\",\n        monacoLanguage: \"rust\",\n        boilerplate: `use std::io::{self, Read};\n\nfn main() {\n    let mut input = String::new();\n    io::stdin().read_to_string(&mut input).unwrap();\n\n    // write your code here\n}`\n    },\n\n    {\n        id: 60,\n        name: \"Go\",\n        monacoLanguage: \"go\",\n        boilerplate: `package main\n\nimport (\n    \"bufio\"\n    \"os\"\n)\n\nfunc main() {\n    in := bufio.NewReader(os.Stdin)\n\n    // write your code here\n\n}`\n    },\n    {\n        id: 82,\n        name: \"SQL\",\n        monacoLanguage: \"sql\",\n        boilerplate: `` // Empty boilerplate for SQL\n    }\n];\n\nexport function getLanguageById(id: number): Language | undefined {\n    return LANGUAGES.find(lang => lang.id === id);\n}\n\nexport function getLanguageByName(name: string): Language | undefined {\n    return LANGUAGES.find(lang => lang.name === name);\n}\n\nexport const DEFAULT_LANGUAGE_ID = 63;\n\n"],"names":[],"mappings":";;;;;;;;;;AAQO,MAAM,YAAwB;IACjC;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,CAAC;;;;;;cAMR,CAAC;IACX;IAEA;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,CAAC;;;;;;;;;CASrB,CAAC;IACE;IAEA;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,CAAC;;;;;;OAMf,CAAC;IACJ;IAEA;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,CAAC;;;;;;;CAOrB,CAAC;IACE;IAEA;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,CAAC;;;;;;;;CAQrB,CAAC;IACE;IAEA;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,CAAC;;;;;;;CAOrB,CAAC;IACE;IAEA;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,CAAC;;;;;;;;;;;;CAYrB,CAAC;IACE;IACA;QACI,IAAI;QACJ,MAAM;QACN,gBAAgB;QAChB,aAAa,EAAE,CAAC,4BAA4B;IAChD;CACH;AAEM,SAAS,gBAAgB,EAAU;IACtC,OAAO,UAAU,IAAI,CAAC,CAAA,OAAQ,KAAK,EAAE,KAAK;AAC9C;AAEO,SAAS,kBAAkB,IAAY;IAC1C,OAAO,UAAU,IAAI,CAAC,CAAA,OAAQ,KAAK,IAAI,KAAK;AAChD;AAEO,MAAM,sBAAsB"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///home/vishnu/Documents/projects/Algo-fox/components/workspace/DriverCodeModal.tsx"],"sourcesContent":["\"use client\";\n\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { X, Code2, Copy, Check } from \"lucide-react\";\nimport { useEffect, useRef, useState } from \"react\";\nimport dynamic from \"next/dynamic\";\nimport { Loader2 } from \"lucide-react\";\nimport { useTheme } from \"next-themes\";\nimport { toast } from \"sonner\";\nimport { getLanguageById } from \"@/lib/languages\";\n\n// Dynamically import Monaco Editor to prevent SSR issues\nconst Editor = dynamic(\n  () => import(\"@monaco-editor/react\").then((mod) => mod.default),\n  {\n    ssr: false,\n    loading: () => (\n      <div className=\"flex items-center justify-center h-full\">\n        <Loader2 className=\"w-6 h-6 text-orange-500 animate-spin\" />\n      </div>\n    ),\n  }\n);\n\ninterface DriverCodeModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  driverCode: string;\n  languageId: number;\n}\n\nexport default function DriverCodeModal({\n  isOpen,\n  onClose,\n  driverCode,\n  languageId,\n}: DriverCodeModalProps) {\n  const modalRef = useRef<HTMLDivElement>(null);\n  const { resolvedTheme } = useTheme();\n  const [isCopied, setIsCopied] = useState(false);\n\n  const currentLanguage = getLanguageById(languageId);\n  const theme = resolvedTheme === \"dark\" ? \"vs-dark\" : \"vs-light\";\n\n  // Close on click outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        modalRef.current &&\n        !modalRef.current.contains(event.target as Node)\n      ) {\n        onClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener(\"mousedown\", handleClickOutside);\n    }\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [isOpen, onClose]);\n\n  // Prevent body scroll when open\n  useEffect(() => {\n    if (isOpen) {\n      document.body.style.overflow = \"hidden\";\n    } else {\n      document.body.style.overflow = \"unset\";\n    }\n  }, [isOpen]);\n\n  const handleCopy = () => {\n    navigator.clipboard.writeText(driverCode);\n    setIsCopied(true);\n    toast.success(\"Driver code copied to clipboard\", {\n      className: \"rounded-xl border border-gray-200 dark:border-white/10 shadow-lg\",\n    });\n    setTimeout(() => setIsCopied(false), 2000);\n  };\n\n  return (\n    <AnimatePresence>\n      {isOpen && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\n          <motion.div\n            ref={modalRef}\n            initial={{ opacity: 0, scale: 0.95, y: 10 }}\n            animate={{ opacity: 1, scale: 1, y: 0 }}\n            exit={{ opacity: 0, scale: 0.95, y: 10 }}\n            transition={{ duration: 0.2 }}\n            className=\"w-full max-w-4xl h-[80vh] bg-white dark:bg-[#141414] rounded-xl shadow-2xl border border-gray-200 dark:border-[#262626] overflow-hidden flex flex-col\"\n          >\n            {/* Header */}\n            <div className=\"px-6 py-4 border-b border-gray-100 dark:border-[#262626] flex items-center justify-between bg-gray-50/50 dark:bg-[#1a1a1a]\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"p-2 bg-orange-50 dark:bg-orange-500/10 rounded-lg\">\n                    <Code2 className=\"w-5 h-5 text-orange-600 dark:text-orange-500\" />\n                </div>\n                <div>\n                    <h2 className=\"text-lg font-bold text-gray-900 dark:text-gray-100\">\n                    Driver Code\n                    </h2>\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                        This is the code that runs your solution\n                    </p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <button\n                    onClick={handleCopy}\n                    className=\"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-[#262626] rounded-lg transition-colors flex items-center gap-2 text-sm font-medium\"\n                >\n                    {isCopied ? <Check className=\"w-4 h-4\" /> : <Copy className=\"w-4 h-4\" />}\n                    {isCopied ? \"Copied\" : \"Copy\"}\n                </button>\n                <div className=\"w-px h-6 bg-gray-200 dark:bg-[#333] mx-1\" />\n                <button\n                    onClick={onClose}\n                    className=\"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-[#262626] rounded-lg transition-colors\"\n                >\n                    <X className=\"w-5 h-5\" />\n                </button>\n              </div>\n            </div>\n\n            {/* Content */}\n            <div className=\"flex-1 relative bg-white dark:bg-[#1e1e1e]\">\n                 <Editor\n                    height=\"100%\"\n                    language={currentLanguage?.monacoLanguage || \"plaintext\"}\n                    value={driverCode}\n                    theme={theme}\n                    options={{\n                        readOnly: true,\n                        minimap: { enabled: false },\n                        fontSize: 14,\n                        lineNumbers: \"on\",\n                        scrollBeyondLastLine: false,\n                        automaticLayout: true,\n                        padding: { top: 16, bottom: 16 },\n                    }}\n                />\n            </div>\n\n            {/* Footer */}\n            <div className=\"px-6 py-3 bg-gray-50 dark:bg-[#1a1a1a] border-t border-gray-100 dark:border-[#262626] flex justify-between items-center text-xs text-gray-500 dark:text-gray-400\">\n                <p>Read-only mode</p>\n                <button\n                    onClick={onClose}\n                    className=\"px-4 py-2 text-sm font-bold text-white bg-gray-900 dark:bg-white dark:text-black rounded-lg hover:bg-black dark:hover:bg-gray-200 transition-colors\"\n                >\n                    Close\n                </button>\n            </div>\n          </motion.div>\n        </div>\n      )}\n    </AnimatePresence>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 461, "column": 0}, "map": {"version":3,"sources":["file:///home/vishnu/Documents/projects/Algo-fox/lib/db.ts"],"sourcesContent":["\nimport Dexie, { type Table } from 'dexie';\n\nexport interface CodeDraft {\n    id: string; // Composite key: problemId_languageId\n    problemId: string;\n    languageId: number;\n    code: string;\n    updatedAt: number;\n}\n\nconst EXPIRATION_TIME_MS = 6 * 60 * 60 * 1000; // 6 hours\nconst DB_NAME = 'AlgoFoxDB';\n\nclass AlgoFoxDB extends Dexie {\n    codeDrafts!: Table<CodeDraft>;\n\n    constructor() {\n        super(DB_NAME);\n\n        // Version 2: new schema with id as primary key\n        // Start directly at version 2 to avoid primary key migration issues\n        this.version(2).stores({\n            codeDrafts: 'id, problemId, languageId, updatedAt'\n        });\n    }\n}\n\n// Only create database instance on client side (browser)\nlet db: AlgoFoxDB | null = null;\n\nfunction getDB(): AlgoFoxDB {\n    // Only create database in browser environment\n    if (typeof window === 'undefined') {\n        throw new Error('IndexedDB is only available in browser environment');\n    }\n\n    if (!db) {\n        db = new AlgoFoxDB();\n\n        // Initialize database with error handling for schema migration\n        db.open().catch(async (error: any) => {\n            // If migration fails due to primary key change, delete and recreate\n            if (error.name === 'UpgradeError' ||\n                error.message?.includes('primary key') ||\n                error.message?.includes('Not yet support for changing primary key')) {\n                console.warn('Database schema migration failed, recreating database...');\n                try {\n                    await Dexie.delete(DB_NAME);\n                    // Reload page to reinitialize with new schema\n                    if (typeof window !== 'undefined') {\n                        window.location.reload();\n                    }\n                } catch (deleteError) {\n                    console.error('Failed to recreate database:', deleteError);\n                }\n            } else {\n                console.error('Failed to open database:', error);\n            }\n        });\n    }\n\n    return db;\n}\n\n// Export getter function that only creates DB in browser\nexport { getDB };\n\nexport async function saveCodeDraft(userId: string, problemId: string, languageId: number, code: string) {\n    // Only save in browser environment\n    if (typeof window === 'undefined' || !userId) {\n        return;\n    }\n\n    try {\n        const db = getDB();\n        if (!db.isOpen()) {\n            await db.open();\n        }\n\n        const now = Date.now();\n        const id = `${userId}_${problemId}_${languageId}`;\n\n        // Clean up expired entries (optimistic, don't wait)\n        db.codeDrafts.where('updatedAt').below(now - EXPIRATION_TIME_MS).delete();\n\n        // Also verify if we need to migrate/cleanup old format entries (optional but nice)\n        // For now, simple key change is sufficient to segregate data.\n\n        await db.codeDrafts.put({\n            id,\n            problemId,\n            languageId,\n            code,\n            updatedAt: now\n        });\n    } catch (error: any) {\n        // If still failing, just log and continue (database will be recreated on reload)\n        console.error('Failed to save code draft:', error);\n    }\n}\n\nexport async function getCodeDraft(userId: string, problemId: string, languageId: number): Promise<string | null> {\n    // Only get in browser environment\n    if (typeof window === 'undefined' || !userId) {\n        return null;\n    }\n\n    try {\n        const db = getDB();\n        if (!db.isOpen()) {\n            await db.open();\n        }\n\n        const id = `${userId}_${problemId}_${languageId}`;\n        const draft = await db.codeDrafts.get(id);\n\n        if (!draft) return null;\n\n        const now = Date.now();\n        if (now - draft.updatedAt > EXPIRATION_TIME_MS) {\n            // Expired\n            await db.codeDrafts.delete(id);\n            return null;\n        }\n\n        return draft.code;\n    } catch (error: any) {\n        // Log error but don't throw - return null to allow app to continue\n        console.error('Failed to get code draft:', error);\n        return null;\n    }\n}\n"],"names":[],"mappings":";;;;;;;;AACA;;AAUA,MAAM,qBAAqB,IAAI,KAAK,KAAK,MAAM,UAAU;AACzD,MAAM,UAAU;AAEhB,MAAM,kBAAkB,yJAAK;IACzB,WAA8B;IAE9B,aAAc;QACV,KAAK,CAAC;QAEN,+CAA+C;QAC/C,oEAAoE;QACpE,IAAI,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC;YACnB,YAAY;QAChB;IACJ;AACJ;AAEA,yDAAyD;AACzD,IAAI,KAAuB;AAE3B,SAAS;IACL,8CAA8C;IAC9C;;IAIA,IAAI,CAAC,IAAI;QACL,KAAK,IAAI;QAET,+DAA+D;QAC/D,GAAG,IAAI,GAAG,KAAK,CAAC,OAAO;YACnB,oEAAoE;YACpE,IAAI,MAAM,IAAI,KAAK,kBACf,MAAM,OAAO,EAAE,SAAS,kBACxB,MAAM,OAAO,EAAE,SAAS,6CAA6C;gBACrE,QAAQ,IAAI,CAAC;gBACb,IAAI;oBACA,MAAM,yJAAK,CAAC,MAAM,CAAC;oBACnB,8CAA8C;oBAC9C,wCAAmC;wBAC/B,OAAO,QAAQ,CAAC,MAAM;oBAC1B;gBACJ,EAAE,OAAO,aAAa;oBAClB,QAAQ,KAAK,CAAC,gCAAgC;gBAClD;YACJ,OAAO;gBACH,QAAQ,KAAK,CAAC,4BAA4B;YAC9C;QACJ;IACJ;IAEA,OAAO;AACX;;AAKO,eAAe,cAAc,MAAc,EAAE,SAAiB,EAAE,UAAkB,EAAE,IAAY;IACnG,mCAAmC;IACnC,IAAI,+CAAkB,eAAe,CAAC,QAAQ;QAC1C;IACJ;IAEA,IAAI;QACA,MAAM,KAAK;QACX,IAAI,CAAC,GAAG,MAAM,IAAI;YACd,MAAM,GAAG,IAAI;QACjB;QAEA,MAAM,MAAM,KAAK,GAAG;QACpB,MAAM,KAAK,GAAG,OAAO,CAAC,EAAE,UAAU,CAAC,EAAE,YAAY;QAEjD,oDAAoD;QACpD,GAAG,UAAU,CAAC,KAAK,CAAC,aAAa,KAAK,CAAC,MAAM,oBAAoB,MAAM;QAEvE,mFAAmF;QACnF,8DAA8D;QAE9D,MAAM,GAAG,UAAU,CAAC,GAAG,CAAC;YACpB;YACA;YACA;YACA;YACA,WAAW;QACf;IACJ,EAAE,OAAO,OAAY;QACjB,iFAAiF;QACjF,QAAQ,KAAK,CAAC,8BAA8B;IAChD;AACJ;AAEO,eAAe,aAAa,MAAc,EAAE,SAAiB,EAAE,UAAkB;IACpF,kCAAkC;IAClC,IAAI,+CAAkB,eAAe,CAAC,QAAQ;QAC1C,OAAO;IACX;IAEA,IAAI;QACA,MAAM,KAAK;QACX,IAAI,CAAC,GAAG,MAAM,IAAI;YACd,MAAM,GAAG,IAAI;QACjB;QAEA,MAAM,KAAK,GAAG,OAAO,CAAC,EAAE,UAAU,CAAC,EAAE,YAAY;QACjD,MAAM,QAAQ,MAAM,GAAG,UAAU,CAAC,GAAG,CAAC;QAEtC,IAAI,CAAC,OAAO,OAAO;QAEnB,MAAM,MAAM,KAAK,GAAG;QACpB,IAAI,MAAM,MAAM,SAAS,GAAG,oBAAoB;YAC5C,UAAU;YACV,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC;YAC3B,OAAO;QACX;QAEA,OAAO,MAAM,IAAI;IACrB,EAAE,OAAO,OAAY;QACjB,mEAAmE;QACnE,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO;IACX;AACJ"}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":["file:///home/vishnu/Documents/projects/Algo-fox/components/workspace/CodeEditor.tsx"],"sourcesContent":["\"use client\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport dynamic from \"next/dynamic\";\nimport {\n  AlignLeft,\n  RotateCcw,\n  Maximize2,\n  ChevronDown,\n  Loader2,\n  Settings,\n  Minimize2,\n  Code2,\n} from \"lucide-react\";\nimport DriverCodeModal from \"./DriverCodeModal\";\nimport { getCodeDraft, saveCodeDraft } from \"@/lib/db\";\nimport { toast } from \"sonner\";\nimport {\n  LANGUAGES,\n  getLanguageById,\n  DEFAULT_LANGUAGE_ID,\n} from \"@/lib/languages\";\nimport { ProblemDomain } from \"@prisma/client\";\nimport { useTheme } from \"next-themes\";\n\n// Dynamically import Monaco Editor to prevent SSR issues\nconst Editor = dynamic(\n  () => import(\"@monaco-editor/react\").then((mod) => mod.default),\n  {\n    ssr: false,\n    loading: () => (\n      <div className=\"flex items-center justify-center h-full\">\n        <Loader2 className=\"w-6 h-6 text-orange-500 animate-spin\" />\n      </div>\n    ),\n  }\n);\n\nconst LANGUAGE_STORAGE_KEY = \"algofox_selected_language\";\nconst SQL_LANGUAGE_ID = 82; // SQL language ID\n\ninterface FunctionTemplate {\n  languageId: number;\n  functionTemplate: string;\n  driverCode: string;\n}\n\ninterface CodeEditorProps {\n  onChange?: (value: string | undefined) => void;\n  onLanguageChange?: (languageId: number) => void;\n  defaultValue?: string;\n  value?: string;\n  languageId?: number;\n  problemId?: string;\n  domain?: ProblemDomain;\n  functionTemplates?: FunctionTemplate[];\n  readOnly?: boolean;\n  userId?: string; // Add userId to props\n  settings?: {\n    fontSize: number;\n    tabSize: number;\n    theme?: \"vs-light\" | \"vs-dark\";\n    keybinding: \"standard\" | \"vim\";\n  };\n  onOpenSettings?: () => void;\n}\n\nconst AUTOSAVE_DELAY = 1000; // 1 second\n\nexport default function CodeEditor({\n  onChange,\n  onLanguageChange,\n  defaultValue,\n  value: controlledValue,\n  languageId = DEFAULT_LANGUAGE_ID,\n  problemId,\n  domain,\n  functionTemplates,\n  readOnly = false,\n  settings,\n  onOpenSettings,\n  userId = \"\",\n}: CodeEditorProps) {\n  // Get system theme\n  const { resolvedTheme } = useTheme();\n\n  // Determine the effective Monaco theme - use system dark mode if settings.theme not explicitly set\n  const effectiveTheme =\n    settings?.theme || (resolvedTheme === \"dark\" ? \"vs-dark\" : \"vs-light\");\n\n  // Filter languages based on domain: SQL problems only show SQL language\n  const availableLanguages =\n    domain === \"SQL\"\n      ? LANGUAGES.filter((lang) => lang.id === SQL_LANGUAGE_ID)\n      : LANGUAGES.filter((lang) => lang.id !== SQL_LANGUAGE_ID);\n\n  // For SQL problems, default to SQL language\n  const effectiveLanguageId =\n    domain === \"SQL\"\n      ? languageId === SQL_LANGUAGE_ID\n        ? languageId\n        : SQL_LANGUAGE_ID\n      : languageId;\n\n  // We rely on the parent key={languageId} to remount this component when language changes\n  // sc so we can use languageId prop directly.\n  const currentLanguage =\n    getLanguageById(effectiveLanguageId) || availableLanguages[0];\n\n  // Helper: get the boilerplate for the current language\n  // If function template exists for this language, use it; otherwise use default\n  const getBoilerplate = (): string => {\n    if (domain === \"SQL\") return \"\";\n    // Check if we have a function template for this language\n    if (functionTemplates && functionTemplates.length > 0) {\n      const template = functionTemplates.find(\n        (t) => t.languageId === effectiveLanguageId\n      );\n      if (template && template.functionTemplate) {\n        return template.functionTemplate;\n      }\n    }\n    // Fall back to default boilerplate from languages.ts\n    return currentLanguage.boilerplate;\n  };\n\n  const getDriverCode = (): string | null => {\n    if (domain === \"SQL\") return null;\n    if (functionTemplates && functionTemplates.length > 0) {\n      const template = functionTemplates.find(\n        (t) => t.languageId === effectiveLanguageId\n      );\n      if (template && template.driverCode) {\n        return template.driverCode;\n      }\n    }\n    return null;\n  };\n\n  const currentDriverCode = getDriverCode();\n\n  // Initialize code state\n  // If readOnly, prioritize controlledValue.\n  // Else, use domain/boilerplate logic.\n  const initialCode =\n    readOnly && controlledValue !== undefined\n      ? controlledValue\n      : domain === \"SQL\"\n      ? defaultValue || \"\"\n      : defaultValue || getBoilerplate();\n\n  const [code, setCode] = useState(initialCode);\n  const [isDropdownOpen, setIsDropdownOpen] = useState(false);\n  const editorRef = React.useRef<any>(null);\n  const saveTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const [isRestoring, setIsRestoring] = useState(false);\n  const [isMounted, setIsMounted] = useState(false);\n  const [editorError, setEditorError] = useState(false);\n  const mountRetryRef = useRef(0);\n  const MAX_RETRIES = 3;\n\n  // Initialize loading state: ALWAYS FALSE for Optimistic UI\n  // We want the editor to show up immediately.\n  const [isLoading, setIsLoading] = useState(false);\n\n  const [isSaving, setIsSaving] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const editorContainerRef = useRef<HTMLDivElement>(null);\n  const [isFullScreen, setIsFullScreen] = useState(false);\n  const [isDriverCodeModalOpen, setIsDriverCodeModalOpen] = useState(false);\n\n  // Track component mount state with a small delay to ensure DOM is ready\n  useEffect(() => {\n    // Small delay to ensure Monaco services are ready\n    const timer = setTimeout(() => {\n      setIsMounted(true);\n    }, 50);\n\n    return () => {\n      clearTimeout(timer);\n      setIsMounted(false);\n      setEditorError(false);\n      mountRetryRef.current = 0;\n      // Clean up editor ref - improved disposal logic\n      if (editorRef.current) {\n        try {\n          const editor = editorRef.current;\n          // Check if editor has a model before attempting disposal\n          if (editor && typeof editor.getModel === \"function\") {\n            const model = editor.getModel();\n            // Only dispose if model exists and is not already disposed\n            if (model && typeof model.isDisposed === \"function\" && !model.isDisposed()) {\n              // Dispose the model first\n              if (typeof model.dispose === \"function\") {\n                try {\n                  model.dispose();\n                } catch (e) {\n                  // Silently ignore model disposal errors\n                }\n              }\n            }\n          }\n          // Then dispose the editor itself\n          if (typeof editor.dispose === \"function\") {\n            try {\n              editor.dispose();\n            } catch (e) {\n              // Silently ignore editor disposal errors\n            }\n          }\n        } catch (error) {\n          // Ignore all disposal errors - they're harmless during unmount\n        } finally {\n          editorRef.current = null;\n        }\n      }\n    };\n  }, []);\n\n  // Suppress Monaco Editor cancellation and disposal errors (they're harmless)\n  useEffect(() => {\n    const handleUnhandledRejection = (event: PromiseRejectionEvent) => {\n      const reason = event.reason;\n      const reasonStr = reason?.toString() || \"\";\n      const reasonMsg = reason?.message || \"\";\n\n      // Suppress Monaco Editor errors\n      if (\n        reasonMsg === \"Canceled\" ||\n        reasonStr.includes(\"Canceled\") ||\n        reasonStr.includes(\"InstantiationService has been disposed\") ||\n        reasonMsg.includes(\"InstantiationService has been disposed\") ||\n        reasonStr.includes(\"domNode\") ||\n        reasonMsg.includes(\"domNode\")\n      ) {\n        event.preventDefault();\n        // Retry mounting if component is still mounted\n        if (isMounted && mountRetryRef.current < MAX_RETRIES) {\n          mountRetryRef.current++;\n          setTimeout(() => {\n            if (isMounted) {\n              setEditorError(false);\n            }\n          }, 100 * mountRetryRef.current);\n        }\n        return;\n      }\n    };\n\n    const handleError = (event: ErrorEvent) => {\n      const message = event.message || \"\";\n      if (\n        message.includes(\"InstantiationService\") ||\n        message.includes(\"domNode\") ||\n        message.includes(\"Monaco\")\n      ) {\n        event.preventDefault();\n        return true;\n      }\n      return false;\n    };\n\n    window.addEventListener(\"unhandledrejection\", handleUnhandledRejection);\n    window.addEventListener(\"error\", handleError);\n    return () => {\n      window.removeEventListener(\n        \"unhandledrejection\",\n        handleUnhandledRejection\n      );\n      window.removeEventListener(\"error\", handleError);\n    };\n  }, [isMounted]);\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (\n        dropdownRef.current &&\n        !dropdownRef.current.contains(event.target as Node)\n      ) {\n        setIsDropdownOpen(false);\n      }\n    }\n\n    if (isDropdownOpen) {\n      document.addEventListener(\"mousedown\", handleClickOutside);\n      return () =>\n        document.removeEventListener(\"mousedown\", handleClickOutside);\n    }\n  }, [isDropdownOpen]);\n\n  // Handle full screen change\n  useEffect(() => {\n    const handleFullScreenChange = () => {\n      setIsFullScreen(\n        document.fullscreenElement === editorContainerRef.current\n      );\n    };\n\n    document.addEventListener(\"fullscreenchange\", handleFullScreenChange);\n    return () =>\n      document.removeEventListener(\"fullscreenchange\", handleFullScreenChange);\n  }, []);\n\n  // LOAD SAVED CODE (Only if NOT readOnly)\n  useEffect(() => {\n    if (readOnly) return; // Skip loading draft if read-only\n\n    let isMounted = true;\n    let cancelled = false;\n\n    // If no problemId, we are good with just the initial state (boilerplate)\n    if (!problemId) {\n      // ... (keeping existing logic for no problemId)\n      // If no problemId, set code based on domain\n      if (domain === \"SQL\") {\n        setCode(\"\");\n        if (editorRef.current && isMounted) {\n          try {\n            const editor = editorRef.current;\n            const model = editor.getModel?.();\n            if (model && !model.isDisposed()) {\n              editor.setValue(\"\");\n            }\n          } catch (error) {\n            console.debug(\"setValue error (safe to ignore):\", error);\n          }\n        }\n        if (onChange) onChange(\"\");\n      } else {\n        const langBoilerplate = getBoilerplate();\n        setCode(langBoilerplate);\n        if (editorRef.current && isMounted) {\n          try {\n            const editor = editorRef.current;\n            const model = editor.getModel?.();\n            if (model && !model.isDisposed()) {\n              editor.setValue(langBoilerplate);\n            }\n          } catch (error) {\n            console.debug(\"setValue error (safe to ignore):\", error);\n          }\n        }\n        if (onChange) onChange(langBoilerplate);\n      }\n      return;\n    }\n\n    async function loadDraft(retryCount = 0) {\n      // For SQL, if no saved code, just set empty and return immediately\n      // NOTE: We do NOT set isLoading to true here anymore\n\n      try {\n        if (retryCount === 0) setIsRestoring(true); // Helper spinner can still show\n\n        // Fetch draft in background\n        const savedCode = await getCodeDraft(\n          userId,\n          problemId!,\n          effectiveLanguageId\n        );\n\n        // Check if component is still mounted and effect hasn't been cancelled\n        if (!isMounted || cancelled) {\n          setIsRestoring(false);\n          return;\n        }\n\n        // Logic to set code if savedCode exists\n        // If it's a retry and we still don't have it, try again\n        if (!savedCode && retryCount === 0) {\n          await new Promise((resolve) => setTimeout(resolve, 200));\n          if (!isMounted || cancelled) {\n            setIsRestoring(false);\n            return;\n          }\n          return loadDraft(1);\n        }\n\n        // If we found saved code, update the editor!\n        if (savedCode) {\n          // Only toast if the saved code is different from what's currently shown (boilerplate)\n          // This prevents annoying toasts if they match\n          //  toast.info(\"Draft restored\");\n          const codeToSet = savedCode;\n          setCode(codeToSet);\n\n          if (editorRef.current) {\n            try {\n              const editor = editorRef.current;\n              const model = editor.getModel?.();\n              if (model && !model.isDisposed()) {\n                const currentContent = editor.getValue();\n                if (currentContent !== codeToSet) {\n                  editor.setValue(codeToSet);\n                  toast.success(\"Saved draft restored\");\n                }\n              }\n            } catch (error) {\n              console.debug(\"setValue error (safe to ignore):\", error);\n            }\n          }\n          if (onChange) onChange(codeToSet);\n        }\n        // If NO saved code, we implicitly stick with the boilerplate we already showed.\n        // No need to \"clear\" it unless it's SQL maybe?\n      } catch (error) {\n        console.error(\"Failed to load code draft:\", error);\n        // On error, we just keep the boilerplate.\n      } finally {\n        if (isMounted && !cancelled) {\n          setIsRestoring(false);\n          // setIsLoading(false); // No longer used\n        }\n      }\n    }\n\n    loadDraft();\n\n    return () => {\n      isMounted = false;\n      cancelled = true;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [problemId, effectiveLanguageId, readOnly, isMounted, userId]);\n\n  // HANDLE AUTOSAVE (Only if NOT readOnly)\n  const debouncedSave = (value: string) => {\n    if (!problemId || readOnly) return; // Skip saving logic entirely if readOnly\n\n    if (saveTimeoutRef.current) {\n      clearTimeout(saveTimeoutRef.current);\n    }\n\n    saveTimeoutRef.current = setTimeout(async () => {\n      setIsSaving(true);\n      try {\n        // Save to DB and wait for at least 500ms to show the spinner\n        await Promise.all([\n          saveCodeDraft(userId, problemId, effectiveLanguageId, value),\n          new Promise((resolve) => setTimeout(resolve, 500)),\n        ]);\n      } catch (err) {\n        console.error(\"Autosave failed:\", err);\n      } finally {\n        setIsSaving(false);\n      }\n    }, AUTOSAVE_DELAY);\n  };\n\n  const handleLanguageChange = (newLanguageId: number) => {\n    // In read-only mode, we likely disable changing lang, but if allowed:\n    if (newLanguageId === effectiveLanguageId) {\n      setIsDropdownOpen(false);\n      return;\n    }\n\n    setIsDropdownOpen(false);\n    if (onLanguageChange) {\n      onLanguageChange(newLanguageId);\n    }\n  };\n\n  const handleEditorDidMount = (editor: any, monaco: any) => {\n    if (!isMounted) return;\n\n    try {\n      editorRef.current = editor;\n      setEditorError(false);\n      mountRetryRef.current = 0;\n\n      // SECURE COPY/PASTE LOGIC\n      // We generate a unique session token for this editor instance\n      const SESSION_TOKEN_KEY = \"algofox_secure_token\";\n      const instanceToken = Math.random().toString(36).substring(2) + Date.now().toString(36);\n\n      // We attach to the CONTAINER (editorContainerRef) for robust capture.\n      // 1. Mark container as allowed for DevToolsBlocker\n      if (editorContainerRef.current) {\n          const container = editorContainerRef.current;\n          container.setAttribute(\"data-allow-clipboard\", \"true\");\n\n          // Also allow internal domNode just to be safe with traversal logic\n          const domNode = editor.getDomNode();\n          if (domNode) {\n             domNode.setAttribute(\"data-allow-clipboard\", \"true\");\n          }\n\n          // 2. Attach Capture Phase Listeners\n          // We must remove previous listeners to avoid duplicates on re-mounts if any,\n          // but since this is a functional component mount, simple addEventListener is fine\n          // (closure captures unique instanceToken).\n\n          const handleCopy = (e: ClipboardEvent) => {\n              if (e.clipboardData) {\n                  const selection = editor.getModel()?.getValueInRange(editor.getSelection());\n                  if (selection) {\n                      e.clipboardData.setData('text/plain', selection);\n                      // Inject our secure token\n                      e.clipboardData.setData('application/x-algofox-token', instanceToken);\n                      e.preventDefault();\n                  }\n              }\n          };\n\n          const handleCut = (e: ClipboardEvent) => {\n             if (e.clipboardData) {\n                  const selection = editor.getModel()?.getValueInRange(editor.getSelection());\n                  if (selection) {\n                      e.clipboardData.setData('text/plain', selection);\n                      e.clipboardData.setData('application/x-algofox-token', instanceToken);\n                      e.preventDefault();\n                      editor.trigger('source', 'cut', {});\n                  }\n              }\n          };\n\n          const handlePaste = (e: ClipboardEvent) => {\n              // Parse token\n              const token = e.clipboardData?.getData('application/x-algofox-token');\n\n              if (token === instanceToken) {\n                  // Verified! Allow to succeed.\n                  return;\n              } else {\n                  // External or Invalid\n                  e.preventDefault();\n                  e.stopPropagation();\n                  toast.error(\"Paste blocked: You can only paste code copied from this editor.\");\n              }\n          };\n\n          container.addEventListener(\"copy\", handleCopy as any, true);\n          container.addEventListener(\"cut\", handleCut as any, true);\n          container.addEventListener(\"paste\", handlePaste as any, true);\n\n          // Note: In a production app, we should save these handler refs to remove them in cleanup\n          // but for now relying on component unmount and container lifecycle is acceptable\n      }\n\n      // In readOnly mode, the editor might strictly follow `value` prop if we passed one,\n      // but setting it explicitly ensures it matches state.\n      if (code && editor) {\n        try {\n          const model = editor.getModel?.();\n          if (model && !model.isDisposed()) {\n            editor.setValue(code);\n          }\n        } catch (error) {\n          // Editor might be disposed, ignore\n          console.debug(\"Editor setValue error (safe to ignore):\", error);\n        }\n      }\n    } catch (error) {\n      console.debug(\"Editor mount error (safe to ignore):\", error);\n      // Retry mounting if we haven't exceeded max retries\n      if (mountRetryRef.current < MAX_RETRIES && isMounted) {\n        mountRetryRef.current++;\n        setTimeout(() => {\n          if (isMounted) {\n            setEditorError(false);\n          }\n        }, 100 * mountRetryRef.current);\n      } else {\n        setEditorError(true);\n      }\n    }\n  };\n\n  const handleEditorWillMount = (monaco: any) => {\n    // Ensure Monaco is ready before mounting\n    if (!isMounted) return;\n  };\n\n  // Cleanup editor on unmount\n  useEffect(() => {\n    return () => {\n      if (editorRef.current) {\n        try {\n          const editor = editorRef.current;\n          // Check if editor has a model before attempting disposal\n          if (editor && typeof editor.getModel === \"function\") {\n            const model = editor.getModel();\n            // Only dispose if model exists and is not already disposed\n            if (model && typeof model.isDisposed === \"function\" && !model.isDisposed()) {\n              // Dispose the model first\n              if (typeof model.dispose === \"function\") {\n                try {\n                  model.dispose();\n                } catch (e) {\n                  // Silently ignore model disposal errors\n                }\n              }\n            }\n          }\n          // Then dispose the editor itself\n          if (typeof editor.dispose === \"function\") {\n            try {\n              editor.dispose();\n            } catch (e) {\n              // Silently ignore editor disposal errors\n            }\n          }\n        } catch (error) {\n          // Ignore all disposal errors\n        } finally {\n          editorRef.current = null;\n        }\n      }\n      // Clear any pending save operations\n      if (saveTimeoutRef.current) {\n        clearTimeout(saveTimeoutRef.current);\n        saveTimeoutRef.current = null;\n      }\n    };\n  }, []);\n\n  const handleFormat = () => {\n    if (editorRef.current) {\n      try {\n        const editor = editorRef.current;\n        const model = editor.getModel?.();\n        // Check if editor and model are still valid\n        if (model && !model.isDisposed()) {\n          editor.getAction(\"editor.action.formatDocument\")?.run();\n        }\n      } catch (error) {\n        console.debug(\"Format error (safe to ignore):\", error);\n      }\n    }\n  };\n\n  const handleReset = () => {\n    if (readOnly) return; // Disable reset in read-only\n\n    const resetCode = domain === \"SQL\" ? \"\" : getBoilerplate();\n    setCode(resetCode);\n    if (onChange) onChange(resetCode);\n    if (editorRef.current) {\n      try {\n        const editor = editorRef.current;\n        const model = editor.getModel?.();\n        // Check if editor and model are still valid\n        if (model && !model.isDisposed()) {\n          editor.setValue(resetCode);\n        }\n      } catch (error) {\n        console.debug(\"Reset error (safe to ignore):\", error);\n      }\n    }\n\n    if (problemId) {\n      saveCodeDraft(userId, problemId, effectiveLanguageId, resetCode).then(\n        () => {\n          toast.success(\"Code reset to default\");\n        }\n      );\n    }\n  };\n\n  const handleFullScreen = () => {\n    if (!editorContainerRef.current) return;\n\n    if (!document.fullscreenElement) {\n      editorContainerRef.current.requestFullscreen().catch((err) => {\n        console.error(\n          `Error attempting to enable full-screen mode: ${err.message} (${err.name})`\n        );\n      });\n    } else {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      }\n    }\n  };\n\n  return (\n    <div\n      ref={editorContainerRef}\n      className={`h-full flex flex-col bg-white dark:bg-[#1e1e1e] border-l border-gray-200 dark:border-[#262626] ${\n        isFullScreen ? \"fixed inset-0 z-50\" : \"\"\n      }`}\n    >\n      {/* EDITOR TOOLBAR */}\n      <div className=\"flex items-center justify-between px-4 py-2 border-b border-gray-100 dark:border-[#262626] bg-gray-50/50 dark:bg-[#1a1a1a]\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"relative\" ref={dropdownRef}>\n            <button\n              id=\"language-dropdown\"\n              onClick={() => !readOnly && setIsDropdownOpen(!isDropdownOpen)}\n              disabled={readOnly}\n              className={`flex items-center gap-2 text-xs font-medium text-gray-700 dark:text-gray-300 px-2 py-1 rounded transition-colors ${\n                readOnly\n                  ? \"opacity-70 cursor-default\"\n                  : \"hover:bg-gray-200 dark:hover:bg-[#262626]\"\n              }`}\n            >\n              {currentLanguage.name}\n              {!readOnly && (\n                <ChevronDown\n                  className={`w-3 h-3 transition-transform ${\n                    isDropdownOpen ? \"rotate-180\" : \"\"\n                  }`}\n                />\n              )}\n            </button>\n            {isDropdownOpen && !readOnly && (\n              <div className=\"absolute top-full left-0 mt-1 bg-white dark:bg-[#1a1a1a] border border-gray-200 dark:border-[#262626] rounded-lg shadow-lg z-50 min-w-30\">\n                {availableLanguages.map((lang) => (\n                  <button\n                    key={lang.id}\n                    onClick={() => handleLanguageChange(lang.id)}\n                    className={`w-full text-left px-3 py-2 text-xs hover:bg-gray-100 dark:hover:bg-[#262626] transition-colors first:rounded-t-lg last:rounded-b-lg ${\n                      effectiveLanguageId === lang.id\n                        ? \"bg-blue-50 dark:bg-blue-500/10 text-blue-700 dark:text-blue-400 font-medium\"\n                        : \"text-gray-700 dark:text-gray-300\"\n                    }`}\n                  >\n                    {lang.name}\n                  </button>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Driver Code Button */}\n          {currentDriverCode && !readOnly && (\n            <button\n              onClick={() => setIsDriverCodeModalOpen(true)}\n              className=\"flex items-center gap-2 text-xs font-medium text-gray-700 dark:text-gray-300 px-2 py-1 hover:bg-gray-200 dark:hover:bg-[#262626] rounded transition-colors\"\n              title=\"View Driver Code\"\n            >\n              <Code2 className=\"w-3.5 h-3.5 text-orange-600 dark:text-orange-500\" />\n              <span className=\"hidden sm:inline\">View Driver Code</span>\n            </button>\n          )}\n\n          {isSaving && (\n            <div className=\"flex items-center gap-1.5 text-xs text-orange-500 font-medium\">\n              <Loader2 className=\"w-3 h-3 animate-spin\" />\n              <span>Saving...</span>\n            </div>\n          )}\n        </div>\n\n        <div className=\"flex items-center gap-2 text-gray-500\">\n          {isRestoring && (\n            <Loader2 className=\"w-3 h-3 animate-spin text-gray-400 mr-2\" />\n          )}\n          <button\n            onClick={handleFormat}\n            className=\"p-1.5 hover:bg-gray-200 dark:hover:bg-[#262626] rounded transition-colors text-gray-500 dark:text-gray-400\"\n            title=\"Format Code\"\n          >\n            <AlignLeft className=\"w-4 h-4\" />\n          </button>\n          {!readOnly && (\n            <button\n              onClick={handleReset}\n              className=\"p-1.5 hover:bg-gray-200 dark:hover:bg-[#262626] rounded transition-colors text-gray-500 dark:text-gray-400\"\n              title=\"Reset to Default\"\n            >\n              <RotateCcw className=\"w-4 h-4\" />\n            </button>\n          )}\n          <button\n            onClick={handleFullScreen}\n            className=\"p-1.5 hover:bg-gray-200 dark:hover:bg-[#262626] rounded transition-colors text-gray-500 dark:text-gray-400\"\n            title={isFullScreen ? \"Exit Full Screen\" : \"Full Screen\"}\n          >\n            {isFullScreen ? (\n              <Minimize2 className=\"w-4 h-4\" />\n            ) : (\n              <Maximize2 className=\"w-4 h-4\" />\n            )}\n          </button>\n          {!readOnly && (\n            <button\n              onClick={onOpenSettings}\n              className=\"p-1.5 hover:bg-gray-200 dark:hover:bg-[#262626] rounded transition-colors text-gray-500 dark:text-gray-400\"\n              title=\"Editor Settings\"\n            >\n              <Settings className=\"w-4 h-4\" />\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* MONACO EDITOR */}\n      <div className=\"flex-1 relative\">\n        {isLoading ? (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-[#1e1e1e] z-10\">\n            <div className=\"flex flex-col items-center gap-3\">\n              <Loader2 className=\"w-8 h-8 text-orange-500 animate-spin\" />\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 font-medium\">\n                Loading your code...\n              </p>\n            </div>\n          </div>\n        ) : editorError && mountRetryRef.current >= MAX_RETRIES ? (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-[#1e1e1e] z-10\">\n            <div className=\"flex flex-col items-center gap-3 text-center p-4\">\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 font-medium\">\n                Editor failed to load. Please refresh the page.\n              </p>\n              <button\n                onClick={() => {\n                  setEditorError(false);\n                  mountRetryRef.current = 0;\n                  setIsMounted(true);\n                }}\n                className=\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium\"\n              >\n                Retry\n              </button>\n            </div>\n          </div>\n        ) : isMounted ? (\n          <Editor\n            key={`editor-${effectiveLanguageId}-${problemId || \"no-problem\"}-${\n              mountRetryRef.current\n            }`}\n            height=\"100%\"\n            language={currentLanguage.monacoLanguage}\n            value={code}\n            theme={effectiveTheme}\n            onMount={handleEditorDidMount}\n            beforeMount={handleEditorWillMount}\n            onChange={(value) => {\n              if (!isMounted) return;\n              const newVal = value || \"\";\n              setCode(newVal);\n              if (onChange) onChange(newVal);\n              debouncedSave(newVal);\n            }}\n            options={{\n              minimap: { enabled: false },\n              fontSize: settings?.fontSize || 19,\n              lineNumbers: \"on\",\n              roundedSelection: true,\n              scrollBeyondLastLine: false,\n              readOnly: readOnly, // Apply readOnly prop here\n              automaticLayout: true,\n              padding: { top: 16 },\n              tabSize: settings?.tabSize || 4,\n            }}\n            loading={\n              <div className=\"flex items-center justify-center h-full\">\n                <Loader2 className=\"w-6 h-6 text-orange-500 animate-spin\" />\n              </div>\n            }\n            onValidate={() => {}} // Suppress validation errors during disposal\n          />\n        ) : (\n          <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-[#1e1e1e] z-10\">\n            <div className=\"flex flex-col items-center gap-3\">\n              <Loader2 className=\"w-8 h-8 text-orange-500 animate-spin\" />\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 font-medium\">\n                Initializing editor...\n              </p>\n            </div>\n          </div>\n        )}\n      </div>\n\n      <DriverCodeModal\n        isOpen={isDriverCodeModalOpen}\n        onClose={() => setIsDriverCodeModalOpen(false)}\n        languageId={effectiveLanguageId}\n        driverCode={currentDriverCode || \"\"}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}